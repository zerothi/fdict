<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Documentation of fortran type-free variable and dictionary">
    
    <meta name="author" content="Nick R. Papior" >
    <link rel="icon" href="../favicon.png">

    <title>variable.f90 &ndash; fdict</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">fdict <small>0.7.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>variable.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="67.9% of total for source files.">5703 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/variable.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">variable.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/variable.html">variable</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/variable.f90.html#src">variable.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20190128.1818)
 -->
<!-- Title: sourcefile~~variable.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilevariablef90AfferentGraph" width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~variable.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~variable.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- sourcefile~variable.f90 -->
<g id="sourcefile~~variable.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~variable.f90</title>
<polygon fill="none" stroke="#000000" points="68,-24 0,-24 0,0 68,0 68,-24"/>
<text text-anchor="middle" x="34" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">variable.f90</text>
</g>
<!-- sourcefile~dictionary.f90 -->
<g id="sourcefile~~variable.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~dictionary.f90</title>
<g id="a_sourcefile~~variable.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/dictionary.f90.html" xlink:title="dictionary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="180,-24 104,-24 104,0 180,0 180,-24"/>
<text text-anchor="middle" x="142" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dictionary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dictionary.f90&#45;&gt;sourcefile~variable.f90 -->
<g id="sourcefile~~variable.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~dictionary.f90&#45;&gt;sourcefile~variable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M103.9232,-12C95.6336,-12 86.7941,-12 78.2872,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="78.1348,-8.5001 68.1348,-12 78.1348,-15.5001 78.1348,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20190128.1818)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/variable.html">variable</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/variable.f90.html#src">variable.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! @LICENSE@, see README.md</span>
<a name="ln-2"></a><span class="c">! Generic purpose variable as in any scripting language</span>
<a name="ln-3"></a><span class="c">! It has the power to transform into any variable at any time</span>
<a name="ln-4"></a><span class="k">module </span><span class="n">variable</span>
<a name="ln-5"></a>  <span class="c">!! A type-free variable module to contain _any_ data in fortran.</span>
<a name="ln-6"></a>  <span class="c">!!</span>
<a name="ln-7"></a>  <span class="c">!! This module implements a generic variable-type (`type(variable_t)`)</span>
<a name="ln-8"></a>  <span class="c">!! which may contain _any_ data-type (even user-derived type constructs).</span>
<a name="ln-9"></a>  <span class="c">!!</span>
<a name="ln-10"></a>  <span class="c">!! Its basic usage is somewhat different than the regular assignment</span>
<a name="ln-11"></a>  <span class="c">!! in fortran.</span>
<a name="ln-12"></a>  <span class="c">!!</span>
<a name="ln-13"></a>  <span class="c">!! Example:</span>
<a name="ln-14"></a>  <span class="c">!!</span>
<a name="ln-15"></a>  <span class="c">!!```fortran</span>
<a name="ln-16"></a>  <span class="c">!! real :: r</span>
<a name="ln-17"></a>  <span class="c">!! real :: ra(10)</span>
<a name="ln-18"></a>  <span class="c">!! real, target :: rb(10)</span>
<a name="ln-19"></a>  <span class="c">!! type(variable_t) :: v</span>
<a name="ln-20"></a>  <span class="c">!! call assign(v, r) ! v now contains value of r</span>
<a name="ln-21"></a>  <span class="c">!! call assign(v, ra) ! v now contains array with values of ra</span>
<a name="ln-22"></a>  <span class="c">!! call delete(v) ! delete content</span>
<a name="ln-23"></a>  <span class="c">!! call associate(v, ra) ! v now contains a pointer to rb</span>
<a name="ln-24"></a>  <span class="c">!! call assign(ra, v) ! copies data from rb to ra</span>
<a name="ln-25"></a>  <span class="c">!!```</span>
<a name="ln-26"></a>  <span class="c">!!</span>
<a name="ln-27"></a>  <span class="c">!! The assignment routine behaves like `=` (delete old value)</span>
<a name="ln-28"></a>  <span class="c">!! whereas the associate routine behaves like `=&gt;` (nullify old value).</span>
<a name="ln-29"></a>  <span class="c">!!</span>
<a name="ln-30"></a>  <span class="c">!! The data-types allowed in this type is *not* limited by this</span>
<a name="ln-31"></a>  <span class="c">!! module, but we currently allow integers, reals, complex and C-pointers.</span>
<a name="ln-32"></a>  <span class="c">! Load the iso_c_binding for containing a C-pointer</span>
<a name="ln-33"></a>  <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span> <span class="nb">iso_c_binding</span>
<a name="ln-34"></a><span class="nb">  </span><span class="k">implicit none</span>
<a name="ln-35"></a><span class="k">  private</span>
<a name="ln-36"></a><span class="k">  </span><span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ih</span> <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-37"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="k">is</span> <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-38"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">il</span> <span class="o">=</span> <span class="nb">selected_int_kind</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-39"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">sp</span> <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-40"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">dp</span> <span class="o">=</span> <span class="nb">selected_real_kind</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-41"></a>  <span class="c">! To create a constant transfer data-type of the</span>
<a name="ln-42"></a>  <span class="c">! pointer methods</span>
<a name="ln-43"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">local_enc_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-44"></a>  <span class="c">! Internal variable to hold the size of the &quot;type&quot; switch</span>
<a name="ln-45"></a>  <span class="c">!&gt; Maximum character length of the type specifier in the variable, no</span>
<a name="ln-46"></a>  <span class="c">!! unique identifier may be longer than this.</span>
<a name="ln-47"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="n">VARIABLE_TYPE_LENGTH</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-48"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">variable_t</span>
<a name="ln-49"></a>     <span class="c">!! Container for _any_ fortran data-type, intrinsically handles all</span>
<a name="ln-50"></a>     <span class="c">!! from fortran and any external type may be added via external routines.</span>
<a name="ln-51"></a>     <span class="c">!!</span>
<a name="ln-52"></a>     <span class="c">!! The container is based on a type-transfer method by storing a pointer</span>
<a name="ln-53"></a>     <span class="c">!! to the data and transfer the type to a character array via encoding.</span>
<a name="ln-54"></a>     <span class="c">!! This enables one to retrieve the pointer position later and thus enables</span>
<a name="ln-55"></a>     <span class="c">!! pointer assignments and easy copying of data.</span>
<a name="ln-56"></a>     <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">VARIABLE_TYPE_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;    &#39;</span>
<a name="ln-57"></a>     <span class="c">! The encoding placement of all data</span>
<a name="ln-58"></a>     <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">enc</span>
<a name="ln-59"></a>  <span class="k">end type </span><span class="n">variable_t</span>
<a name="ln-60"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">variable_t</span>
<a name="ln-61"></a>  <span class="k">interface </span><span class="n">which</span>
<a name="ln-62"></a>     <span class="c">!! Type of content stored in the variable (`character(len=VARIABLE_TYPE_LENGTH)`)</span>
<a name="ln-63"></a>     <span class="k">module procedure </span><span class="n">which_</span>
<a name="ln-64"></a>  <span class="k">end interface</span>
<a name="ln-65"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">which</span>
<a name="ln-66"></a>  <span class="k">interface </span><span class="n">delete</span>
<a name="ln-67"></a>     <span class="c">!! Delete the variable (equivalent to `deallocate(&lt;&gt;)`).</span>
<a name="ln-68"></a>     <span class="k">module procedure </span><span class="n">delete_</span>
<a name="ln-69"></a>  <span class="k">end interface</span>
<a name="ln-70"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">delete</span>
<a name="ln-71"></a>  <span class="k">interface nullify</span>
<a name="ln-72"></a>     <span class="c">!! Nullify the variable (equivalent to `nullify(&lt;&gt;)`).</span>
<a name="ln-73"></a>     <span class="k">module procedure </span><span class="n">nullify_</span>
<a name="ln-74"></a>  <span class="k">end interface</span>
<a name="ln-75"></a><span class="k">  public</span> <span class="kd">::</span> <span class="k">nullify</span>
<a name="ln-76"></a><span class="k">  interface print</span>
<a name="ln-77"></a>     <span class="c">!! Print (to std-out) information regarding the variable, i.e. the type.</span>
<a name="ln-78"></a>     <span class="k">module procedure </span><span class="n">print_</span>
<a name="ln-79"></a>  <span class="k">end interface</span>
<a name="ln-80"></a><span class="k">  public</span> <span class="kd">::</span> <span class="k">print</span>
<a name="ln-81"></a>  <span class="c">! Specific routines for passing types to variables</span>
<a name="ln-82"></a>  <span class="k">interface </span><span class="n">associate_type</span>
<a name="ln-83"></a>     <span class="k">module procedure </span><span class="n">associate_type_</span>
<a name="ln-84"></a>  <span class="k">end interface</span>
<a name="ln-85"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">associate_type</span>
<a name="ln-86"></a>  <span class="k">interface </span><span class="n">enc</span>
<a name="ln-87"></a>     <span class="c">!! The encoding of the stored pointer (`character, dimension(:)`)</span>
<a name="ln-88"></a>     <span class="c">!!</span>
<a name="ln-89"></a>     <span class="c">!! This is mainly intenteded for internal use to transfer between real</span>
<a name="ln-90"></a>     <span class="c">!! data and the data containers.</span>
<a name="ln-91"></a>     <span class="c">!!</span>
<a name="ln-92"></a>     <span class="c">!! It is however required to enable external type storage routines.</span>
<a name="ln-93"></a>     <span class="k">module procedure </span><span class="n">enc_</span>
<a name="ln-94"></a>  <span class="k">end interface</span>
<a name="ln-95"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">enc</span>
<a name="ln-96"></a>  <span class="k">interface </span><span class="n">size_enc</span>
<a name="ln-97"></a>     <span class="c">!! The size of the encoding character array (`size(enc(&lt;&gt;))`)</span>
<a name="ln-98"></a>     <span class="c">!!</span>
<a name="ln-99"></a>     <span class="c">!! This is mainly intenteded for internal use to transfer between real</span>
<a name="ln-100"></a>     <span class="c">!! data and the data containers.</span>
<a name="ln-101"></a>     <span class="k">module procedure </span><span class="n">size_enc_</span>
<a name="ln-102"></a>  <span class="k">end interface</span>
<a name="ln-103"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">size_enc</span>
<a name="ln-104"></a>  <span class="c">! Specific routine for packing a character(len=*) to</span>
<a name="ln-105"></a>  <span class="c">! character(len=1) (:)</span>
<a name="ln-106"></a>  <span class="k">interface </span><span class="n">cpack</span>
<a name="ln-107"></a>     <span class="c">!! Convert a `character(len=*)` to `character, dimension(:)`</span>
<a name="ln-108"></a>     <span class="c">!!</span>
<a name="ln-109"></a>     <span class="c">!! A routine requirement for creating pointers to character storages.</span>
<a name="ln-110"></a>     <span class="c">!! One can convert from `len=*` to an array of `len=1` and back using [[cunpack]].</span>
<a name="ln-111"></a>     <span class="c">!!</span>
<a name="ln-112"></a>     <span class="c">!! Because fortran requires dimensions of arrays assignments to be same size it</span>
<a name="ln-113"></a>     <span class="c">!! one has to specify ranges if the length of the character is not equivalent</span>
<a name="ln-114"></a>     <span class="c">!! to the size of the array.</span>
<a name="ln-115"></a>     <span class="c">!!</span>
<a name="ln-116"></a>     <span class="c">!! Example:</span>
<a name="ln-117"></a>     <span class="c">!!</span>
<a name="ln-118"></a>     <span class="c">!!```fortran</span>
<a name="ln-119"></a>     <span class="c">!! character(len=20) :: a</span>
<a name="ln-120"></a>     <span class="c">!! character :: b(10)</span>
<a name="ln-121"></a>     <span class="c">!! a = &#39;Hello&#39;</span>
<a name="ln-122"></a>     <span class="c">!! b(1:5) = cpack(&#39;Hello&#39;)</span>
<a name="ln-123"></a>     <span class="c">!!```</span>
<a name="ln-124"></a>     <span class="c">!!</span>
<a name="ln-125"></a>     <span class="c">!! @note</span>
<a name="ln-126"></a>     <span class="c">!! This is a requirement because it is not possible to create a unified pointer</span>
<a name="ln-127"></a>     <span class="c">!! to arbitrary length characters. Hence we store all `len=*` variables as `len=1` character arrays.</span>
<a name="ln-128"></a>     <span class="k">module procedure </span><span class="n">cpack_</span>
<a name="ln-129"></a>  <span class="k">end interface </span><span class="n">cpack</span>
<a name="ln-130"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">cpack</span>
<a name="ln-131"></a>  <span class="c">! Specific routine for packing a character(len=*) to</span>
<a name="ln-132"></a>  <span class="c">! character(len=1) (:)</span>
<a name="ln-133"></a>  <span class="k">interface </span><span class="n">cunpack</span>
<a name="ln-134"></a>     <span class="c">!! Convert a `character(len=1), dimensions(:)` to `character(len=*)`</span>
<a name="ln-135"></a>     <span class="c">!!</span>
<a name="ln-136"></a>     <span class="c">!! Pack an array into a character of arbitrary length.</span>
<a name="ln-137"></a>     <span class="c">!! This convenience function helps converting between arrays of characters</span>
<a name="ln-138"></a>     <span class="c">!! and fixed length characters.</span>
<a name="ln-139"></a>     <span class="c">!!</span>
<a name="ln-140"></a>     <span class="c">!! As character assignment is not restricted similarly as array assignments</span>
<a name="ln-141"></a>     <span class="c">!! it is not a requirement to specify ranges when using this function.</span>
<a name="ln-142"></a>     <span class="k">module procedure </span><span class="n">cunpack_</span>
<a name="ln-143"></a>  <span class="k">end interface </span><span class="n">cunpack</span>
<a name="ln-144"></a>  <span class="k">public</span> <span class="kd">::</span> <span class="n">cunpack</span>
<a name="ln-145"></a><span class="k">interface assign</span>
<a name="ln-146"></a><span class="k">module procedure </span><span class="n">assign_get_a0_0</span>
<a name="ln-147"></a><span class="k">module procedure </span><span class="n">assign_set_a0_0</span>
<a name="ln-148"></a><span class="k">module procedure </span><span class="n">assign_var</span>
<a name="ln-149"></a><span class="k">module procedure </span><span class="n">assign_get_a1</span>
<a name="ln-150"></a><span class="k">module procedure </span><span class="n">assign_set_a1</span>
<a name="ln-151"></a><span class="k">module procedure </span><span class="n">assign_get_s0</span>
<a name="ln-152"></a><span class="k">module procedure </span><span class="n">assign_set_s0</span>
<a name="ln-153"></a><span class="k">module procedure </span><span class="n">assign_get_s1</span>
<a name="ln-154"></a><span class="k">module procedure </span><span class="n">assign_set_s1</span>
<a name="ln-155"></a><span class="k">module procedure </span><span class="n">assign_get_s2</span>
<a name="ln-156"></a><span class="k">module procedure </span><span class="n">assign_set_s2</span>
<a name="ln-157"></a><span class="k">module procedure </span><span class="n">assign_get_s3</span>
<a name="ln-158"></a><span class="k">module procedure </span><span class="n">assign_set_s3</span>
<a name="ln-159"></a><span class="k">module procedure </span><span class="n">assign_get_d0</span>
<a name="ln-160"></a><span class="k">module procedure </span><span class="n">assign_set_d0</span>
<a name="ln-161"></a><span class="k">module procedure </span><span class="n">assign_get_d1</span>
<a name="ln-162"></a><span class="k">module procedure </span><span class="n">assign_set_d1</span>
<a name="ln-163"></a><span class="k">module procedure </span><span class="n">assign_get_d2</span>
<a name="ln-164"></a><span class="k">module procedure </span><span class="n">assign_set_d2</span>
<a name="ln-165"></a><span class="k">module procedure </span><span class="n">assign_get_d3</span>
<a name="ln-166"></a><span class="k">module procedure </span><span class="n">assign_set_d3</span>
<a name="ln-167"></a><span class="k">module procedure </span><span class="n">assign_get_c0</span>
<a name="ln-168"></a><span class="k">module procedure </span><span class="n">assign_set_c0</span>
<a name="ln-169"></a><span class="k">module procedure </span><span class="n">assign_get_c1</span>
<a name="ln-170"></a><span class="k">module procedure </span><span class="n">assign_set_c1</span>
<a name="ln-171"></a><span class="k">module procedure </span><span class="n">assign_get_c2</span>
<a name="ln-172"></a><span class="k">module procedure </span><span class="n">assign_set_c2</span>
<a name="ln-173"></a><span class="k">module procedure </span><span class="n">assign_get_c3</span>
<a name="ln-174"></a><span class="k">module procedure </span><span class="n">assign_set_c3</span>
<a name="ln-175"></a><span class="k">module procedure </span><span class="n">assign_get_z0</span>
<a name="ln-176"></a><span class="k">module procedure </span><span class="n">assign_set_z0</span>
<a name="ln-177"></a><span class="k">module procedure </span><span class="n">assign_get_z1</span>
<a name="ln-178"></a><span class="k">module procedure </span><span class="n">assign_set_z1</span>
<a name="ln-179"></a><span class="k">module procedure </span><span class="n">assign_get_z2</span>
<a name="ln-180"></a><span class="k">module procedure </span><span class="n">assign_set_z2</span>
<a name="ln-181"></a><span class="k">module procedure </span><span class="n">assign_get_z3</span>
<a name="ln-182"></a><span class="k">module procedure </span><span class="n">assign_set_z3</span>
<a name="ln-183"></a><span class="k">module procedure </span><span class="n">assign_get_b0</span>
<a name="ln-184"></a><span class="k">module procedure </span><span class="n">assign_set_b0</span>
<a name="ln-185"></a><span class="k">module procedure </span><span class="n">assign_get_b1</span>
<a name="ln-186"></a><span class="k">module procedure </span><span class="n">assign_set_b1</span>
<a name="ln-187"></a><span class="k">module procedure </span><span class="n">assign_get_b2</span>
<a name="ln-188"></a><span class="k">module procedure </span><span class="n">assign_set_b2</span>
<a name="ln-189"></a><span class="k">module procedure </span><span class="n">assign_get_b3</span>
<a name="ln-190"></a><span class="k">module procedure </span><span class="n">assign_set_b3</span>
<a name="ln-191"></a><span class="k">module procedure </span><span class="n">assign_get_h0</span>
<a name="ln-192"></a><span class="k">module procedure </span><span class="n">assign_set_h0</span>
<a name="ln-193"></a><span class="k">module procedure </span><span class="n">assign_get_h1</span>
<a name="ln-194"></a><span class="k">module procedure </span><span class="n">assign_set_h1</span>
<a name="ln-195"></a><span class="k">module procedure </span><span class="n">assign_get_h2</span>
<a name="ln-196"></a><span class="k">module procedure </span><span class="n">assign_set_h2</span>
<a name="ln-197"></a><span class="k">module procedure </span><span class="n">assign_get_h3</span>
<a name="ln-198"></a><span class="k">module procedure </span><span class="n">assign_set_h3</span>
<a name="ln-199"></a><span class="k">module procedure </span><span class="n">assign_get_i0</span>
<a name="ln-200"></a><span class="k">module procedure </span><span class="n">assign_set_i0</span>
<a name="ln-201"></a><span class="k">module procedure </span><span class="n">assign_get_i1</span>
<a name="ln-202"></a><span class="k">module procedure </span><span class="n">assign_set_i1</span>
<a name="ln-203"></a><span class="k">module procedure </span><span class="n">assign_get_i2</span>
<a name="ln-204"></a><span class="k">module procedure </span><span class="n">assign_set_i2</span>
<a name="ln-205"></a><span class="k">module procedure </span><span class="n">assign_get_i3</span>
<a name="ln-206"></a><span class="k">module procedure </span><span class="n">assign_set_i3</span>
<a name="ln-207"></a><span class="k">module procedure </span><span class="n">assign_get_l0</span>
<a name="ln-208"></a><span class="k">module procedure </span><span class="n">assign_set_l0</span>
<a name="ln-209"></a><span class="k">module procedure </span><span class="n">assign_get_l1</span>
<a name="ln-210"></a><span class="k">module procedure </span><span class="n">assign_set_l1</span>
<a name="ln-211"></a><span class="k">module procedure </span><span class="n">assign_get_l2</span>
<a name="ln-212"></a><span class="k">module procedure </span><span class="n">assign_set_l2</span>
<a name="ln-213"></a><span class="k">module procedure </span><span class="n">assign_get_l3</span>
<a name="ln-214"></a><span class="k">module procedure </span><span class="n">assign_set_l3</span>
<a name="ln-215"></a><span class="k">module procedure </span><span class="n">assign_get_cp0</span>
<a name="ln-216"></a><span class="k">module procedure </span><span class="n">assign_set_cp0</span>
<a name="ln-217"></a><span class="k">module procedure </span><span class="n">assign_get_cp1</span>
<a name="ln-218"></a><span class="k">module procedure </span><span class="n">assign_set_cp1</span>
<a name="ln-219"></a><span class="k">module procedure </span><span class="n">assign_get_fp0</span>
<a name="ln-220"></a><span class="k">module procedure </span><span class="n">assign_set_fp0</span>
<a name="ln-221"></a><span class="k">module procedure </span><span class="n">assign_get_fp1</span>
<a name="ln-222"></a><span class="k">module procedure </span><span class="n">assign_set_fp1</span>
<a name="ln-223"></a><span class="k">end interface</span>
<a name="ln-224"></a><span class="k">public</span> <span class="kd">::</span> <span class="k">assign</span>
<a name="ln-225"></a><span class="k">interface associate</span>
<a name="ln-226"></a><span class="k">module procedure </span><span class="n">associate_var</span>
<a name="ln-227"></a><span class="k">module procedure </span><span class="n">associate_get_a1</span>
<a name="ln-228"></a><span class="k">module procedure </span><span class="n">associate_set_a1</span>
<a name="ln-229"></a><span class="k">module procedure </span><span class="n">associate_get_s0</span>
<a name="ln-230"></a><span class="k">module procedure </span><span class="n">associate_set_s0</span>
<a name="ln-231"></a><span class="k">module procedure </span><span class="n">associate_get_s1</span>
<a name="ln-232"></a><span class="k">module procedure </span><span class="n">associate_set_s1</span>
<a name="ln-233"></a><span class="k">module procedure </span><span class="n">associate_get_s2</span>
<a name="ln-234"></a><span class="k">module procedure </span><span class="n">associate_set_s2</span>
<a name="ln-235"></a><span class="k">module procedure </span><span class="n">associate_get_s3</span>
<a name="ln-236"></a><span class="k">module procedure </span><span class="n">associate_set_s3</span>
<a name="ln-237"></a><span class="k">module procedure </span><span class="n">associate_get_d0</span>
<a name="ln-238"></a><span class="k">module procedure </span><span class="n">associate_set_d0</span>
<a name="ln-239"></a><span class="k">module procedure </span><span class="n">associate_get_d1</span>
<a name="ln-240"></a><span class="k">module procedure </span><span class="n">associate_set_d1</span>
<a name="ln-241"></a><span class="k">module procedure </span><span class="n">associate_get_d2</span>
<a name="ln-242"></a><span class="k">module procedure </span><span class="n">associate_set_d2</span>
<a name="ln-243"></a><span class="k">module procedure </span><span class="n">associate_get_d3</span>
<a name="ln-244"></a><span class="k">module procedure </span><span class="n">associate_set_d3</span>
<a name="ln-245"></a><span class="k">module procedure </span><span class="n">associate_get_c0</span>
<a name="ln-246"></a><span class="k">module procedure </span><span class="n">associate_set_c0</span>
<a name="ln-247"></a><span class="k">module procedure </span><span class="n">associate_get_c1</span>
<a name="ln-248"></a><span class="k">module procedure </span><span class="n">associate_set_c1</span>
<a name="ln-249"></a><span class="k">module procedure </span><span class="n">associate_get_c2</span>
<a name="ln-250"></a><span class="k">module procedure </span><span class="n">associate_set_c2</span>
<a name="ln-251"></a><span class="k">module procedure </span><span class="n">associate_get_c3</span>
<a name="ln-252"></a><span class="k">module procedure </span><span class="n">associate_set_c3</span>
<a name="ln-253"></a><span class="k">module procedure </span><span class="n">associate_get_z0</span>
<a name="ln-254"></a><span class="k">module procedure </span><span class="n">associate_set_z0</span>
<a name="ln-255"></a><span class="k">module procedure </span><span class="n">associate_get_z1</span>
<a name="ln-256"></a><span class="k">module procedure </span><span class="n">associate_set_z1</span>
<a name="ln-257"></a><span class="k">module procedure </span><span class="n">associate_get_z2</span>
<a name="ln-258"></a><span class="k">module procedure </span><span class="n">associate_set_z2</span>
<a name="ln-259"></a><span class="k">module procedure </span><span class="n">associate_get_z3</span>
<a name="ln-260"></a><span class="k">module procedure </span><span class="n">associate_set_z3</span>
<a name="ln-261"></a><span class="k">module procedure </span><span class="n">associate_get_b0</span>
<a name="ln-262"></a><span class="k">module procedure </span><span class="n">associate_set_b0</span>
<a name="ln-263"></a><span class="k">module procedure </span><span class="n">associate_get_b1</span>
<a name="ln-264"></a><span class="k">module procedure </span><span class="n">associate_set_b1</span>
<a name="ln-265"></a><span class="k">module procedure </span><span class="n">associate_get_b2</span>
<a name="ln-266"></a><span class="k">module procedure </span><span class="n">associate_set_b2</span>
<a name="ln-267"></a><span class="k">module procedure </span><span class="n">associate_get_b3</span>
<a name="ln-268"></a><span class="k">module procedure </span><span class="n">associate_set_b3</span>
<a name="ln-269"></a><span class="k">module procedure </span><span class="n">associate_get_h0</span>
<a name="ln-270"></a><span class="k">module procedure </span><span class="n">associate_set_h0</span>
<a name="ln-271"></a><span class="k">module procedure </span><span class="n">associate_get_h1</span>
<a name="ln-272"></a><span class="k">module procedure </span><span class="n">associate_set_h1</span>
<a name="ln-273"></a><span class="k">module procedure </span><span class="n">associate_get_h2</span>
<a name="ln-274"></a><span class="k">module procedure </span><span class="n">associate_set_h2</span>
<a name="ln-275"></a><span class="k">module procedure </span><span class="n">associate_get_h3</span>
<a name="ln-276"></a><span class="k">module procedure </span><span class="n">associate_set_h3</span>
<a name="ln-277"></a><span class="k">module procedure </span><span class="n">associate_get_i0</span>
<a name="ln-278"></a><span class="k">module procedure </span><span class="n">associate_set_i0</span>
<a name="ln-279"></a><span class="k">module procedure </span><span class="n">associate_get_i1</span>
<a name="ln-280"></a><span class="k">module procedure </span><span class="n">associate_set_i1</span>
<a name="ln-281"></a><span class="k">module procedure </span><span class="n">associate_get_i2</span>
<a name="ln-282"></a><span class="k">module procedure </span><span class="n">associate_set_i2</span>
<a name="ln-283"></a><span class="k">module procedure </span><span class="n">associate_get_i3</span>
<a name="ln-284"></a><span class="k">module procedure </span><span class="n">associate_set_i3</span>
<a name="ln-285"></a><span class="k">module procedure </span><span class="n">associate_get_l0</span>
<a name="ln-286"></a><span class="k">module procedure </span><span class="n">associate_set_l0</span>
<a name="ln-287"></a><span class="k">module procedure </span><span class="n">associate_get_l1</span>
<a name="ln-288"></a><span class="k">module procedure </span><span class="n">associate_set_l1</span>
<a name="ln-289"></a><span class="k">module procedure </span><span class="n">associate_get_l2</span>
<a name="ln-290"></a><span class="k">module procedure </span><span class="n">associate_set_l2</span>
<a name="ln-291"></a><span class="k">module procedure </span><span class="n">associate_get_l3</span>
<a name="ln-292"></a><span class="k">module procedure </span><span class="n">associate_set_l3</span>
<a name="ln-293"></a><span class="k">module procedure </span><span class="n">associate_get_cp0</span>
<a name="ln-294"></a><span class="k">module procedure </span><span class="n">associate_set_cp0</span>
<a name="ln-295"></a><span class="k">module procedure </span><span class="n">associate_get_cp1</span>
<a name="ln-296"></a><span class="k">module procedure </span><span class="n">associate_set_cp1</span>
<a name="ln-297"></a><span class="k">module procedure </span><span class="n">associate_get_fp0</span>
<a name="ln-298"></a><span class="k">module procedure </span><span class="n">associate_set_fp0</span>
<a name="ln-299"></a><span class="k">module procedure </span><span class="n">associate_get_fp1</span>
<a name="ln-300"></a><span class="k">module procedure </span><span class="n">associate_set_fp1</span>
<a name="ln-301"></a><span class="k">end interface</span>
<a name="ln-302"></a><span class="k">public</span> <span class="kd">::</span> <span class="k">associate</span>
<a name="ln-303"></a><span class="k">interface </span><span class="n">associatd</span>
<a name="ln-304"></a><span class="k">module procedure </span><span class="n">associatd_l_a1</span>
<a name="ln-305"></a><span class="k">module procedure </span><span class="n">associatd_r_a1</span>
<a name="ln-306"></a><span class="k">module procedure </span><span class="n">associatd_l_s0</span>
<a name="ln-307"></a><span class="k">module procedure </span><span class="n">associatd_r_s0</span>
<a name="ln-308"></a><span class="k">module procedure </span><span class="n">associatd_l_s1</span>
<a name="ln-309"></a><span class="k">module procedure </span><span class="n">associatd_r_s1</span>
<a name="ln-310"></a><span class="k">module procedure </span><span class="n">associatd_l_s2</span>
<a name="ln-311"></a><span class="k">module procedure </span><span class="n">associatd_r_s2</span>
<a name="ln-312"></a><span class="k">module procedure </span><span class="n">associatd_l_s3</span>
<a name="ln-313"></a><span class="k">module procedure </span><span class="n">associatd_r_s3</span>
<a name="ln-314"></a><span class="k">module procedure </span><span class="n">associatd_l_d0</span>
<a name="ln-315"></a><span class="k">module procedure </span><span class="n">associatd_r_d0</span>
<a name="ln-316"></a><span class="k">module procedure </span><span class="n">associatd_l_d1</span>
<a name="ln-317"></a><span class="k">module procedure </span><span class="n">associatd_r_d1</span>
<a name="ln-318"></a><span class="k">module procedure </span><span class="n">associatd_l_d2</span>
<a name="ln-319"></a><span class="k">module procedure </span><span class="n">associatd_r_d2</span>
<a name="ln-320"></a><span class="k">module procedure </span><span class="n">associatd_l_d3</span>
<a name="ln-321"></a><span class="k">module procedure </span><span class="n">associatd_r_d3</span>
<a name="ln-322"></a><span class="k">module procedure </span><span class="n">associatd_l_c0</span>
<a name="ln-323"></a><span class="k">module procedure </span><span class="n">associatd_r_c0</span>
<a name="ln-324"></a><span class="k">module procedure </span><span class="n">associatd_l_c1</span>
<a name="ln-325"></a><span class="k">module procedure </span><span class="n">associatd_r_c1</span>
<a name="ln-326"></a><span class="k">module procedure </span><span class="n">associatd_l_c2</span>
<a name="ln-327"></a><span class="k">module procedure </span><span class="n">associatd_r_c2</span>
<a name="ln-328"></a><span class="k">module procedure </span><span class="n">associatd_l_c3</span>
<a name="ln-329"></a><span class="k">module procedure </span><span class="n">associatd_r_c3</span>
<a name="ln-330"></a><span class="k">module procedure </span><span class="n">associatd_l_z0</span>
<a name="ln-331"></a><span class="k">module procedure </span><span class="n">associatd_r_z0</span>
<a name="ln-332"></a><span class="k">module procedure </span><span class="n">associatd_l_z1</span>
<a name="ln-333"></a><span class="k">module procedure </span><span class="n">associatd_r_z1</span>
<a name="ln-334"></a><span class="k">module procedure </span><span class="n">associatd_l_z2</span>
<a name="ln-335"></a><span class="k">module procedure </span><span class="n">associatd_r_z2</span>
<a name="ln-336"></a><span class="k">module procedure </span><span class="n">associatd_l_z3</span>
<a name="ln-337"></a><span class="k">module procedure </span><span class="n">associatd_r_z3</span>
<a name="ln-338"></a><span class="k">module procedure </span><span class="n">associatd_l_b0</span>
<a name="ln-339"></a><span class="k">module procedure </span><span class="n">associatd_r_b0</span>
<a name="ln-340"></a><span class="k">module procedure </span><span class="n">associatd_l_b1</span>
<a name="ln-341"></a><span class="k">module procedure </span><span class="n">associatd_r_b1</span>
<a name="ln-342"></a><span class="k">module procedure </span><span class="n">associatd_l_b2</span>
<a name="ln-343"></a><span class="k">module procedure </span><span class="n">associatd_r_b2</span>
<a name="ln-344"></a><span class="k">module procedure </span><span class="n">associatd_l_b3</span>
<a name="ln-345"></a><span class="k">module procedure </span><span class="n">associatd_r_b3</span>
<a name="ln-346"></a><span class="k">module procedure </span><span class="n">associatd_l_h0</span>
<a name="ln-347"></a><span class="k">module procedure </span><span class="n">associatd_r_h0</span>
<a name="ln-348"></a><span class="k">module procedure </span><span class="n">associatd_l_h1</span>
<a name="ln-349"></a><span class="k">module procedure </span><span class="n">associatd_r_h1</span>
<a name="ln-350"></a><span class="k">module procedure </span><span class="n">associatd_l_h2</span>
<a name="ln-351"></a><span class="k">module procedure </span><span class="n">associatd_r_h2</span>
<a name="ln-352"></a><span class="k">module procedure </span><span class="n">associatd_l_h3</span>
<a name="ln-353"></a><span class="k">module procedure </span><span class="n">associatd_r_h3</span>
<a name="ln-354"></a><span class="k">module procedure </span><span class="n">associatd_l_i0</span>
<a name="ln-355"></a><span class="k">module procedure </span><span class="n">associatd_r_i0</span>
<a name="ln-356"></a><span class="k">module procedure </span><span class="n">associatd_l_i1</span>
<a name="ln-357"></a><span class="k">module procedure </span><span class="n">associatd_r_i1</span>
<a name="ln-358"></a><span class="k">module procedure </span><span class="n">associatd_l_i2</span>
<a name="ln-359"></a><span class="k">module procedure </span><span class="n">associatd_r_i2</span>
<a name="ln-360"></a><span class="k">module procedure </span><span class="n">associatd_l_i3</span>
<a name="ln-361"></a><span class="k">module procedure </span><span class="n">associatd_r_i3</span>
<a name="ln-362"></a><span class="k">module procedure </span><span class="n">associatd_l_l0</span>
<a name="ln-363"></a><span class="k">module procedure </span><span class="n">associatd_r_l0</span>
<a name="ln-364"></a><span class="k">module procedure </span><span class="n">associatd_l_l1</span>
<a name="ln-365"></a><span class="k">module procedure </span><span class="n">associatd_r_l1</span>
<a name="ln-366"></a><span class="k">module procedure </span><span class="n">associatd_l_l2</span>
<a name="ln-367"></a><span class="k">module procedure </span><span class="n">associatd_r_l2</span>
<a name="ln-368"></a><span class="k">module procedure </span><span class="n">associatd_l_l3</span>
<a name="ln-369"></a><span class="k">module procedure </span><span class="n">associatd_r_l3</span>
<a name="ln-370"></a><span class="k">module procedure </span><span class="n">associatd_l_cp0</span>
<a name="ln-371"></a><span class="k">module procedure </span><span class="n">associatd_r_cp0</span>
<a name="ln-372"></a><span class="k">module procedure </span><span class="n">associatd_l_cp1</span>
<a name="ln-373"></a><span class="k">module procedure </span><span class="n">associatd_r_cp1</span>
<a name="ln-374"></a><span class="k">module procedure </span><span class="n">associatd_l_fp0</span>
<a name="ln-375"></a><span class="k">module procedure </span><span class="n">associatd_r_fp0</span>
<a name="ln-376"></a><span class="k">module procedure </span><span class="n">associatd_l_fp1</span>
<a name="ln-377"></a><span class="k">module procedure </span><span class="n">associatd_r_fp1</span>
<a name="ln-378"></a><span class="k">end interface</span>
<a name="ln-379"></a><span class="k">public</span> <span class="kd">::</span> <span class="n">associatd</span>
<a name="ln-380"></a><span class="k">contains</span>
<a name="ln-381"></a><span class="k">  subroutine </span><span class="n">print_</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-382"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-383"></a>    <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(t2,a)&#39;</span><span class="p">)</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span>
<a name="ln-384"></a>  <span class="k">end subroutine </span><span class="n">print_</span>
<a name="ln-385"></a>  <span class="k">elemental function </span><span class="n">which_</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="ln-386"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-387"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">VARIABLE_TYPE_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">t</span>
<a name="ln-388"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span>
<a name="ln-389"></a>  <span class="k">end function </span><span class="n">which_</span>
<a name="ln-390"></a>  <span class="k">subroutine </span><span class="n">delete_</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-391"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-392"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-393"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-394"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta1</span>
<a name="ln-395"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-396"></a><span class="k">end type </span><span class="n">pta1</span>
<a name="ln-397"></a><span class="k">type</span><span class="p">(</span><span class="n">pta1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa1</span>
<a name="ln-398"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts0</span>
<a name="ln-399"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-400"></a><span class="k">end type </span><span class="n">pts0</span>
<a name="ln-401"></a><span class="k">type</span><span class="p">(</span><span class="n">pts0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps0</span>
<a name="ln-402"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts1</span>
<a name="ln-403"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-404"></a><span class="k">end type </span><span class="n">pts1</span>
<a name="ln-405"></a><span class="k">type</span><span class="p">(</span><span class="n">pts1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps1</span>
<a name="ln-406"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts2</span>
<a name="ln-407"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-408"></a><span class="k">end type </span><span class="n">pts2</span>
<a name="ln-409"></a><span class="k">type</span><span class="p">(</span><span class="n">pts2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps2</span>
<a name="ln-410"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts3</span>
<a name="ln-411"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-412"></a><span class="k">end type </span><span class="n">pts3</span>
<a name="ln-413"></a><span class="k">type</span><span class="p">(</span><span class="n">pts3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps3</span>
<a name="ln-414"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd0</span>
<a name="ln-415"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-416"></a><span class="k">end type </span><span class="n">ptd0</span>
<a name="ln-417"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd0</span>
<a name="ln-418"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd1</span>
<a name="ln-419"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-420"></a><span class="k">end type </span><span class="n">ptd1</span>
<a name="ln-421"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd1</span>
<a name="ln-422"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd2</span>
<a name="ln-423"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-424"></a><span class="k">end type </span><span class="n">ptd2</span>
<a name="ln-425"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd2</span>
<a name="ln-426"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd3</span>
<a name="ln-427"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-428"></a><span class="k">end type </span><span class="n">ptd3</span>
<a name="ln-429"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd3</span>
<a name="ln-430"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc0</span>
<a name="ln-431"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-432"></a><span class="k">end type </span><span class="n">ptc0</span>
<a name="ln-433"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc0</span>
<a name="ln-434"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc1</span>
<a name="ln-435"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-436"></a><span class="k">end type </span><span class="n">ptc1</span>
<a name="ln-437"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc1</span>
<a name="ln-438"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc2</span>
<a name="ln-439"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-440"></a><span class="k">end type </span><span class="n">ptc2</span>
<a name="ln-441"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc2</span>
<a name="ln-442"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc3</span>
<a name="ln-443"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-444"></a><span class="k">end type </span><span class="n">ptc3</span>
<a name="ln-445"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc3</span>
<a name="ln-446"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz0</span>
<a name="ln-447"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-448"></a><span class="k">end type </span><span class="n">ptz0</span>
<a name="ln-449"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz0</span>
<a name="ln-450"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz1</span>
<a name="ln-451"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-452"></a><span class="k">end type </span><span class="n">ptz1</span>
<a name="ln-453"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz1</span>
<a name="ln-454"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz2</span>
<a name="ln-455"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-456"></a><span class="k">end type </span><span class="n">ptz2</span>
<a name="ln-457"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz2</span>
<a name="ln-458"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz3</span>
<a name="ln-459"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-460"></a><span class="k">end type </span><span class="n">ptz3</span>
<a name="ln-461"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz3</span>
<a name="ln-462"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb0</span>
<a name="ln-463"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-464"></a><span class="k">end type </span><span class="n">ptb0</span>
<a name="ln-465"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb0</span>
<a name="ln-466"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb1</span>
<a name="ln-467"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-468"></a><span class="k">end type </span><span class="n">ptb1</span>
<a name="ln-469"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb1</span>
<a name="ln-470"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb2</span>
<a name="ln-471"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-472"></a><span class="k">end type </span><span class="n">ptb2</span>
<a name="ln-473"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb2</span>
<a name="ln-474"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb3</span>
<a name="ln-475"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-476"></a><span class="k">end type </span><span class="n">ptb3</span>
<a name="ln-477"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb3</span>
<a name="ln-478"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth0</span>
<a name="ln-479"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-480"></a><span class="k">end type </span><span class="n">pth0</span>
<a name="ln-481"></a><span class="k">type</span><span class="p">(</span><span class="n">pth0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph0</span>
<a name="ln-482"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth1</span>
<a name="ln-483"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-484"></a><span class="k">end type </span><span class="n">pth1</span>
<a name="ln-485"></a><span class="k">type</span><span class="p">(</span><span class="n">pth1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph1</span>
<a name="ln-486"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth2</span>
<a name="ln-487"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-488"></a><span class="k">end type </span><span class="n">pth2</span>
<a name="ln-489"></a><span class="k">type</span><span class="p">(</span><span class="n">pth2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph2</span>
<a name="ln-490"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth3</span>
<a name="ln-491"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-492"></a><span class="k">end type </span><span class="n">pth3</span>
<a name="ln-493"></a><span class="k">type</span><span class="p">(</span><span class="n">pth3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph3</span>
<a name="ln-494"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti0</span>
<a name="ln-495"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-496"></a><span class="k">end type </span><span class="n">pti0</span>
<a name="ln-497"></a><span class="k">type</span><span class="p">(</span><span class="n">pti0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi0</span>
<a name="ln-498"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti1</span>
<a name="ln-499"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-500"></a><span class="k">end type </span><span class="n">pti1</span>
<a name="ln-501"></a><span class="k">type</span><span class="p">(</span><span class="n">pti1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi1</span>
<a name="ln-502"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti2</span>
<a name="ln-503"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-504"></a><span class="k">end type </span><span class="n">pti2</span>
<a name="ln-505"></a><span class="k">type</span><span class="p">(</span><span class="n">pti2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi2</span>
<a name="ln-506"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti3</span>
<a name="ln-507"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-508"></a><span class="k">end type </span><span class="n">pti3</span>
<a name="ln-509"></a><span class="k">type</span><span class="p">(</span><span class="n">pti3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi3</span>
<a name="ln-510"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl0</span>
<a name="ln-511"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-512"></a><span class="k">end type </span><span class="n">ptl0</span>
<a name="ln-513"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl0</span>
<a name="ln-514"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl1</span>
<a name="ln-515"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-516"></a><span class="k">end type </span><span class="n">ptl1</span>
<a name="ln-517"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl1</span>
<a name="ln-518"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl2</span>
<a name="ln-519"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-520"></a><span class="k">end type </span><span class="n">ptl2</span>
<a name="ln-521"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl2</span>
<a name="ln-522"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl3</span>
<a name="ln-523"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-524"></a><span class="k">end type </span><span class="n">ptl3</span>
<a name="ln-525"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl3</span>
<a name="ln-526"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp0</span>
<a name="ln-527"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-528"></a><span class="k">end type </span><span class="n">ptcp0</span>
<a name="ln-529"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp0</span>
<a name="ln-530"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp1</span>
<a name="ln-531"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-532"></a><span class="k">end type </span><span class="n">ptcp1</span>
<a name="ln-533"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp1</span>
<a name="ln-534"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp0</span>
<a name="ln-535"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-536"></a><span class="k">end type </span><span class="n">ptfp0</span>
<a name="ln-537"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp0</span>
<a name="ln-538"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp1</span>
<a name="ln-539"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-540"></a><span class="k">end type </span><span class="n">ptfp1</span>
<a name="ln-541"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp1</span>
<a name="ln-542"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta_</span>
<a name="ln-543"></a> <span class="k">type</span><span class="p">(</span><span class="n">pta__</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-544"></a><span class="k">end type </span><span class="n">pta_</span>
<a name="ln-545"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta__</span>
<a name="ln-546"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-547"></a><span class="k">end type </span><span class="n">pta__</span>
<a name="ln-548"></a><span class="k">type</span><span class="p">(</span><span class="n">pta_</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa_</span>
<a name="ln-549"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-550"></a>    <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-551"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">)</span> <span class="p">)</span> <span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-552"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">ldealloc</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-553"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-554"></a><span class="k">  </span><span class="n">pa1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pa1</span><span class="p">)</span>
<a name="ln-555"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pa1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-556"></a><span class="k">end if</span>
<a name="ln-557"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-558"></a><span class="k">  </span><span class="n">ps0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps0</span><span class="p">)</span>
<a name="ln-559"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ps0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-560"></a><span class="k">end if</span>
<a name="ln-561"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-562"></a><span class="k">  </span><span class="n">ps1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps1</span><span class="p">)</span>
<a name="ln-563"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ps1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-564"></a><span class="k">end if</span>
<a name="ln-565"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-566"></a><span class="k">  </span><span class="n">ps2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps2</span><span class="p">)</span>
<a name="ln-567"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ps2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-568"></a><span class="k">end if</span>
<a name="ln-569"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-570"></a><span class="k">  </span><span class="n">ps3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps3</span><span class="p">)</span>
<a name="ln-571"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ps3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-572"></a><span class="k">end if</span>
<a name="ln-573"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-574"></a><span class="k">  </span><span class="n">pd0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd0</span><span class="p">)</span>
<a name="ln-575"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pd0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-576"></a><span class="k">end if</span>
<a name="ln-577"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-578"></a><span class="k">  </span><span class="n">pd1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd1</span><span class="p">)</span>
<a name="ln-579"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pd1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-580"></a><span class="k">end if</span>
<a name="ln-581"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-582"></a><span class="k">  </span><span class="n">pd2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd2</span><span class="p">)</span>
<a name="ln-583"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pd2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-584"></a><span class="k">end if</span>
<a name="ln-585"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-586"></a><span class="k">  </span><span class="n">pd3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd3</span><span class="p">)</span>
<a name="ln-587"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pd3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-588"></a><span class="k">end if</span>
<a name="ln-589"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-590"></a><span class="k">  </span><span class="n">pc0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc0</span><span class="p">)</span>
<a name="ln-591"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pc0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-592"></a><span class="k">end if</span>
<a name="ln-593"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-594"></a><span class="k">  </span><span class="n">pc1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc1</span><span class="p">)</span>
<a name="ln-595"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pc1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-596"></a><span class="k">end if</span>
<a name="ln-597"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-598"></a><span class="k">  </span><span class="n">pc2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc2</span><span class="p">)</span>
<a name="ln-599"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pc2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-600"></a><span class="k">end if</span>
<a name="ln-601"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-602"></a><span class="k">  </span><span class="n">pc3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc3</span><span class="p">)</span>
<a name="ln-603"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pc3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-604"></a><span class="k">end if</span>
<a name="ln-605"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-606"></a><span class="k">  </span><span class="n">pz0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz0</span><span class="p">)</span>
<a name="ln-607"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pz0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-608"></a><span class="k">end if</span>
<a name="ln-609"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-610"></a><span class="k">  </span><span class="n">pz1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz1</span><span class="p">)</span>
<a name="ln-611"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pz1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-612"></a><span class="k">end if</span>
<a name="ln-613"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-614"></a><span class="k">  </span><span class="n">pz2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz2</span><span class="p">)</span>
<a name="ln-615"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pz2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-616"></a><span class="k">end if</span>
<a name="ln-617"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-618"></a><span class="k">  </span><span class="n">pz3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz3</span><span class="p">)</span>
<a name="ln-619"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pz3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-620"></a><span class="k">end if</span>
<a name="ln-621"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-622"></a><span class="k">  </span><span class="n">pb0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb0</span><span class="p">)</span>
<a name="ln-623"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pb0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-624"></a><span class="k">end if</span>
<a name="ln-625"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-626"></a><span class="k">  </span><span class="n">pb1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb1</span><span class="p">)</span>
<a name="ln-627"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pb1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-628"></a><span class="k">end if</span>
<a name="ln-629"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-630"></a><span class="k">  </span><span class="n">pb2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb2</span><span class="p">)</span>
<a name="ln-631"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pb2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-632"></a><span class="k">end if</span>
<a name="ln-633"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-634"></a><span class="k">  </span><span class="n">pb3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb3</span><span class="p">)</span>
<a name="ln-635"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pb3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-636"></a><span class="k">end if</span>
<a name="ln-637"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-638"></a><span class="k">  </span><span class="n">ph0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph0</span><span class="p">)</span>
<a name="ln-639"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ph0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-640"></a><span class="k">end if</span>
<a name="ln-641"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-642"></a><span class="k">  </span><span class="n">ph1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph1</span><span class="p">)</span>
<a name="ln-643"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ph1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-644"></a><span class="k">end if</span>
<a name="ln-645"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-646"></a><span class="k">  </span><span class="n">ph2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph2</span><span class="p">)</span>
<a name="ln-647"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ph2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-648"></a><span class="k">end if</span>
<a name="ln-649"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-650"></a><span class="k">  </span><span class="n">ph3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph3</span><span class="p">)</span>
<a name="ln-651"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">ph3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-652"></a><span class="k">end if</span>
<a name="ln-653"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-654"></a><span class="k">  </span><span class="n">pi0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi0</span><span class="p">)</span>
<a name="ln-655"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pi0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-656"></a><span class="k">end if</span>
<a name="ln-657"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-658"></a><span class="k">  </span><span class="n">pi1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi1</span><span class="p">)</span>
<a name="ln-659"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pi1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-660"></a><span class="k">end if</span>
<a name="ln-661"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-662"></a><span class="k">  </span><span class="n">pi2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi2</span><span class="p">)</span>
<a name="ln-663"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pi2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-664"></a><span class="k">end if</span>
<a name="ln-665"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-666"></a><span class="k">  </span><span class="n">pi3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi3</span><span class="p">)</span>
<a name="ln-667"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pi3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-668"></a><span class="k">end if</span>
<a name="ln-669"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-670"></a><span class="k">  </span><span class="n">pl0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl0</span><span class="p">)</span>
<a name="ln-671"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pl0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-672"></a><span class="k">end if</span>
<a name="ln-673"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-674"></a><span class="k">  </span><span class="n">pl1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl1</span><span class="p">)</span>
<a name="ln-675"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pl1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-676"></a><span class="k">end if</span>
<a name="ln-677"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l2&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-678"></a><span class="k">  </span><span class="n">pl2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl2</span><span class="p">)</span>
<a name="ln-679"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pl2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-680"></a><span class="k">end if</span>
<a name="ln-681"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l3&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-682"></a><span class="k">  </span><span class="n">pl3</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl3</span><span class="p">)</span>
<a name="ln-683"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pl3</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-684"></a><span class="k">end if</span>
<a name="ln-685"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-686"></a><span class="k">  </span><span class="n">pcp0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp0</span><span class="p">)</span>
<a name="ln-687"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pcp0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-688"></a><span class="k">end if</span>
<a name="ln-689"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-690"></a><span class="k">  </span><span class="n">pcp1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp1</span><span class="p">)</span>
<a name="ln-691"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pcp1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-692"></a><span class="k">end if</span>
<a name="ln-693"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-694"></a><span class="k">  </span><span class="n">pfp0</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp0</span><span class="p">)</span>
<a name="ln-695"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pfp0</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-696"></a><span class="k">end if</span>
<a name="ln-697"></a><span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp1&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-698"></a><span class="k">  </span><span class="n">pfp1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp1</span><span class="p">)</span>
<a name="ln-699"></a>  <span class="k">deallocate</span><span class="p">(</span><span class="n">pfp1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-700"></a><span class="k">end if</span>
<a name="ln-701"></a><span class="k">       if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a-&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-702"></a><span class="k">          </span><span class="n">pa_</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pa_</span><span class="p">)</span>
<a name="ln-703"></a>          <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">pa_</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-704"></a>             <span class="k">deallocate</span><span class="p">(</span><span class="n">pa_</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-705"></a>          <span class="k">end do</span>
<a name="ln-706"></a><span class="k">          deallocate</span><span class="p">(</span><span class="n">pa_</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-707"></a>       <span class="k">end if</span>
<a name="ln-708"></a><span class="k">    end if</span>
<a name="ln-709"></a><span class="k">    call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-710"></a>  <span class="k">end subroutine </span><span class="n">delete_</span>
<a name="ln-711"></a>  <span class="k">elemental subroutine </span><span class="n">nullify_</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-712"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-713"></a>    <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span>
<a name="ln-714"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">)</span> <span class="p">)</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">)</span>
<a name="ln-715"></a>  <span class="k">end subroutine </span><span class="n">nullify_</span>
<a name="ln-716"></a>  <span class="c">! Returns the bare encoding of this variable</span>
<a name="ln-717"></a>  <span class="c">! This can ease the process of assigning</span>
<a name="ln-718"></a>  <span class="c">! user-types to a variable.</span>
<a name="ln-719"></a>  <span class="c">! An encoding might be 2, or 10000000 bytes big.</span>
<a name="ln-720"></a>  <span class="c">! Therefore we use a subroutine to determine</span>
<a name="ln-721"></a>  <span class="c">! the size of the returning encoding characters.</span>
<a name="ln-722"></a>  <span class="c">! If the size of the returning enc is not</span>
<a name="ln-723"></a>  <span class="c">! big enough it will be reset to &#39; &#39;</span>
<a name="ln-724"></a>  <span class="k">subroutine </span><span class="n">enc_</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">enc</span><span class="p">)</span>
<a name="ln-725"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-726"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enc</span><span class="p">(:)</span>
<a name="ln-727"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-728"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-729"></a><span class="k">       </span><span class="n">enc</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-730"></a>    <span class="k">else</span>
<a name="ln-731"></a>       <span class="c">! We do have an encoding</span>
<a name="ln-732"></a>       <span class="n">i</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">)</span>
<a name="ln-733"></a>       <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">size</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-734"></a><span class="k">          </span><span class="n">enc</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-735"></a>       <span class="k">else</span>
<a name="ln-736"></a><span class="k">          </span><span class="n">enc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">enc</span>
<a name="ln-737"></a>       <span class="k">end if</span>
<a name="ln-738"></a><span class="k">    end if</span>
<a name="ln-739"></a><span class="k">  end subroutine </span><span class="n">enc_</span>
<a name="ln-740"></a>  <span class="k">function </span><span class="n">size_enc_</span><span class="p">(</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<a name="ln-741"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-742"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="nb">len</span>
<a name="ln-743"></a><span class="nb">    </span><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;  &#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-744"></a><span class="k">       </span><span class="nb">len</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-745"></a>    <span class="k">else</span>
<a name="ln-746"></a><span class="k">       </span><span class="nb">len</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">)</span>
<a name="ln-747"></a>    <span class="k">end if</span>
<a name="ln-748"></a><span class="k">  end function </span><span class="n">size_enc_</span>
<a name="ln-749"></a>  <span class="c">! We allow the user to pass an encoding field.</span>
<a name="ln-750"></a>  <span class="c">! As this is the same as passing a char</span>
<a name="ln-751"></a>  <span class="c">! we MUST use a specific routine for this.</span>
<a name="ln-752"></a>  <span class="c">! One _could_, in principle, add an optional</span>
<a name="ln-753"></a>  <span class="c">! logical flag for the assign_set_a_, however</span>
<a name="ln-754"></a>  <span class="c">! one cannot assign a type by passing a reference</span>
<a name="ln-755"></a>  <span class="c">! and hence we ONLY allow associate_type</span>
<a name="ln-756"></a>  <span class="c">! This also means that any de-allocation of variables</span>
<a name="ln-757"></a>  <span class="c">! containing an external type will only de-reference it.</span>
<a name="ln-758"></a>  <span class="c">! A bit counter-intuitive, yet the variable type needs</span>
<a name="ln-759"></a>  <span class="c">! all information about the type to successfully de-allocate it.</span>
<a name="ln-760"></a>  <span class="c">! It is ALSO very important that the user</span>
<a name="ln-761"></a>  <span class="c">! passed the full-encoding WITHOUT padding of &#39; &#39;.</span>
<a name="ln-762"></a>  <span class="c">! We cannot know for sure whether the encoding actually terminates</span>
<a name="ln-763"></a>  <span class="c">! in a bit corresponding to char(&#39; &#39;)!</span>
<a name="ln-764"></a>  <span class="k">subroutine </span><span class="n">associate_type_</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">enc</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-765"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-766"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">enc</span><span class="p">(:)</span>
<a name="ln-767"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-768"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-769"></a>    <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-770"></a>    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-771"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-772"></a>       <span class="c">! if we do not deallocate, nullify</span>
<a name="ln-773"></a>       <span class="k">call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-774"></a>    <span class="k">else</span>
<a name="ln-775"></a><span class="k">       call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-776"></a>    <span class="k">end if</span>
<a name="ln-777"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span>
<a name="ln-778"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">enc</span><span class="p">)))</span>
<a name="ln-779"></a>    <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">enc</span>
<a name="ln-780"></a>  <span class="k">end subroutine </span><span class="n">associate_type_</span>
<a name="ln-781"></a>  <span class="k">function </span><span class="n">cpack_</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<a name="ln-782"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-783"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">car</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a name="ln-784"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-785"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-786"></a>       <span class="n">car</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-787"></a>    <span class="k">end do</span>
<a name="ln-788"></a><span class="k">  end function </span><span class="n">cpack_</span>
<a name="ln-789"></a>  <span class="k">function </span><span class="n">cunpack_</span><span class="p">(</span><span class="n">car</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-790"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">car</span><span class="p">(:)</span>
<a name="ln-791"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">size</span><span class="p">(</span><span class="n">car</span><span class="p">))</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-792"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-793"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<a name="ln-794"></a>       <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">car</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-795"></a>    <span class="k">end do</span>
<a name="ln-796"></a><span class="k">  end function </span><span class="n">cunpack_</span>
<a name="ln-797"></a>  <span class="k">subroutine </span><span class="n">assign_var</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-798"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-799"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-800"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-801"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-802"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-803"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta1</span>
<a name="ln-804"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-805"></a><span class="k">end type </span><span class="n">pta1</span>
<a name="ln-806"></a><span class="k">type</span><span class="p">(</span><span class="n">pta1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa1_1</span><span class="p">,</span> <span class="n">pa1_2</span>
<a name="ln-807"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts0</span>
<a name="ln-808"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-809"></a><span class="k">end type </span><span class="n">pts0</span>
<a name="ln-810"></a><span class="k">type</span><span class="p">(</span><span class="n">pts0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps0_1</span><span class="p">,</span> <span class="n">ps0_2</span>
<a name="ln-811"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts1</span>
<a name="ln-812"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-813"></a><span class="k">end type </span><span class="n">pts1</span>
<a name="ln-814"></a><span class="k">type</span><span class="p">(</span><span class="n">pts1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps1_1</span><span class="p">,</span> <span class="n">ps1_2</span>
<a name="ln-815"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts2</span>
<a name="ln-816"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-817"></a><span class="k">end type </span><span class="n">pts2</span>
<a name="ln-818"></a><span class="k">type</span><span class="p">(</span><span class="n">pts2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps2_1</span><span class="p">,</span> <span class="n">ps2_2</span>
<a name="ln-819"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts3</span>
<a name="ln-820"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-821"></a><span class="k">end type </span><span class="n">pts3</span>
<a name="ln-822"></a><span class="k">type</span><span class="p">(</span><span class="n">pts3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps3_1</span><span class="p">,</span> <span class="n">ps3_2</span>
<a name="ln-823"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd0</span>
<a name="ln-824"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-825"></a><span class="k">end type </span><span class="n">ptd0</span>
<a name="ln-826"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd0_1</span><span class="p">,</span> <span class="n">pd0_2</span>
<a name="ln-827"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd1</span>
<a name="ln-828"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-829"></a><span class="k">end type </span><span class="n">ptd1</span>
<a name="ln-830"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd1_1</span><span class="p">,</span> <span class="n">pd1_2</span>
<a name="ln-831"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd2</span>
<a name="ln-832"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-833"></a><span class="k">end type </span><span class="n">ptd2</span>
<a name="ln-834"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd2_1</span><span class="p">,</span> <span class="n">pd2_2</span>
<a name="ln-835"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd3</span>
<a name="ln-836"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-837"></a><span class="k">end type </span><span class="n">ptd3</span>
<a name="ln-838"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd3_1</span><span class="p">,</span> <span class="n">pd3_2</span>
<a name="ln-839"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc0</span>
<a name="ln-840"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-841"></a><span class="k">end type </span><span class="n">ptc0</span>
<a name="ln-842"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc0_1</span><span class="p">,</span> <span class="n">pc0_2</span>
<a name="ln-843"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc1</span>
<a name="ln-844"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-845"></a><span class="k">end type </span><span class="n">ptc1</span>
<a name="ln-846"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc1_1</span><span class="p">,</span> <span class="n">pc1_2</span>
<a name="ln-847"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc2</span>
<a name="ln-848"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-849"></a><span class="k">end type </span><span class="n">ptc2</span>
<a name="ln-850"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc2_1</span><span class="p">,</span> <span class="n">pc2_2</span>
<a name="ln-851"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc3</span>
<a name="ln-852"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-853"></a><span class="k">end type </span><span class="n">ptc3</span>
<a name="ln-854"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc3_1</span><span class="p">,</span> <span class="n">pc3_2</span>
<a name="ln-855"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz0</span>
<a name="ln-856"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-857"></a><span class="k">end type </span><span class="n">ptz0</span>
<a name="ln-858"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz0_1</span><span class="p">,</span> <span class="n">pz0_2</span>
<a name="ln-859"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz1</span>
<a name="ln-860"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-861"></a><span class="k">end type </span><span class="n">ptz1</span>
<a name="ln-862"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz1_1</span><span class="p">,</span> <span class="n">pz1_2</span>
<a name="ln-863"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz2</span>
<a name="ln-864"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-865"></a><span class="k">end type </span><span class="n">ptz2</span>
<a name="ln-866"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz2_1</span><span class="p">,</span> <span class="n">pz2_2</span>
<a name="ln-867"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz3</span>
<a name="ln-868"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-869"></a><span class="k">end type </span><span class="n">ptz3</span>
<a name="ln-870"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz3_1</span><span class="p">,</span> <span class="n">pz3_2</span>
<a name="ln-871"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb0</span>
<a name="ln-872"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-873"></a><span class="k">end type </span><span class="n">ptb0</span>
<a name="ln-874"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb0_1</span><span class="p">,</span> <span class="n">pb0_2</span>
<a name="ln-875"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb1</span>
<a name="ln-876"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-877"></a><span class="k">end type </span><span class="n">ptb1</span>
<a name="ln-878"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb1_1</span><span class="p">,</span> <span class="n">pb1_2</span>
<a name="ln-879"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb2</span>
<a name="ln-880"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-881"></a><span class="k">end type </span><span class="n">ptb2</span>
<a name="ln-882"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb2_1</span><span class="p">,</span> <span class="n">pb2_2</span>
<a name="ln-883"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb3</span>
<a name="ln-884"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-885"></a><span class="k">end type </span><span class="n">ptb3</span>
<a name="ln-886"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb3_1</span><span class="p">,</span> <span class="n">pb3_2</span>
<a name="ln-887"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth0</span>
<a name="ln-888"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-889"></a><span class="k">end type </span><span class="n">pth0</span>
<a name="ln-890"></a><span class="k">type</span><span class="p">(</span><span class="n">pth0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph0_1</span><span class="p">,</span> <span class="n">ph0_2</span>
<a name="ln-891"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth1</span>
<a name="ln-892"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-893"></a><span class="k">end type </span><span class="n">pth1</span>
<a name="ln-894"></a><span class="k">type</span><span class="p">(</span><span class="n">pth1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph1_1</span><span class="p">,</span> <span class="n">ph1_2</span>
<a name="ln-895"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth2</span>
<a name="ln-896"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-897"></a><span class="k">end type </span><span class="n">pth2</span>
<a name="ln-898"></a><span class="k">type</span><span class="p">(</span><span class="n">pth2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph2_1</span><span class="p">,</span> <span class="n">ph2_2</span>
<a name="ln-899"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth3</span>
<a name="ln-900"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-901"></a><span class="k">end type </span><span class="n">pth3</span>
<a name="ln-902"></a><span class="k">type</span><span class="p">(</span><span class="n">pth3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph3_1</span><span class="p">,</span> <span class="n">ph3_2</span>
<a name="ln-903"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti0</span>
<a name="ln-904"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-905"></a><span class="k">end type </span><span class="n">pti0</span>
<a name="ln-906"></a><span class="k">type</span><span class="p">(</span><span class="n">pti0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi0_1</span><span class="p">,</span> <span class="n">pi0_2</span>
<a name="ln-907"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti1</span>
<a name="ln-908"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-909"></a><span class="k">end type </span><span class="n">pti1</span>
<a name="ln-910"></a><span class="k">type</span><span class="p">(</span><span class="n">pti1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi1_1</span><span class="p">,</span> <span class="n">pi1_2</span>
<a name="ln-911"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti2</span>
<a name="ln-912"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-913"></a><span class="k">end type </span><span class="n">pti2</span>
<a name="ln-914"></a><span class="k">type</span><span class="p">(</span><span class="n">pti2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi2_1</span><span class="p">,</span> <span class="n">pi2_2</span>
<a name="ln-915"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti3</span>
<a name="ln-916"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-917"></a><span class="k">end type </span><span class="n">pti3</span>
<a name="ln-918"></a><span class="k">type</span><span class="p">(</span><span class="n">pti3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi3_1</span><span class="p">,</span> <span class="n">pi3_2</span>
<a name="ln-919"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl0</span>
<a name="ln-920"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-921"></a><span class="k">end type </span><span class="n">ptl0</span>
<a name="ln-922"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl0_1</span><span class="p">,</span> <span class="n">pl0_2</span>
<a name="ln-923"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl1</span>
<a name="ln-924"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-925"></a><span class="k">end type </span><span class="n">ptl1</span>
<a name="ln-926"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl1_1</span><span class="p">,</span> <span class="n">pl1_2</span>
<a name="ln-927"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl2</span>
<a name="ln-928"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-929"></a><span class="k">end type </span><span class="n">ptl2</span>
<a name="ln-930"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl2_1</span><span class="p">,</span> <span class="n">pl2_2</span>
<a name="ln-931"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl3</span>
<a name="ln-932"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-933"></a><span class="k">end type </span><span class="n">ptl3</span>
<a name="ln-934"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl3_1</span><span class="p">,</span> <span class="n">pl3_2</span>
<a name="ln-935"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp0</span>
<a name="ln-936"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-937"></a><span class="k">end type </span><span class="n">ptcp0</span>
<a name="ln-938"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp0_1</span><span class="p">,</span> <span class="n">pcp0_2</span>
<a name="ln-939"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp1</span>
<a name="ln-940"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-941"></a><span class="k">end type </span><span class="n">ptcp1</span>
<a name="ln-942"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp1_1</span><span class="p">,</span> <span class="n">pcp1_2</span>
<a name="ln-943"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp0</span>
<a name="ln-944"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-945"></a><span class="k">end type </span><span class="n">ptfp0</span>
<a name="ln-946"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp0_1</span><span class="p">,</span> <span class="n">pfp0_2</span>
<a name="ln-947"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp1</span>
<a name="ln-948"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-949"></a><span class="k">end type </span><span class="n">ptfp1</span>
<a name="ln-950"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp1_1</span><span class="p">,</span> <span class="n">pfp1_2</span>
<a name="ln-951"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta_</span>
<a name="ln-952"></a> <span class="k">type</span><span class="p">(</span><span class="n">pta__</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-953"></a><span class="k">end type </span><span class="n">pta_</span>
<a name="ln-954"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta__</span>
<a name="ln-955"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-956"></a><span class="k">end type </span><span class="n">pta__</span>
<a name="ln-957"></a><span class="k">type</span><span class="p">(</span><span class="n">pta_</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa__1</span><span class="p">,</span> <span class="n">pa__2</span>
<a name="ln-958"></a>    <span class="c">! collect deallocation option (default as =)</span>
<a name="ln-959"></a>    <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-960"></a>    <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-961"></a>    <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-962"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-963"></a>       <span class="c">! if we do not deallocate, nullify</span>
<a name="ln-964"></a>       <span class="k">call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-965"></a>    <span class="k">else</span>
<a name="ln-966"></a><span class="k">       call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-967"></a>    <span class="k">end if</span>
<a name="ln-968"></a><span class="k">    </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">t</span>
<a name="ln-969"></a>    <span class="c">! First allocate the LHS</span>
<a name="ln-970"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-971"></a><span class="n">pa1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pa1_2</span><span class="p">)</span>
<a name="ln-972"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pa1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pa1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-973"></a><span class="n">endif</span>
<a name="ln-974"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-975"></a><span class="n">ps0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps0_2</span><span class="p">)</span>
<a name="ln-976"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ps0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-977"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-978"></a><span class="n">ps1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps1_2</span><span class="p">)</span>
<a name="ln-979"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ps1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ps1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-980"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-981"></a><span class="n">ps2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps2_2</span><span class="p">)</span>
<a name="ln-982"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ps2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ps2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ps2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-983"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-984"></a><span class="n">ps3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps3_2</span><span class="p">)</span>
<a name="ln-985"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ps3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ps3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ps3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ps3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-986"></a><span class="n">endif</span>
<a name="ln-987"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-988"></a><span class="n">pd0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd0_2</span><span class="p">)</span>
<a name="ln-989"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pd0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-990"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-991"></a><span class="n">pd1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd1_2</span><span class="p">)</span>
<a name="ln-992"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pd1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pd1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-993"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-994"></a><span class="n">pd2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd2_2</span><span class="p">)</span>
<a name="ln-995"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pd2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pd2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pd2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-996"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-997"></a><span class="n">pd3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd3_2</span><span class="p">)</span>
<a name="ln-998"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pd3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pd3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pd3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pd3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-999"></a><span class="n">endif</span>
<a name="ln-1000"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1001"></a><span class="n">pc0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc0_2</span><span class="p">)</span>
<a name="ln-1002"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pc0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1003"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1004"></a><span class="n">pc1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc1_2</span><span class="p">)</span>
<a name="ln-1005"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pc1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pc1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1006"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1007"></a><span class="n">pc2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc2_2</span><span class="p">)</span>
<a name="ln-1008"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pc2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pc2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pc2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1009"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1010"></a><span class="n">pc3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc3_2</span><span class="p">)</span>
<a name="ln-1011"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pc3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pc3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pc3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pc3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1012"></a><span class="n">endif</span>
<a name="ln-1013"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1014"></a><span class="n">pz0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz0_2</span><span class="p">)</span>
<a name="ln-1015"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pz0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1016"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1017"></a><span class="n">pz1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz1_2</span><span class="p">)</span>
<a name="ln-1018"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pz1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pz1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1019"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1020"></a><span class="n">pz2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz2_2</span><span class="p">)</span>
<a name="ln-1021"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pz2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pz2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pz2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1022"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1023"></a><span class="n">pz3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz3_2</span><span class="p">)</span>
<a name="ln-1024"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pz3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pz3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pz3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pz3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1025"></a><span class="n">endif</span>
<a name="ln-1026"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1027"></a><span class="n">pb0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb0_2</span><span class="p">)</span>
<a name="ln-1028"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pb0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1029"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1030"></a><span class="n">pb1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb1_2</span><span class="p">)</span>
<a name="ln-1031"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pb1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pb1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1032"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1033"></a><span class="n">pb2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb2_2</span><span class="p">)</span>
<a name="ln-1034"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pb2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pb2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pb2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1035"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1036"></a><span class="n">pb3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb3_2</span><span class="p">)</span>
<a name="ln-1037"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pb3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pb3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pb3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pb3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1038"></a><span class="n">endif</span>
<a name="ln-1039"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1040"></a><span class="n">ph0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph0_2</span><span class="p">)</span>
<a name="ln-1041"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ph0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1042"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1043"></a><span class="n">ph1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph1_2</span><span class="p">)</span>
<a name="ln-1044"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ph1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ph1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1045"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1046"></a><span class="n">ph2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph2_2</span><span class="p">)</span>
<a name="ln-1047"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ph2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ph2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ph2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1048"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1049"></a><span class="n">ph3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph3_2</span><span class="p">)</span>
<a name="ln-1050"></a><span class="k">allocate</span><span class="p">(</span><span class="n">ph3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">ph3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ph3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">ph3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1051"></a><span class="n">endif</span>
<a name="ln-1052"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1053"></a><span class="n">pi0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi0_2</span><span class="p">)</span>
<a name="ln-1054"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pi0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1055"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1056"></a><span class="n">pi1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi1_2</span><span class="p">)</span>
<a name="ln-1057"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pi1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pi1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1058"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1059"></a><span class="n">pi2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi2_2</span><span class="p">)</span>
<a name="ln-1060"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pi2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pi2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pi2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1061"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1062"></a><span class="n">pi3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi3_2</span><span class="p">)</span>
<a name="ln-1063"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pi3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pi3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pi3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pi3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1064"></a><span class="n">endif</span>
<a name="ln-1065"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1066"></a><span class="n">pl0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl0_2</span><span class="p">)</span>
<a name="ln-1067"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pl0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1068"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1069"></a><span class="n">pl1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl1_2</span><span class="p">)</span>
<a name="ln-1070"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pl1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pl1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1071"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1072"></a><span class="n">pl2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl2_2</span><span class="p">)</span>
<a name="ln-1073"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pl2_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pl2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pl2_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1074"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1075"></a><span class="n">pl3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl3_2</span><span class="p">)</span>
<a name="ln-1076"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pl3_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pl3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pl3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">pl3_2</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1077"></a><span class="n">endif</span>
<a name="ln-1078"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1079"></a><span class="n">pcp0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp0_2</span><span class="p">)</span>
<a name="ln-1080"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pcp0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1081"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1082"></a><span class="n">pcp1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp1_2</span><span class="p">)</span>
<a name="ln-1083"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pcp1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pcp1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1084"></a><span class="n">endif</span>
<a name="ln-1085"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1086"></a><span class="n">pfp0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp0_2</span><span class="p">)</span>
<a name="ln-1087"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pfp0_1</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1088"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1089"></a><span class="n">pfp1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp1_2</span><span class="p">)</span>
<a name="ln-1090"></a><span class="k">allocate</span><span class="p">(</span><span class="n">pfp1_1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pfp1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1091"></a><span class="n">endif</span>
<a name="ln-1092"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a-&#39;</span> <span class="p">)</span> <span class="k">then</span> <span class="c">! character(len=*)</span>
<a name="ln-1093"></a>       <span class="n">pa__2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span> <span class="n">pa__2</span><span class="p">)</span>
<a name="ln-1094"></a>       <span class="k">allocate</span><span class="p">(</span><span class="n">pa__1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">pa__2</span><span class="p">%</span><span class="n">p</span><span class="p">)))</span>
<a name="ln-1095"></a>       <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">pa__2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1096"></a>          <span class="k">allocate</span><span class="p">(</span><span class="n">pa__1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1097"></a>          <span class="n">pa__1</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pa__2</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">p</span>
<a name="ln-1098"></a>       <span class="k">end do</span>
<a name="ln-1099"></a><span class="k">       allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pa__1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1100"></a>       <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pa__1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1101"></a>    <span class="k">end if</span>
<a name="ln-1102"></a>    <span class="c">! copy over RHS and Save encoding</span>
<a name="ln-1103"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1104"></a><span class="n">pa1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pa1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1105"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pa1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1106"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pa1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1107"></a><span class="n">endif</span>
<a name="ln-1108"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1109"></a><span class="n">ps0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ps0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1110"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ps0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1111"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ps0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1112"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1113"></a><span class="n">ps1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ps1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1114"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ps1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1115"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ps1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1116"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1117"></a><span class="n">ps2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ps2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1118"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ps2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1119"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ps2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1120"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1121"></a><span class="n">ps3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ps3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1122"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ps3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1123"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ps3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1124"></a><span class="n">endif</span>
<a name="ln-1125"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1126"></a><span class="n">pd0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pd0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1127"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pd0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1128"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pd0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1129"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1130"></a><span class="n">pd1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pd1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1131"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pd1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1132"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pd1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1133"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1134"></a><span class="n">pd2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pd2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1135"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pd2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1136"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pd2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1137"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1138"></a><span class="n">pd3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pd3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1139"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pd3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1140"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pd3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1141"></a><span class="n">endif</span>
<a name="ln-1142"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1143"></a><span class="n">pc0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pc0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1144"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pc0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1145"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pc0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1146"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1147"></a><span class="n">pc1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pc1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1148"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pc1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1149"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pc1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1150"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1151"></a><span class="n">pc2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pc2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1152"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pc2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1153"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pc2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1154"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1155"></a><span class="n">pc3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pc3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1156"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pc3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1157"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pc3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1158"></a><span class="n">endif</span>
<a name="ln-1159"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1160"></a><span class="n">pz0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pz0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1161"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pz0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1162"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pz0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1163"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1164"></a><span class="n">pz1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pz1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1165"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pz1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1166"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pz1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1167"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1168"></a><span class="n">pz2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pz2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1169"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pz2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1170"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pz2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1171"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1172"></a><span class="n">pz3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pz3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1173"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pz3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1174"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pz3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1175"></a><span class="n">endif</span>
<a name="ln-1176"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1177"></a><span class="n">pb0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pb0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1178"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pb0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1179"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pb0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1180"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1181"></a><span class="n">pb1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pb1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1182"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pb1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1183"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pb1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1184"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1185"></a><span class="n">pb2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pb2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1186"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pb2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1187"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pb2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1188"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1189"></a><span class="n">pb3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pb3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1190"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pb3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1191"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pb3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1192"></a><span class="n">endif</span>
<a name="ln-1193"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1194"></a><span class="n">ph0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ph0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1195"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ph0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1196"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ph0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1197"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1198"></a><span class="n">ph1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ph1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1199"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ph1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1200"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ph1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1201"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1202"></a><span class="n">ph2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ph2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1203"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ph2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1204"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ph2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1205"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1206"></a><span class="n">ph3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">ph3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1207"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">ph3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1208"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">ph3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1209"></a><span class="n">endif</span>
<a name="ln-1210"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1211"></a><span class="n">pi0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pi0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1212"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pi0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1213"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pi0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1214"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1215"></a><span class="n">pi1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pi1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1216"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pi1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1217"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pi1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1218"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1219"></a><span class="n">pi2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pi2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1220"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pi2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1221"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pi2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1222"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1223"></a><span class="n">pi3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pi3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1224"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pi3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1225"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pi3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1226"></a><span class="n">endif</span>
<a name="ln-1227"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1228"></a><span class="n">pl0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pl0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1229"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pl0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1230"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pl0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1231"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1232"></a><span class="n">pl1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pl1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1233"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pl1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1234"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pl1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1235"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1236"></a><span class="n">pl2_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pl2_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1237"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pl2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1238"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pl2_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1239"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1240"></a><span class="n">pl3_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pl3_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1241"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pl3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1242"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pl3_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1243"></a><span class="n">endif</span>
<a name="ln-1244"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1245"></a><span class="n">pcp0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pcp0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1246"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pcp0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1247"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pcp0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1248"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1249"></a><span class="n">pcp1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pcp1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1250"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pcp1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1251"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pcp1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1252"></a><span class="n">endif</span>
<a name="ln-1253"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1254"></a><span class="n">pfp0_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pfp0_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1255"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pfp0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1256"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pfp0_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1257"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1258"></a><span class="n">pfp1_1</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">pfp1_2</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1259"></a><span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">pfp1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span>
<a name="ln-1260"></a><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">pfp1_1</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span>
<a name="ln-1261"></a><span class="n">endif</span>
<a name="ln-1262"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;USER&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1263"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;var: Cannot assign a UT, USE call associate(..)&#39;</span>
<a name="ln-1264"></a><span class="k">end if</span>
<a name="ln-1265"></a><span class="k">  end subroutine </span><span class="n">assign_var</span>
<a name="ln-1266"></a>  <span class="k">subroutine </span><span class="n">associate_var</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1267"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1268"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1269"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1270"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1271"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1272"></a>    <span class="c">! collect deallocation option (default as =)</span>
<a name="ln-1273"></a>    <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1274"></a>    <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1275"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">)</span> <span class="n">success</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1276"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">)</span> <span class="p">)</span> <span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1277"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1278"></a>       <span class="c">! if we do not deallocate, nullify</span>
<a name="ln-1279"></a>       <span class="k">call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1280"></a>    <span class="k">else</span>
<a name="ln-1281"></a><span class="k">       call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1282"></a>    <span class="k">end if</span>
<a name="ln-1283"></a>    <span class="c">! Association is done by copying the encoding</span>
<a name="ln-1284"></a>    <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">t</span>
<a name="ln-1285"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">)))</span>
<a name="ln-1286"></a>    <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">%</span><span class="n">enc</span>
<a name="ln-1287"></a>  <span class="k">end subroutine </span><span class="n">associate_var</span>
<a name="ln-1288"></a>  <span class="k">pure function </span><span class="n">associatd_var</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1289"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1290"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1291"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1292"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta1</span>
<a name="ln-1293"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1294"></a><span class="k">end type </span><span class="n">pta1</span>
<a name="ln-1295"></a><span class="k">type</span><span class="p">(</span><span class="n">pta1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa1_1</span><span class="p">,</span> <span class="n">pa1_2</span>
<a name="ln-1296"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts0</span>
<a name="ln-1297"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1298"></a><span class="k">end type </span><span class="n">pts0</span>
<a name="ln-1299"></a><span class="k">type</span><span class="p">(</span><span class="n">pts0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps0_1</span><span class="p">,</span> <span class="n">ps0_2</span>
<a name="ln-1300"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts1</span>
<a name="ln-1301"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1302"></a><span class="k">end type </span><span class="n">pts1</span>
<a name="ln-1303"></a><span class="k">type</span><span class="p">(</span><span class="n">pts1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps1_1</span><span class="p">,</span> <span class="n">ps1_2</span>
<a name="ln-1304"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts2</span>
<a name="ln-1305"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1306"></a><span class="k">end type </span><span class="n">pts2</span>
<a name="ln-1307"></a><span class="k">type</span><span class="p">(</span><span class="n">pts2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps2_1</span><span class="p">,</span> <span class="n">ps2_2</span>
<a name="ln-1308"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pts3</span>
<a name="ln-1309"></a> <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1310"></a><span class="k">end type </span><span class="n">pts3</span>
<a name="ln-1311"></a><span class="k">type</span><span class="p">(</span><span class="n">pts3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ps3_1</span><span class="p">,</span> <span class="n">ps3_2</span>
<a name="ln-1312"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd0</span>
<a name="ln-1313"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1314"></a><span class="k">end type </span><span class="n">ptd0</span>
<a name="ln-1315"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd0_1</span><span class="p">,</span> <span class="n">pd0_2</span>
<a name="ln-1316"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd1</span>
<a name="ln-1317"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1318"></a><span class="k">end type </span><span class="n">ptd1</span>
<a name="ln-1319"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd1_1</span><span class="p">,</span> <span class="n">pd1_2</span>
<a name="ln-1320"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd2</span>
<a name="ln-1321"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1322"></a><span class="k">end type </span><span class="n">ptd2</span>
<a name="ln-1323"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd2_1</span><span class="p">,</span> <span class="n">pd2_2</span>
<a name="ln-1324"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptd3</span>
<a name="ln-1325"></a> <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1326"></a><span class="k">end type </span><span class="n">ptd3</span>
<a name="ln-1327"></a><span class="k">type</span><span class="p">(</span><span class="n">ptd3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pd3_1</span><span class="p">,</span> <span class="n">pd3_2</span>
<a name="ln-1328"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc0</span>
<a name="ln-1329"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1330"></a><span class="k">end type </span><span class="n">ptc0</span>
<a name="ln-1331"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc0_1</span><span class="p">,</span> <span class="n">pc0_2</span>
<a name="ln-1332"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc1</span>
<a name="ln-1333"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1334"></a><span class="k">end type </span><span class="n">ptc1</span>
<a name="ln-1335"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc1_1</span><span class="p">,</span> <span class="n">pc1_2</span>
<a name="ln-1336"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc2</span>
<a name="ln-1337"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1338"></a><span class="k">end type </span><span class="n">ptc2</span>
<a name="ln-1339"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc2_1</span><span class="p">,</span> <span class="n">pc2_2</span>
<a name="ln-1340"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptc3</span>
<a name="ln-1341"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1342"></a><span class="k">end type </span><span class="n">ptc3</span>
<a name="ln-1343"></a><span class="k">type</span><span class="p">(</span><span class="n">ptc3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pc3_1</span><span class="p">,</span> <span class="n">pc3_2</span>
<a name="ln-1344"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz0</span>
<a name="ln-1345"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1346"></a><span class="k">end type </span><span class="n">ptz0</span>
<a name="ln-1347"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz0_1</span><span class="p">,</span> <span class="n">pz0_2</span>
<a name="ln-1348"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz1</span>
<a name="ln-1349"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1350"></a><span class="k">end type </span><span class="n">ptz1</span>
<a name="ln-1351"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz1_1</span><span class="p">,</span> <span class="n">pz1_2</span>
<a name="ln-1352"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz2</span>
<a name="ln-1353"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1354"></a><span class="k">end type </span><span class="n">ptz2</span>
<a name="ln-1355"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz2_1</span><span class="p">,</span> <span class="n">pz2_2</span>
<a name="ln-1356"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptz3</span>
<a name="ln-1357"></a> <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1358"></a><span class="k">end type </span><span class="n">ptz3</span>
<a name="ln-1359"></a><span class="k">type</span><span class="p">(</span><span class="n">ptz3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pz3_1</span><span class="p">,</span> <span class="n">pz3_2</span>
<a name="ln-1360"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb0</span>
<a name="ln-1361"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1362"></a><span class="k">end type </span><span class="n">ptb0</span>
<a name="ln-1363"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb0_1</span><span class="p">,</span> <span class="n">pb0_2</span>
<a name="ln-1364"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb1</span>
<a name="ln-1365"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1366"></a><span class="k">end type </span><span class="n">ptb1</span>
<a name="ln-1367"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb1_1</span><span class="p">,</span> <span class="n">pb1_2</span>
<a name="ln-1368"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb2</span>
<a name="ln-1369"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1370"></a><span class="k">end type </span><span class="n">ptb2</span>
<a name="ln-1371"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb2_1</span><span class="p">,</span> <span class="n">pb2_2</span>
<a name="ln-1372"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptb3</span>
<a name="ln-1373"></a> <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1374"></a><span class="k">end type </span><span class="n">ptb3</span>
<a name="ln-1375"></a><span class="k">type</span><span class="p">(</span><span class="n">ptb3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pb3_1</span><span class="p">,</span> <span class="n">pb3_2</span>
<a name="ln-1376"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth0</span>
<a name="ln-1377"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1378"></a><span class="k">end type </span><span class="n">pth0</span>
<a name="ln-1379"></a><span class="k">type</span><span class="p">(</span><span class="n">pth0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph0_1</span><span class="p">,</span> <span class="n">ph0_2</span>
<a name="ln-1380"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth1</span>
<a name="ln-1381"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1382"></a><span class="k">end type </span><span class="n">pth1</span>
<a name="ln-1383"></a><span class="k">type</span><span class="p">(</span><span class="n">pth1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph1_1</span><span class="p">,</span> <span class="n">ph1_2</span>
<a name="ln-1384"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth2</span>
<a name="ln-1385"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1386"></a><span class="k">end type </span><span class="n">pth2</span>
<a name="ln-1387"></a><span class="k">type</span><span class="p">(</span><span class="n">pth2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph2_1</span><span class="p">,</span> <span class="n">ph2_2</span>
<a name="ln-1388"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pth3</span>
<a name="ln-1389"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1390"></a><span class="k">end type </span><span class="n">pth3</span>
<a name="ln-1391"></a><span class="k">type</span><span class="p">(</span><span class="n">pth3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ph3_1</span><span class="p">,</span> <span class="n">ph3_2</span>
<a name="ln-1392"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti0</span>
<a name="ln-1393"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1394"></a><span class="k">end type </span><span class="n">pti0</span>
<a name="ln-1395"></a><span class="k">type</span><span class="p">(</span><span class="n">pti0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi0_1</span><span class="p">,</span> <span class="n">pi0_2</span>
<a name="ln-1396"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti1</span>
<a name="ln-1397"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1398"></a><span class="k">end type </span><span class="n">pti1</span>
<a name="ln-1399"></a><span class="k">type</span><span class="p">(</span><span class="n">pti1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi1_1</span><span class="p">,</span> <span class="n">pi1_2</span>
<a name="ln-1400"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti2</span>
<a name="ln-1401"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1402"></a><span class="k">end type </span><span class="n">pti2</span>
<a name="ln-1403"></a><span class="k">type</span><span class="p">(</span><span class="n">pti2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi2_1</span><span class="p">,</span> <span class="n">pi2_2</span>
<a name="ln-1404"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pti3</span>
<a name="ln-1405"></a> <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1406"></a><span class="k">end type </span><span class="n">pti3</span>
<a name="ln-1407"></a><span class="k">type</span><span class="p">(</span><span class="n">pti3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pi3_1</span><span class="p">,</span> <span class="n">pi3_2</span>
<a name="ln-1408"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl0</span>
<a name="ln-1409"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1410"></a><span class="k">end type </span><span class="n">ptl0</span>
<a name="ln-1411"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl0_1</span><span class="p">,</span> <span class="n">pl0_2</span>
<a name="ln-1412"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl1</span>
<a name="ln-1413"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1414"></a><span class="k">end type </span><span class="n">ptl1</span>
<a name="ln-1415"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl1_1</span><span class="p">,</span> <span class="n">pl1_2</span>
<a name="ln-1416"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl2</span>
<a name="ln-1417"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1418"></a><span class="k">end type </span><span class="n">ptl2</span>
<a name="ln-1419"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl2_1</span><span class="p">,</span> <span class="n">pl2_2</span>
<a name="ln-1420"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptl3</span>
<a name="ln-1421"></a> <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:,:,:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1422"></a><span class="k">end type </span><span class="n">ptl3</span>
<a name="ln-1423"></a><span class="k">type</span><span class="p">(</span><span class="n">ptl3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pl3_1</span><span class="p">,</span> <span class="n">pl3_2</span>
<a name="ln-1424"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp0</span>
<a name="ln-1425"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1426"></a><span class="k">end type </span><span class="n">ptcp0</span>
<a name="ln-1427"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp0_1</span><span class="p">,</span> <span class="n">pcp0_2</span>
<a name="ln-1428"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptcp1</span>
<a name="ln-1429"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1430"></a><span class="k">end type </span><span class="n">ptcp1</span>
<a name="ln-1431"></a><span class="k">type</span><span class="p">(</span><span class="n">ptcp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pcp1_1</span><span class="p">,</span> <span class="n">pcp1_2</span>
<a name="ln-1432"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp0</span>
<a name="ln-1433"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1434"></a><span class="k">end type </span><span class="n">ptfp0</span>
<a name="ln-1435"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp0</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp0_1</span><span class="p">,</span> <span class="n">pfp0_2</span>
<a name="ln-1436"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">ptfp1</span>
<a name="ln-1437"></a> <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1438"></a><span class="k">end type </span><span class="n">ptfp1</span>
<a name="ln-1439"></a><span class="k">type</span><span class="p">(</span><span class="n">ptfp1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pfp1_1</span><span class="p">,</span> <span class="n">pfp1_2</span>
<a name="ln-1440"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta_</span>
<a name="ln-1441"></a> <span class="k">type</span><span class="p">(</span><span class="n">pta__</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1442"></a><span class="k">end type </span><span class="n">pta_</span>
<a name="ln-1443"></a><span class="k">type</span> <span class="kd">::</span> <span class="n">pta__</span>
<a name="ln-1444"></a> <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1445"></a><span class="k">end type </span><span class="n">pta__</span>
<a name="ln-1446"></a><span class="k">type</span><span class="p">(</span><span class="n">pta_</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pa__1</span><span class="p">,</span> <span class="n">pa__2</span>
<a name="ln-1447"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span><span class="o">==</span><span class="n">rhs</span><span class="p">%</span><span class="n">t</span>
<a name="ln-1448"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ret</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1449"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;a1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1450"></a><span class="n">pa1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pa1_1</span><span class="p">)</span>
<a name="ln-1451"></a><span class="n">pa1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pa1_2</span><span class="p">)</span>
<a name="ln-1452"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pa1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pa1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1453"></a><span class="n">endif</span>
<a name="ln-1454"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1455"></a><span class="n">ps0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps0_1</span><span class="p">)</span>
<a name="ln-1456"></a><span class="n">ps0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps0_2</span><span class="p">)</span>
<a name="ln-1457"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ps0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ps0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1458"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1459"></a><span class="n">ps1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps1_1</span><span class="p">)</span>
<a name="ln-1460"></a><span class="n">ps1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps1_2</span><span class="p">)</span>
<a name="ln-1461"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ps1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ps1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1462"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1463"></a><span class="n">ps2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps2_1</span><span class="p">)</span>
<a name="ln-1464"></a><span class="n">ps2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps2_2</span><span class="p">)</span>
<a name="ln-1465"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ps2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ps2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1466"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1467"></a><span class="n">ps3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps3_1</span><span class="p">)</span>
<a name="ln-1468"></a><span class="n">ps3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ps3_2</span><span class="p">)</span>
<a name="ln-1469"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ps3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ps3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1470"></a><span class="n">endif</span>
<a name="ln-1471"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1472"></a><span class="n">pd0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd0_1</span><span class="p">)</span>
<a name="ln-1473"></a><span class="n">pd0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd0_2</span><span class="p">)</span>
<a name="ln-1474"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pd0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pd0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1475"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1476"></a><span class="n">pd1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd1_1</span><span class="p">)</span>
<a name="ln-1477"></a><span class="n">pd1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd1_2</span><span class="p">)</span>
<a name="ln-1478"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pd1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pd1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1479"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1480"></a><span class="n">pd2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd2_1</span><span class="p">)</span>
<a name="ln-1481"></a><span class="n">pd2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd2_2</span><span class="p">)</span>
<a name="ln-1482"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pd2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pd2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1483"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;d3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1484"></a><span class="n">pd3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd3_1</span><span class="p">)</span>
<a name="ln-1485"></a><span class="n">pd3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pd3_2</span><span class="p">)</span>
<a name="ln-1486"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pd3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pd3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1487"></a><span class="n">endif</span>
<a name="ln-1488"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1489"></a><span class="n">pc0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc0_1</span><span class="p">)</span>
<a name="ln-1490"></a><span class="n">pc0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc0_2</span><span class="p">)</span>
<a name="ln-1491"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pc0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pc0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1492"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1493"></a><span class="n">pc1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc1_1</span><span class="p">)</span>
<a name="ln-1494"></a><span class="n">pc1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc1_2</span><span class="p">)</span>
<a name="ln-1495"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pc1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pc1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1496"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1497"></a><span class="n">pc2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc2_1</span><span class="p">)</span>
<a name="ln-1498"></a><span class="n">pc2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc2_2</span><span class="p">)</span>
<a name="ln-1499"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pc2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pc2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1500"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;c3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1501"></a><span class="n">pc3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc3_1</span><span class="p">)</span>
<a name="ln-1502"></a><span class="n">pc3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pc3_2</span><span class="p">)</span>
<a name="ln-1503"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pc3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pc3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1504"></a><span class="n">endif</span>
<a name="ln-1505"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1506"></a><span class="n">pz0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz0_1</span><span class="p">)</span>
<a name="ln-1507"></a><span class="n">pz0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz0_2</span><span class="p">)</span>
<a name="ln-1508"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pz0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pz0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1509"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1510"></a><span class="n">pz1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz1_1</span><span class="p">)</span>
<a name="ln-1511"></a><span class="n">pz1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz1_2</span><span class="p">)</span>
<a name="ln-1512"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pz1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pz1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1513"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1514"></a><span class="n">pz2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz2_1</span><span class="p">)</span>
<a name="ln-1515"></a><span class="n">pz2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz2_2</span><span class="p">)</span>
<a name="ln-1516"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pz2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pz2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1517"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;z3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1518"></a><span class="n">pz3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz3_1</span><span class="p">)</span>
<a name="ln-1519"></a><span class="n">pz3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pz3_2</span><span class="p">)</span>
<a name="ln-1520"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pz3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pz3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1521"></a><span class="n">endif</span>
<a name="ln-1522"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1523"></a><span class="n">pb0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb0_1</span><span class="p">)</span>
<a name="ln-1524"></a><span class="n">pb0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb0_2</span><span class="p">)</span>
<a name="ln-1525"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pb0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pb0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1526"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1527"></a><span class="n">pb1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb1_1</span><span class="p">)</span>
<a name="ln-1528"></a><span class="n">pb1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb1_2</span><span class="p">)</span>
<a name="ln-1529"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pb1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pb1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1530"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1531"></a><span class="n">pb2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb2_1</span><span class="p">)</span>
<a name="ln-1532"></a><span class="n">pb2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb2_2</span><span class="p">)</span>
<a name="ln-1533"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pb2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pb2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1534"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;b3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1535"></a><span class="n">pb3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb3_1</span><span class="p">)</span>
<a name="ln-1536"></a><span class="n">pb3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pb3_2</span><span class="p">)</span>
<a name="ln-1537"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pb3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pb3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1538"></a><span class="n">endif</span>
<a name="ln-1539"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1540"></a><span class="n">ph0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph0_1</span><span class="p">)</span>
<a name="ln-1541"></a><span class="n">ph0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph0_2</span><span class="p">)</span>
<a name="ln-1542"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ph0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ph0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1543"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1544"></a><span class="n">ph1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph1_1</span><span class="p">)</span>
<a name="ln-1545"></a><span class="n">ph1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph1_2</span><span class="p">)</span>
<a name="ln-1546"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ph1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ph1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1547"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1548"></a><span class="n">ph2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph2_1</span><span class="p">)</span>
<a name="ln-1549"></a><span class="n">ph2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph2_2</span><span class="p">)</span>
<a name="ln-1550"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ph2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ph2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1551"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;h3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1552"></a><span class="n">ph3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph3_1</span><span class="p">)</span>
<a name="ln-1553"></a><span class="n">ph3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">ph3_2</span><span class="p">)</span>
<a name="ln-1554"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">ph3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ph3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1555"></a><span class="n">endif</span>
<a name="ln-1556"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1557"></a><span class="n">pi0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi0_1</span><span class="p">)</span>
<a name="ln-1558"></a><span class="n">pi0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi0_2</span><span class="p">)</span>
<a name="ln-1559"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pi0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pi0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1560"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1561"></a><span class="n">pi1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi1_1</span><span class="p">)</span>
<a name="ln-1562"></a><span class="n">pi1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi1_2</span><span class="p">)</span>
<a name="ln-1563"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pi1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pi1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1564"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1565"></a><span class="n">pi2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi2_1</span><span class="p">)</span>
<a name="ln-1566"></a><span class="n">pi2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi2_2</span><span class="p">)</span>
<a name="ln-1567"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pi2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pi2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1568"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;i3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1569"></a><span class="n">pi3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi3_1</span><span class="p">)</span>
<a name="ln-1570"></a><span class="n">pi3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pi3_2</span><span class="p">)</span>
<a name="ln-1571"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pi3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pi3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1572"></a><span class="n">endif</span>
<a name="ln-1573"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1574"></a><span class="n">pl0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl0_1</span><span class="p">)</span>
<a name="ln-1575"></a><span class="n">pl0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl0_2</span><span class="p">)</span>
<a name="ln-1576"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pl0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pl0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1577"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1578"></a><span class="n">pl1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl1_1</span><span class="p">)</span>
<a name="ln-1579"></a><span class="n">pl1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl1_2</span><span class="p">)</span>
<a name="ln-1580"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pl1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pl1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1581"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l2&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1582"></a><span class="n">pl2_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl2_1</span><span class="p">)</span>
<a name="ln-1583"></a><span class="n">pl2_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl2_2</span><span class="p">)</span>
<a name="ln-1584"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pl2_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pl2_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1585"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;l3&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1586"></a><span class="n">pl3_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl3_1</span><span class="p">)</span>
<a name="ln-1587"></a><span class="n">pl3_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pl3_2</span><span class="p">)</span>
<a name="ln-1588"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pl3_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pl3_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1589"></a><span class="n">endif</span>
<a name="ln-1590"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1591"></a><span class="n">pcp0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp0_1</span><span class="p">)</span>
<a name="ln-1592"></a><span class="n">pcp0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp0_2</span><span class="p">)</span>
<a name="ln-1593"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pcp0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pcp0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1594"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;cp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1595"></a><span class="n">pcp1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp1_1</span><span class="p">)</span>
<a name="ln-1596"></a><span class="n">pcp1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pcp1_2</span><span class="p">)</span>
<a name="ln-1597"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pcp1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pcp1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1598"></a><span class="n">endif</span>
<a name="ln-1599"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp0&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1600"></a><span class="n">pfp0_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp0_1</span><span class="p">)</span>
<a name="ln-1601"></a><span class="n">pfp0_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp0_2</span><span class="p">)</span>
<a name="ln-1602"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pfp0_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pfp0_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1603"></a><span class="n">elseif</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;fp1&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1604"></a><span class="n">pfp1_1</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp1_1</span><span class="p">)</span>
<a name="ln-1605"></a><span class="n">pfp1_2</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">pfp1_2</span><span class="p">)</span>
<a name="ln-1606"></a><span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">pfp1_1</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">pfp1_2</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1607"></a><span class="n">endif</span>
<a name="ln-1608"></a><span class="k">if</span> <span class="p">(</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s1">&#39;USER&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1609"></a><span class="n">ret</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">%</span><span class="n">enc</span><span class="p">)</span>
<a name="ln-1610"></a><span class="k">end if</span>
<a name="ln-1611"></a><span class="k">  end function </span><span class="n">associatd_var</span>
<a name="ln-1612"></a>  <span class="c">! The character(len=*) is a bit difficult because</span>
<a name="ln-1613"></a>  <span class="c">! there is no way to generate a specific type for _all_</span>
<a name="ln-1614"></a>  <span class="c">! len=1,2,3,...</span>
<a name="ln-1615"></a>  <span class="c">! variables.</span>
<a name="ln-1616"></a>  <span class="c">! Instead we convert the character to char(len=1)</span>
<a name="ln-1617"></a>  <span class="c">! and store a pointer to this.</span>
<a name="ln-1618"></a>  <span class="c">! This ensures that it can be retrieved (via associate)</span>
<a name="ln-1619"></a>  <span class="c">! and mangled through another variable type</span>
<a name="ln-1620"></a>  <span class="k">subroutine </span><span class="n">assign_set_a0_0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1621"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1622"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1623"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1624"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1625"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1626"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span>
<a name="ln-1627"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1628"></a>       <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1629"></a>    <span class="k">end do</span>
<a name="ln-1630"></a>    <span class="c">! This is still a &quot;copy&quot;</span>
<a name="ln-1631"></a>    <span class="k">call associate</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1632"></a>    <span class="k">nullify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1633"></a>  <span class="k">end subroutine </span><span class="n">assign_set_a0_0</span>
<a name="ln-1634"></a>  <span class="k">subroutine </span><span class="n">assign_get_a0_0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1635"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1636"></a>    <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1637"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1638"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">c</span><span class="p">(:)</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1639"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-1640"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1641"></a>    <span class="k">call associate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">this</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="n">lsuccess</span><span class="p">)</span>
<a name="ln-1642"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="n">lsuccess</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">size</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1643"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="p">)</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1644"></a>    <span class="n">lhs</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1645"></a>    <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1646"></a><span class="k">    do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">size</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-1647"></a>       <span class="n">lhs</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1648"></a>    <span class="k">end do</span>
<a name="ln-1649"></a><span class="k">  end subroutine </span><span class="n">assign_get_a0_0</span>
<a name="ln-1650"></a><span class="k">subroutine </span><span class="n">assign_set_a1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1651"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1652"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1653"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1654"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1655"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1656"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1657"></a>  <span class="k">end type</span>
<a name="ln-1658"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1659"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-1660"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1661"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1662"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1663"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1664"></a>  <span class="k">else</span>
<a name="ln-1665"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1666"></a>  <span class="k">end if</span>
<a name="ln-1667"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-1668"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-1669"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1670"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-1671"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-1672"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1673"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1674"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-1675"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1676"></a><span class="k">end subroutine </span><span class="n">assign_set_a1</span>
<a name="ln-1677"></a><span class="k">subroutine </span><span class="n">assign_get_a1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1678"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1679"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1680"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1681"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-1682"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1683"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1684"></a>  <span class="k">end type</span>
<a name="ln-1685"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1686"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1687"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1688"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1689"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-1690"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-1691"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-1692"></a>  <span class="k">end if</span>
<a name="ln-1693"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1694"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-1695"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1696"></a><span class="k">end subroutine </span><span class="n">assign_get_a1</span>
<a name="ln-1697"></a><span class="k">subroutine </span><span class="n">associate_get_a1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1698"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1699"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1700"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1701"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1702"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-1703"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1704"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1705"></a>  <span class="k">end type</span>
<a name="ln-1706"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1707"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1708"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1709"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1710"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1711"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1712"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-1713"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1714"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1715"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1716"></a>  <span class="k">end if</span>
<a name="ln-1717"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1718"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1719"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1720"></a><span class="k">end subroutine </span><span class="n">associate_get_a1</span>
<a name="ln-1721"></a><span class="k">subroutine </span><span class="n">associate_set_a1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1722"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1723"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1724"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1725"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1726"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1727"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1728"></a>  <span class="k">end type</span>
<a name="ln-1729"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1730"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1731"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1732"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1733"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1734"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1735"></a>  <span class="k">else</span>
<a name="ln-1736"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1737"></a>  <span class="k">end if</span>
<a name="ln-1738"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1739"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-1740"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1741"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1742"></a><span class="k">end subroutine </span><span class="n">associate_set_a1</span>
<a name="ln-1743"></a><span class="k">pure function </span><span class="n">associatd_l_a1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1744"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1745"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1746"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1747"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1748"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1749"></a>  <span class="k">end type</span>
<a name="ln-1750"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1751"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1752"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1753"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1754"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1755"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1756"></a>  <span class="n">endif</span>
<a name="ln-1757"></a><span class="k">end function </span><span class="n">associatd_l_a1</span>
<a name="ln-1758"></a><span class="k">pure function </span><span class="n">associatd_r_a1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1759"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1760"></a>  <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1761"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1762"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1763"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1764"></a>  <span class="k">end type</span>
<a name="ln-1765"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1766"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;a1&quot;</span>
<a name="ln-1767"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1768"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1769"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1770"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-1771"></a>  <span class="n">endif</span>
<a name="ln-1772"></a><span class="k">end function </span><span class="n">associatd_r_a1</span>
<a name="ln-1773"></a><span class="c">! All boolean functions</span>
<a name="ln-1774"></a><span class="k">subroutine </span><span class="n">assign_set_s0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1775"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1776"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1777"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1778"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1779"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1780"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1781"></a>  <span class="k">end type</span>
<a name="ln-1782"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1783"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-1784"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1785"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1786"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1787"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1788"></a>  <span class="k">else</span>
<a name="ln-1789"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1790"></a>  <span class="k">end if</span>
<a name="ln-1791"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-1792"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-1793"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1794"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-1795"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-1796"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1797"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1798"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-1799"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1800"></a><span class="k">end subroutine </span><span class="n">assign_set_s0</span>
<a name="ln-1801"></a><span class="k">subroutine </span><span class="n">assign_get_s0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1802"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1803"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1804"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1805"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-1806"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1807"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1808"></a>  <span class="k">end type</span>
<a name="ln-1809"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1810"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1811"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1812"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-1813"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1814"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1815"></a><span class="k">end subroutine </span><span class="n">assign_get_s0</span>
<a name="ln-1816"></a><span class="k">subroutine </span><span class="n">associate_get_s0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1817"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1818"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1819"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1820"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1821"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-1822"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1823"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1824"></a>  <span class="k">end type</span>
<a name="ln-1825"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1826"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1827"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1828"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1829"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1830"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1831"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-1832"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1833"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1834"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1835"></a>  <span class="k">end if</span>
<a name="ln-1836"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1837"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1838"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1839"></a><span class="k">end subroutine </span><span class="n">associate_get_s0</span>
<a name="ln-1840"></a><span class="k">subroutine </span><span class="n">associate_set_s0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1841"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1842"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1843"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1844"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1845"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1846"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1847"></a>  <span class="k">end type</span>
<a name="ln-1848"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1849"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1850"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1851"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1852"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1853"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1854"></a>  <span class="k">else</span>
<a name="ln-1855"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1856"></a>  <span class="k">end if</span>
<a name="ln-1857"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1858"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-1859"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1860"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1861"></a><span class="k">end subroutine </span><span class="n">associate_set_s0</span>
<a name="ln-1862"></a><span class="k">pure function </span><span class="n">associatd_l_s0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1863"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1864"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1865"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1866"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1867"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1868"></a>  <span class="k">end type</span>
<a name="ln-1869"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1870"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1871"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1872"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1873"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1874"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1875"></a>  <span class="n">endif</span>
<a name="ln-1876"></a><span class="k">end function </span><span class="n">associatd_l_s0</span>
<a name="ln-1877"></a><span class="k">pure function </span><span class="n">associatd_r_s0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1878"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1879"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1880"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1881"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1882"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1883"></a>  <span class="k">end type</span>
<a name="ln-1884"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1885"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s0&quot;</span>
<a name="ln-1886"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1887"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1888"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1889"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-1890"></a>  <span class="n">endif</span>
<a name="ln-1891"></a><span class="k">end function </span><span class="n">associatd_r_s0</span>
<a name="ln-1892"></a><span class="c">! All boolean functions</span>
<a name="ln-1893"></a><span class="k">subroutine </span><span class="n">assign_set_s1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1894"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1895"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1896"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1897"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1898"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1899"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1900"></a>  <span class="k">end type</span>
<a name="ln-1901"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1902"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-1903"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1904"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1905"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1906"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1907"></a>  <span class="k">else</span>
<a name="ln-1908"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1909"></a>  <span class="k">end if</span>
<a name="ln-1910"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-1911"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-1912"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-1913"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-1914"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-1915"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1916"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1917"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-1918"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1919"></a><span class="k">end subroutine </span><span class="n">assign_set_s1</span>
<a name="ln-1920"></a><span class="k">subroutine </span><span class="n">assign_get_s1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1921"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1922"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1923"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1924"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-1925"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1926"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1927"></a>  <span class="k">end type</span>
<a name="ln-1928"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1929"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-1930"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1931"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1932"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-1933"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-1934"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-1935"></a>  <span class="k">end if</span>
<a name="ln-1936"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1937"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-1938"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1939"></a><span class="k">end subroutine </span><span class="n">assign_get_s1</span>
<a name="ln-1940"></a><span class="k">subroutine </span><span class="n">associate_get_s1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-1941"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1942"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1943"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1944"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-1945"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-1946"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1947"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1948"></a>  <span class="k">end type</span>
<a name="ln-1949"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1950"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-1951"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-1952"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1953"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1954"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1955"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-1956"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1957"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1958"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-1959"></a>  <span class="k">end if</span>
<a name="ln-1960"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1961"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-1962"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1963"></a><span class="k">end subroutine </span><span class="n">associate_get_s1</span>
<a name="ln-1964"></a><span class="k">subroutine </span><span class="n">associate_set_s1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-1965"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1966"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-1967"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-1968"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-1969"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1970"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-1971"></a>  <span class="k">end type</span>
<a name="ln-1972"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1973"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-1974"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1975"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-1976"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1977"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1978"></a>  <span class="k">else</span>
<a name="ln-1979"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-1980"></a>  <span class="k">end if</span>
<a name="ln-1981"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-1982"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-1983"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-1984"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-1985"></a><span class="k">end subroutine </span><span class="n">associate_set_s1</span>
<a name="ln-1986"></a><span class="k">pure function </span><span class="n">associatd_l_s1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-1987"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-1988"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-1989"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-1990"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-1991"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1992"></a>  <span class="k">end type</span>
<a name="ln-1993"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-1994"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-1995"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-1996"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1997"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1998"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1999"></a>  <span class="n">endif</span>
<a name="ln-2000"></a><span class="k">end function </span><span class="n">associatd_l_s1</span>
<a name="ln-2001"></a><span class="k">pure function </span><span class="n">associatd_r_s1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2002"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2003"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2004"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2005"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2006"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2007"></a>  <span class="k">end type</span>
<a name="ln-2008"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2009"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s1&quot;</span>
<a name="ln-2010"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2011"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2012"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2013"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2014"></a>  <span class="n">endif</span>
<a name="ln-2015"></a><span class="k">end function </span><span class="n">associatd_r_s1</span>
<a name="ln-2016"></a><span class="c">! All boolean functions</span>
<a name="ln-2017"></a><span class="k">subroutine </span><span class="n">assign_set_s2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2018"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2019"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2020"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2021"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2022"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2023"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2024"></a>  <span class="k">end type</span>
<a name="ln-2025"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2026"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2027"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2028"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2029"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2030"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2031"></a>  <span class="k">else</span>
<a name="ln-2032"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2033"></a>  <span class="k">end if</span>
<a name="ln-2034"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2035"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2036"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2037"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2038"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2039"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2040"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2041"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2042"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2043"></a><span class="k">end subroutine </span><span class="n">assign_set_s2</span>
<a name="ln-2044"></a><span class="k">subroutine </span><span class="n">assign_get_s2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2045"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2046"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2047"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2048"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2049"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2050"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2051"></a>  <span class="k">end type</span>
<a name="ln-2052"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2053"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2054"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2055"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2056"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2057"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2058"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2059"></a>  <span class="k">end if</span>
<a name="ln-2060"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2061"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2062"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2063"></a><span class="k">end subroutine </span><span class="n">assign_get_s2</span>
<a name="ln-2064"></a><span class="k">subroutine </span><span class="n">associate_get_s2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2065"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2066"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2067"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2068"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2069"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2070"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2071"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2072"></a>  <span class="k">end type</span>
<a name="ln-2073"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2074"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2075"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2076"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2077"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2078"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2079"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2080"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2081"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2082"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2083"></a>  <span class="k">end if</span>
<a name="ln-2084"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2085"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2086"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2087"></a><span class="k">end subroutine </span><span class="n">associate_get_s2</span>
<a name="ln-2088"></a><span class="k">subroutine </span><span class="n">associate_set_s2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2089"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2090"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2091"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2092"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2093"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2094"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2095"></a>  <span class="k">end type</span>
<a name="ln-2096"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2097"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2098"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2099"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2100"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2101"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2102"></a>  <span class="k">else</span>
<a name="ln-2103"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2104"></a>  <span class="k">end if</span>
<a name="ln-2105"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2106"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2107"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2108"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2109"></a><span class="k">end subroutine </span><span class="n">associate_set_s2</span>
<a name="ln-2110"></a><span class="k">pure function </span><span class="n">associatd_l_s2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2111"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2112"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2113"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2114"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2115"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2116"></a>  <span class="k">end type</span>
<a name="ln-2117"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2118"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2119"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2120"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2121"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2122"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2123"></a>  <span class="n">endif</span>
<a name="ln-2124"></a><span class="k">end function </span><span class="n">associatd_l_s2</span>
<a name="ln-2125"></a><span class="k">pure function </span><span class="n">associatd_r_s2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2126"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2127"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2128"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2129"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2130"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2131"></a>  <span class="k">end type</span>
<a name="ln-2132"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2133"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s2&quot;</span>
<a name="ln-2134"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2135"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2136"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2137"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2138"></a>  <span class="n">endif</span>
<a name="ln-2139"></a><span class="k">end function </span><span class="n">associatd_r_s2</span>
<a name="ln-2140"></a><span class="c">! All boolean functions</span>
<a name="ln-2141"></a><span class="k">subroutine </span><span class="n">assign_set_s3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2142"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2143"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2144"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2145"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2146"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2147"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2148"></a>  <span class="k">end type</span>
<a name="ln-2149"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2150"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2151"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2152"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2153"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2154"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2155"></a>  <span class="k">else</span>
<a name="ln-2156"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2157"></a>  <span class="k">end if</span>
<a name="ln-2158"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2159"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2160"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2161"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2162"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2163"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2164"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2165"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2166"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2167"></a><span class="k">end subroutine </span><span class="n">assign_set_s3</span>
<a name="ln-2168"></a><span class="k">subroutine </span><span class="n">assign_get_s3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2169"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2170"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2171"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2172"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2173"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2174"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2175"></a>  <span class="k">end type</span>
<a name="ln-2176"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2177"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2178"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2179"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2180"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2181"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2182"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2183"></a>  <span class="k">end if</span>
<a name="ln-2184"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2185"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2186"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2187"></a><span class="k">end subroutine </span><span class="n">assign_get_s3</span>
<a name="ln-2188"></a><span class="k">subroutine </span><span class="n">associate_get_s3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2189"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2190"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2191"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2192"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2193"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2194"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2195"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2196"></a>  <span class="k">end type</span>
<a name="ln-2197"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2198"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2199"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2200"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2201"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2202"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2203"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2204"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2205"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2206"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2207"></a>  <span class="k">end if</span>
<a name="ln-2208"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2209"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2210"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2211"></a><span class="k">end subroutine </span><span class="n">associate_get_s3</span>
<a name="ln-2212"></a><span class="k">subroutine </span><span class="n">associate_set_s3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2213"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2214"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2215"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2216"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2217"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2218"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2219"></a>  <span class="k">end type</span>
<a name="ln-2220"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2221"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2222"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2223"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2224"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2225"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2226"></a>  <span class="k">else</span>
<a name="ln-2227"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2228"></a>  <span class="k">end if</span>
<a name="ln-2229"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2230"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2231"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2232"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2233"></a><span class="k">end subroutine </span><span class="n">associate_set_s3</span>
<a name="ln-2234"></a><span class="k">pure function </span><span class="n">associatd_l_s3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2235"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2236"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2237"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2238"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2239"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2240"></a>  <span class="k">end type</span>
<a name="ln-2241"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2242"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2243"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2244"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2245"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2246"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2247"></a>  <span class="n">endif</span>
<a name="ln-2248"></a><span class="k">end function </span><span class="n">associatd_l_s3</span>
<a name="ln-2249"></a><span class="k">pure function </span><span class="n">associatd_r_s3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2250"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2251"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2252"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2253"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2254"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2255"></a>  <span class="k">end type</span>
<a name="ln-2256"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2257"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;s3&quot;</span>
<a name="ln-2258"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2259"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2260"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2261"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2262"></a>  <span class="n">endif</span>
<a name="ln-2263"></a><span class="k">end function </span><span class="n">associatd_r_s3</span>
<a name="ln-2264"></a><span class="c">! All boolean functions</span>
<a name="ln-2265"></a><span class="k">subroutine </span><span class="n">assign_set_d0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2266"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2267"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2268"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2269"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2270"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2271"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2272"></a>  <span class="k">end type</span>
<a name="ln-2273"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2274"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2275"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2276"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2277"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2278"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2279"></a>  <span class="k">else</span>
<a name="ln-2280"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2281"></a>  <span class="k">end if</span>
<a name="ln-2282"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2283"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2284"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2285"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-2286"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2287"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2288"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2289"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2290"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2291"></a><span class="k">end subroutine </span><span class="n">assign_set_d0</span>
<a name="ln-2292"></a><span class="k">subroutine </span><span class="n">assign_get_d0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2293"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2294"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2295"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2296"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2297"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2298"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2299"></a>  <span class="k">end type</span>
<a name="ln-2300"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2301"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2302"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2303"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2304"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2305"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2306"></a><span class="k">end subroutine </span><span class="n">assign_get_d0</span>
<a name="ln-2307"></a><span class="k">subroutine </span><span class="n">associate_get_d0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2308"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2309"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2310"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2311"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2312"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2313"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2314"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2315"></a>  <span class="k">end type</span>
<a name="ln-2316"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2317"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2318"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2319"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2320"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2321"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2322"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2323"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2324"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2325"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2326"></a>  <span class="k">end if</span>
<a name="ln-2327"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2328"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2329"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2330"></a><span class="k">end subroutine </span><span class="n">associate_get_d0</span>
<a name="ln-2331"></a><span class="k">subroutine </span><span class="n">associate_set_d0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2332"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2333"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2334"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2335"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2336"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2337"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2338"></a>  <span class="k">end type</span>
<a name="ln-2339"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2340"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2341"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2342"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2343"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2344"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2345"></a>  <span class="k">else</span>
<a name="ln-2346"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2347"></a>  <span class="k">end if</span>
<a name="ln-2348"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2349"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2350"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2351"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2352"></a><span class="k">end subroutine </span><span class="n">associate_set_d0</span>
<a name="ln-2353"></a><span class="k">pure function </span><span class="n">associatd_l_d0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2354"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2355"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2356"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2357"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2358"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2359"></a>  <span class="k">end type</span>
<a name="ln-2360"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2361"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2362"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2363"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2364"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2365"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2366"></a>  <span class="n">endif</span>
<a name="ln-2367"></a><span class="k">end function </span><span class="n">associatd_l_d0</span>
<a name="ln-2368"></a><span class="k">pure function </span><span class="n">associatd_r_d0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2369"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2370"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2371"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2372"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2373"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2374"></a>  <span class="k">end type</span>
<a name="ln-2375"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2376"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d0&quot;</span>
<a name="ln-2377"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2378"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2379"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2380"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2381"></a>  <span class="n">endif</span>
<a name="ln-2382"></a><span class="k">end function </span><span class="n">associatd_r_d0</span>
<a name="ln-2383"></a><span class="c">! All boolean functions</span>
<a name="ln-2384"></a><span class="k">subroutine </span><span class="n">assign_set_d1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2385"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2386"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2387"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2388"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2389"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2390"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2391"></a>  <span class="k">end type</span>
<a name="ln-2392"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2393"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2394"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2395"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2396"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2397"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2398"></a>  <span class="k">else</span>
<a name="ln-2399"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2400"></a>  <span class="k">end if</span>
<a name="ln-2401"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2402"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2403"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2404"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2405"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2406"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2407"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2408"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2409"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2410"></a><span class="k">end subroutine </span><span class="n">assign_set_d1</span>
<a name="ln-2411"></a><span class="k">subroutine </span><span class="n">assign_get_d1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2412"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2413"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2414"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2415"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2416"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2417"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2418"></a>  <span class="k">end type</span>
<a name="ln-2419"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2420"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2421"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2422"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2423"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2424"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2425"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2426"></a>  <span class="k">end if</span>
<a name="ln-2427"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2428"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2429"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2430"></a><span class="k">end subroutine </span><span class="n">assign_get_d1</span>
<a name="ln-2431"></a><span class="k">subroutine </span><span class="n">associate_get_d1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2432"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2433"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2434"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2435"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2436"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2437"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2438"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2439"></a>  <span class="k">end type</span>
<a name="ln-2440"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2441"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2442"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2443"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2444"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2445"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2446"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2447"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2448"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2449"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2450"></a>  <span class="k">end if</span>
<a name="ln-2451"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2452"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2453"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2454"></a><span class="k">end subroutine </span><span class="n">associate_get_d1</span>
<a name="ln-2455"></a><span class="k">subroutine </span><span class="n">associate_set_d1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2456"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2457"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2458"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2459"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2460"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2461"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2462"></a>  <span class="k">end type</span>
<a name="ln-2463"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2464"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2465"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2466"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2467"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2468"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2469"></a>  <span class="k">else</span>
<a name="ln-2470"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2471"></a>  <span class="k">end if</span>
<a name="ln-2472"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2473"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2474"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2475"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2476"></a><span class="k">end subroutine </span><span class="n">associate_set_d1</span>
<a name="ln-2477"></a><span class="k">pure function </span><span class="n">associatd_l_d1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2478"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2479"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2480"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2481"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2482"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2483"></a>  <span class="k">end type</span>
<a name="ln-2484"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2485"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2486"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2487"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2488"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2489"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2490"></a>  <span class="n">endif</span>
<a name="ln-2491"></a><span class="k">end function </span><span class="n">associatd_l_d1</span>
<a name="ln-2492"></a><span class="k">pure function </span><span class="n">associatd_r_d1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2493"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2494"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2495"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2496"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2497"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2498"></a>  <span class="k">end type</span>
<a name="ln-2499"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2500"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d1&quot;</span>
<a name="ln-2501"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2502"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2503"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2504"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2505"></a>  <span class="n">endif</span>
<a name="ln-2506"></a><span class="k">end function </span><span class="n">associatd_r_d1</span>
<a name="ln-2507"></a><span class="c">! All boolean functions</span>
<a name="ln-2508"></a><span class="k">subroutine </span><span class="n">assign_set_d2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2509"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2510"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2511"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2512"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2513"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2514"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2515"></a>  <span class="k">end type</span>
<a name="ln-2516"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2517"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2518"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2519"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2520"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2521"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2522"></a>  <span class="k">else</span>
<a name="ln-2523"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2524"></a>  <span class="k">end if</span>
<a name="ln-2525"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2526"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2527"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2528"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2529"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2530"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2531"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2532"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2533"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2534"></a><span class="k">end subroutine </span><span class="n">assign_set_d2</span>
<a name="ln-2535"></a><span class="k">subroutine </span><span class="n">assign_get_d2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2536"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2537"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2538"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2539"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2540"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2541"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2542"></a>  <span class="k">end type</span>
<a name="ln-2543"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2544"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2545"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2546"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2547"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2548"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2549"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2550"></a>  <span class="k">end if</span>
<a name="ln-2551"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2552"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2553"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2554"></a><span class="k">end subroutine </span><span class="n">assign_get_d2</span>
<a name="ln-2555"></a><span class="k">subroutine </span><span class="n">associate_get_d2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2556"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2557"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2558"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2559"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2560"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2561"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2562"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2563"></a>  <span class="k">end type</span>
<a name="ln-2564"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2565"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2566"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2567"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2568"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2569"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2570"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2571"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2572"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2573"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2574"></a>  <span class="k">end if</span>
<a name="ln-2575"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2576"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2577"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2578"></a><span class="k">end subroutine </span><span class="n">associate_get_d2</span>
<a name="ln-2579"></a><span class="k">subroutine </span><span class="n">associate_set_d2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2580"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2581"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2582"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2583"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2584"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2585"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2586"></a>  <span class="k">end type</span>
<a name="ln-2587"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2588"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2589"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2590"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2591"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2592"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2593"></a>  <span class="k">else</span>
<a name="ln-2594"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2595"></a>  <span class="k">end if</span>
<a name="ln-2596"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2597"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2598"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2599"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2600"></a><span class="k">end subroutine </span><span class="n">associate_set_d2</span>
<a name="ln-2601"></a><span class="k">pure function </span><span class="n">associatd_l_d2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2602"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2603"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2604"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2605"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2606"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2607"></a>  <span class="k">end type</span>
<a name="ln-2608"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2609"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2610"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2611"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2612"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2613"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2614"></a>  <span class="n">endif</span>
<a name="ln-2615"></a><span class="k">end function </span><span class="n">associatd_l_d2</span>
<a name="ln-2616"></a><span class="k">pure function </span><span class="n">associatd_r_d2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2617"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2618"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2619"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2620"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2621"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2622"></a>  <span class="k">end type</span>
<a name="ln-2623"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2624"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d2&quot;</span>
<a name="ln-2625"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2626"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2627"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2628"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2629"></a>  <span class="n">endif</span>
<a name="ln-2630"></a><span class="k">end function </span><span class="n">associatd_r_d2</span>
<a name="ln-2631"></a><span class="c">! All boolean functions</span>
<a name="ln-2632"></a><span class="k">subroutine </span><span class="n">assign_set_d3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2633"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2634"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2635"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2636"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2637"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2638"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2639"></a>  <span class="k">end type</span>
<a name="ln-2640"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2641"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2642"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2643"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2644"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2645"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2646"></a>  <span class="k">else</span>
<a name="ln-2647"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2648"></a>  <span class="k">end if</span>
<a name="ln-2649"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2650"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2651"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2652"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2653"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2654"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2655"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2656"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2657"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2658"></a><span class="k">end subroutine </span><span class="n">assign_set_d3</span>
<a name="ln-2659"></a><span class="k">subroutine </span><span class="n">assign_get_d3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2660"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2661"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2662"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2663"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2664"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2665"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2666"></a>  <span class="k">end type</span>
<a name="ln-2667"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2668"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2669"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2670"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2671"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2672"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2673"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2674"></a>  <span class="k">end if</span>
<a name="ln-2675"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2676"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2677"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2678"></a><span class="k">end subroutine </span><span class="n">assign_get_d3</span>
<a name="ln-2679"></a><span class="k">subroutine </span><span class="n">associate_get_d3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2680"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2681"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2682"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2683"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2684"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2685"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2686"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2687"></a>  <span class="k">end type</span>
<a name="ln-2688"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2689"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2690"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2691"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2692"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2693"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2694"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2695"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2696"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2697"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2698"></a>  <span class="k">end if</span>
<a name="ln-2699"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2700"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2701"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2702"></a><span class="k">end subroutine </span><span class="n">associate_get_d3</span>
<a name="ln-2703"></a><span class="k">subroutine </span><span class="n">associate_set_d3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2704"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2705"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2706"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2707"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2708"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2709"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2710"></a>  <span class="k">end type</span>
<a name="ln-2711"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2712"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2713"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2714"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2715"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2716"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2717"></a>  <span class="k">else</span>
<a name="ln-2718"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2719"></a>  <span class="k">end if</span>
<a name="ln-2720"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2721"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2722"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2723"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2724"></a><span class="k">end subroutine </span><span class="n">associate_set_d3</span>
<a name="ln-2725"></a><span class="k">pure function </span><span class="n">associatd_l_d3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2726"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2727"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2728"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2729"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2730"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2731"></a>  <span class="k">end type</span>
<a name="ln-2732"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2733"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2734"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2735"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2736"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2737"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2738"></a>  <span class="n">endif</span>
<a name="ln-2739"></a><span class="k">end function </span><span class="n">associatd_l_d3</span>
<a name="ln-2740"></a><span class="k">pure function </span><span class="n">associatd_r_d3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2741"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2742"></a>  <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2743"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2744"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2745"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2746"></a>  <span class="k">end type</span>
<a name="ln-2747"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2748"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;d3&quot;</span>
<a name="ln-2749"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2750"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2751"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2752"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2753"></a>  <span class="n">endif</span>
<a name="ln-2754"></a><span class="k">end function </span><span class="n">associatd_r_d3</span>
<a name="ln-2755"></a><span class="c">! All boolean functions</span>
<a name="ln-2756"></a><span class="k">subroutine </span><span class="n">assign_set_c0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2757"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2758"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2759"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2760"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2761"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2762"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2763"></a>  <span class="k">end type</span>
<a name="ln-2764"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2765"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2766"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2767"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2768"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2769"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2770"></a>  <span class="k">else</span>
<a name="ln-2771"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2772"></a>  <span class="k">end if</span>
<a name="ln-2773"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2774"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2775"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2776"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-2777"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2778"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2779"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2780"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2781"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2782"></a><span class="k">end subroutine </span><span class="n">assign_set_c0</span>
<a name="ln-2783"></a><span class="k">subroutine </span><span class="n">assign_get_c0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2784"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2785"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2786"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2787"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2788"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2789"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2790"></a>  <span class="k">end type</span>
<a name="ln-2791"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2792"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2793"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2794"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2795"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2796"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2797"></a><span class="k">end subroutine </span><span class="n">assign_get_c0</span>
<a name="ln-2798"></a><span class="k">subroutine </span><span class="n">associate_get_c0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2799"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2800"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2801"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2802"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2803"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2804"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2805"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2806"></a>  <span class="k">end type</span>
<a name="ln-2807"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2808"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2809"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2810"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2811"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2812"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2813"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2814"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2815"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2816"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2817"></a>  <span class="k">end if</span>
<a name="ln-2818"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2819"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2820"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2821"></a><span class="k">end subroutine </span><span class="n">associate_get_c0</span>
<a name="ln-2822"></a><span class="k">subroutine </span><span class="n">associate_set_c0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2823"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2824"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2825"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2826"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2827"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2828"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2829"></a>  <span class="k">end type</span>
<a name="ln-2830"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2831"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2832"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2833"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2834"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2835"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2836"></a>  <span class="k">else</span>
<a name="ln-2837"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2838"></a>  <span class="k">end if</span>
<a name="ln-2839"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2840"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2841"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2842"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2843"></a><span class="k">end subroutine </span><span class="n">associate_set_c0</span>
<a name="ln-2844"></a><span class="k">pure function </span><span class="n">associatd_l_c0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2845"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2846"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2847"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2848"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2849"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2850"></a>  <span class="k">end type</span>
<a name="ln-2851"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2852"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2853"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2854"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2855"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2856"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2857"></a>  <span class="n">endif</span>
<a name="ln-2858"></a><span class="k">end function </span><span class="n">associatd_l_c0</span>
<a name="ln-2859"></a><span class="k">pure function </span><span class="n">associatd_r_c0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2860"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2861"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2862"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2863"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2864"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2865"></a>  <span class="k">end type</span>
<a name="ln-2866"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2867"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c0&quot;</span>
<a name="ln-2868"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2869"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2870"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2871"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2872"></a>  <span class="n">endif</span>
<a name="ln-2873"></a><span class="k">end function </span><span class="n">associatd_r_c0</span>
<a name="ln-2874"></a><span class="c">! All boolean functions</span>
<a name="ln-2875"></a><span class="k">subroutine </span><span class="n">assign_set_c1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2876"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2877"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2878"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2879"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2880"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2881"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2882"></a>  <span class="k">end type</span>
<a name="ln-2883"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2884"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-2885"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2886"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2887"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2888"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2889"></a>  <span class="k">else</span>
<a name="ln-2890"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2891"></a>  <span class="k">end if</span>
<a name="ln-2892"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-2893"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-2894"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2895"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-2896"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-2897"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2898"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2899"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-2900"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2901"></a><span class="k">end subroutine </span><span class="n">assign_set_c1</span>
<a name="ln-2902"></a><span class="k">subroutine </span><span class="n">assign_get_c1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2903"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2904"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2905"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2906"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-2907"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2908"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2909"></a>  <span class="k">end type</span>
<a name="ln-2910"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2911"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2912"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2913"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2914"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-2915"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-2916"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-2917"></a>  <span class="k">end if</span>
<a name="ln-2918"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2919"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-2920"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2921"></a><span class="k">end subroutine </span><span class="n">assign_get_c1</span>
<a name="ln-2922"></a><span class="k">subroutine </span><span class="n">associate_get_c1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-2923"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2924"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2925"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2926"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-2927"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-2928"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2929"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2930"></a>  <span class="k">end type</span>
<a name="ln-2931"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2932"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2933"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-2934"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2935"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2936"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2937"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-2938"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2939"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2940"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-2941"></a>  <span class="k">end if</span>
<a name="ln-2942"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-2943"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-2944"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-2945"></a><span class="k">end subroutine </span><span class="n">associate_get_c1</span>
<a name="ln-2946"></a><span class="k">subroutine </span><span class="n">associate_set_c1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-2947"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2948"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2949"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-2950"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-2951"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2952"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-2953"></a>  <span class="k">end type</span>
<a name="ln-2954"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2955"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-2956"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2957"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-2958"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2959"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2960"></a>  <span class="k">else</span>
<a name="ln-2961"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-2962"></a>  <span class="k">end if</span>
<a name="ln-2963"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2964"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-2965"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-2966"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-2967"></a><span class="k">end subroutine </span><span class="n">associate_set_c1</span>
<a name="ln-2968"></a><span class="k">pure function </span><span class="n">associatd_l_c1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2969"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-2970"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2971"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2972"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2973"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2974"></a>  <span class="k">end type</span>
<a name="ln-2975"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2976"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2977"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2978"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2979"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2980"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2981"></a>  <span class="n">endif</span>
<a name="ln-2982"></a><span class="k">end function </span><span class="n">associatd_l_c1</span>
<a name="ln-2983"></a><span class="k">pure function </span><span class="n">associatd_r_c1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-2984"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-2985"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-2986"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-2987"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-2988"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2989"></a>  <span class="k">end type</span>
<a name="ln-2990"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-2991"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c1&quot;</span>
<a name="ln-2992"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2993"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2994"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2995"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-2996"></a>  <span class="n">endif</span>
<a name="ln-2997"></a><span class="k">end function </span><span class="n">associatd_r_c1</span>
<a name="ln-2998"></a><span class="c">! All boolean functions</span>
<a name="ln-2999"></a><span class="k">subroutine </span><span class="n">assign_set_c2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3000"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3001"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3002"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3003"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3004"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3005"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3006"></a>  <span class="k">end type</span>
<a name="ln-3007"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3008"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3009"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3010"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3011"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3012"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3013"></a>  <span class="k">else</span>
<a name="ln-3014"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3015"></a>  <span class="k">end if</span>
<a name="ln-3016"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3017"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3018"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3019"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3020"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3021"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3022"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3023"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3024"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3025"></a><span class="k">end subroutine </span><span class="n">assign_set_c2</span>
<a name="ln-3026"></a><span class="k">subroutine </span><span class="n">assign_get_c2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3027"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3028"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3029"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3030"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3031"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3032"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3033"></a>  <span class="k">end type</span>
<a name="ln-3034"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3035"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3036"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3037"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3038"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3039"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3040"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3041"></a>  <span class="k">end if</span>
<a name="ln-3042"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3043"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3044"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3045"></a><span class="k">end subroutine </span><span class="n">assign_get_c2</span>
<a name="ln-3046"></a><span class="k">subroutine </span><span class="n">associate_get_c2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3047"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3048"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3049"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3050"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3051"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3052"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3053"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3054"></a>  <span class="k">end type</span>
<a name="ln-3055"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3056"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3057"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3058"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3059"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3060"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3061"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3062"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3063"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3064"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3065"></a>  <span class="k">end if</span>
<a name="ln-3066"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3067"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3068"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3069"></a><span class="k">end subroutine </span><span class="n">associate_get_c2</span>
<a name="ln-3070"></a><span class="k">subroutine </span><span class="n">associate_set_c2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3071"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3072"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3073"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3074"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3075"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3076"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3077"></a>  <span class="k">end type</span>
<a name="ln-3078"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3079"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3080"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3081"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3082"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3083"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3084"></a>  <span class="k">else</span>
<a name="ln-3085"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3086"></a>  <span class="k">end if</span>
<a name="ln-3087"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3088"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3089"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3090"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3091"></a><span class="k">end subroutine </span><span class="n">associate_set_c2</span>
<a name="ln-3092"></a><span class="k">pure function </span><span class="n">associatd_l_c2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3093"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3094"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3095"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3096"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3097"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3098"></a>  <span class="k">end type</span>
<a name="ln-3099"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3100"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3101"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3102"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3103"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3104"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3105"></a>  <span class="n">endif</span>
<a name="ln-3106"></a><span class="k">end function </span><span class="n">associatd_l_c2</span>
<a name="ln-3107"></a><span class="k">pure function </span><span class="n">associatd_r_c2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3108"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3109"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3110"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3111"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3112"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3113"></a>  <span class="k">end type</span>
<a name="ln-3114"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3115"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c2&quot;</span>
<a name="ln-3116"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3117"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3118"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3119"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3120"></a>  <span class="n">endif</span>
<a name="ln-3121"></a><span class="k">end function </span><span class="n">associatd_r_c2</span>
<a name="ln-3122"></a><span class="c">! All boolean functions</span>
<a name="ln-3123"></a><span class="k">subroutine </span><span class="n">assign_set_c3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3124"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3125"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3126"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3127"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3128"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3129"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3130"></a>  <span class="k">end type</span>
<a name="ln-3131"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3132"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3133"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3134"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3135"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3136"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3137"></a>  <span class="k">else</span>
<a name="ln-3138"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3139"></a>  <span class="k">end if</span>
<a name="ln-3140"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3141"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3142"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3143"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3144"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3145"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3146"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3147"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3148"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3149"></a><span class="k">end subroutine </span><span class="n">assign_set_c3</span>
<a name="ln-3150"></a><span class="k">subroutine </span><span class="n">assign_get_c3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3151"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3152"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3153"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3154"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3155"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3156"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3157"></a>  <span class="k">end type</span>
<a name="ln-3158"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3159"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3160"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3161"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3162"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3163"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3164"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3165"></a>  <span class="k">end if</span>
<a name="ln-3166"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3167"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3168"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3169"></a><span class="k">end subroutine </span><span class="n">assign_get_c3</span>
<a name="ln-3170"></a><span class="k">subroutine </span><span class="n">associate_get_c3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3171"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3172"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3173"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3174"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3175"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3176"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3177"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3178"></a>  <span class="k">end type</span>
<a name="ln-3179"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3180"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3181"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3182"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3183"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3184"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3185"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3186"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3187"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3188"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3189"></a>  <span class="k">end if</span>
<a name="ln-3190"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3191"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3192"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3193"></a><span class="k">end subroutine </span><span class="n">associate_get_c3</span>
<a name="ln-3194"></a><span class="k">subroutine </span><span class="n">associate_set_c3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3195"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3196"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3197"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3198"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3199"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3200"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3201"></a>  <span class="k">end type</span>
<a name="ln-3202"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3203"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3204"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3205"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3206"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3207"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3208"></a>  <span class="k">else</span>
<a name="ln-3209"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3210"></a>  <span class="k">end if</span>
<a name="ln-3211"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3212"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3213"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3214"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3215"></a><span class="k">end subroutine </span><span class="n">associate_set_c3</span>
<a name="ln-3216"></a><span class="k">pure function </span><span class="n">associatd_l_c3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3217"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3218"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3219"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3220"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3221"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3222"></a>  <span class="k">end type</span>
<a name="ln-3223"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3224"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3225"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3226"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3227"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3228"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3229"></a>  <span class="n">endif</span>
<a name="ln-3230"></a><span class="k">end function </span><span class="n">associatd_l_c3</span>
<a name="ln-3231"></a><span class="k">pure function </span><span class="n">associatd_r_c3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3232"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3233"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3234"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3235"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3236"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3237"></a>  <span class="k">end type</span>
<a name="ln-3238"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3239"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;c3&quot;</span>
<a name="ln-3240"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3241"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3242"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3243"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3244"></a>  <span class="n">endif</span>
<a name="ln-3245"></a><span class="k">end function </span><span class="n">associatd_r_c3</span>
<a name="ln-3246"></a><span class="c">! All boolean functions</span>
<a name="ln-3247"></a><span class="k">subroutine </span><span class="n">assign_set_z0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3248"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3249"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3250"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3251"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3252"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3253"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3254"></a>  <span class="k">end type</span>
<a name="ln-3255"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3256"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3257"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3258"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3259"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3260"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3261"></a>  <span class="k">else</span>
<a name="ln-3262"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3263"></a>  <span class="k">end if</span>
<a name="ln-3264"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3265"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3266"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3267"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-3268"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3269"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3270"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3271"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3272"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3273"></a><span class="k">end subroutine </span><span class="n">assign_set_z0</span>
<a name="ln-3274"></a><span class="k">subroutine </span><span class="n">assign_get_z0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3275"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3276"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3277"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3278"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3279"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3280"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3281"></a>  <span class="k">end type</span>
<a name="ln-3282"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3283"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3284"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3285"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3286"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3287"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3288"></a><span class="k">end subroutine </span><span class="n">assign_get_z0</span>
<a name="ln-3289"></a><span class="k">subroutine </span><span class="n">associate_get_z0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3290"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3291"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3292"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3293"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3294"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3295"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3296"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3297"></a>  <span class="k">end type</span>
<a name="ln-3298"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3299"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3300"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3301"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3302"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3303"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3304"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3305"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3306"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3307"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3308"></a>  <span class="k">end if</span>
<a name="ln-3309"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3310"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3311"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3312"></a><span class="k">end subroutine </span><span class="n">associate_get_z0</span>
<a name="ln-3313"></a><span class="k">subroutine </span><span class="n">associate_set_z0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3314"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3315"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3316"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3317"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3318"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3319"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3320"></a>  <span class="k">end type</span>
<a name="ln-3321"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3322"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3323"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3324"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3325"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3326"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3327"></a>  <span class="k">else</span>
<a name="ln-3328"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3329"></a>  <span class="k">end if</span>
<a name="ln-3330"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3331"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3332"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3333"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3334"></a><span class="k">end subroutine </span><span class="n">associate_set_z0</span>
<a name="ln-3335"></a><span class="k">pure function </span><span class="n">associatd_l_z0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3336"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3337"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3338"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3339"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3340"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3341"></a>  <span class="k">end type</span>
<a name="ln-3342"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3343"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3344"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3345"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3346"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3347"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3348"></a>  <span class="n">endif</span>
<a name="ln-3349"></a><span class="k">end function </span><span class="n">associatd_l_z0</span>
<a name="ln-3350"></a><span class="k">pure function </span><span class="n">associatd_r_z0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3351"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3352"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3353"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3354"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3355"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3356"></a>  <span class="k">end type</span>
<a name="ln-3357"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3358"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z0&quot;</span>
<a name="ln-3359"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3360"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3361"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3362"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3363"></a>  <span class="n">endif</span>
<a name="ln-3364"></a><span class="k">end function </span><span class="n">associatd_r_z0</span>
<a name="ln-3365"></a><span class="c">! All boolean functions</span>
<a name="ln-3366"></a><span class="k">subroutine </span><span class="n">assign_set_z1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3367"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3368"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3369"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3370"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3371"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3372"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3373"></a>  <span class="k">end type</span>
<a name="ln-3374"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3375"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3376"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3377"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3378"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3379"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3380"></a>  <span class="k">else</span>
<a name="ln-3381"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3382"></a>  <span class="k">end if</span>
<a name="ln-3383"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3384"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3385"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3386"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3387"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3388"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3389"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3390"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3391"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3392"></a><span class="k">end subroutine </span><span class="n">assign_set_z1</span>
<a name="ln-3393"></a><span class="k">subroutine </span><span class="n">assign_get_z1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3394"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3395"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3396"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3397"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3398"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3399"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3400"></a>  <span class="k">end type</span>
<a name="ln-3401"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3402"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3403"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3404"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3405"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3406"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3407"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3408"></a>  <span class="k">end if</span>
<a name="ln-3409"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3410"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3411"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3412"></a><span class="k">end subroutine </span><span class="n">assign_get_z1</span>
<a name="ln-3413"></a><span class="k">subroutine </span><span class="n">associate_get_z1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3414"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3415"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3416"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3417"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3418"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3419"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3420"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3421"></a>  <span class="k">end type</span>
<a name="ln-3422"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3423"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3424"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3425"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3426"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3427"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3428"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3429"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3430"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3431"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3432"></a>  <span class="k">end if</span>
<a name="ln-3433"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3434"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3435"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3436"></a><span class="k">end subroutine </span><span class="n">associate_get_z1</span>
<a name="ln-3437"></a><span class="k">subroutine </span><span class="n">associate_set_z1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3438"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3439"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3440"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3441"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3442"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3443"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3444"></a>  <span class="k">end type</span>
<a name="ln-3445"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3446"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3447"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3448"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3449"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3450"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3451"></a>  <span class="k">else</span>
<a name="ln-3452"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3453"></a>  <span class="k">end if</span>
<a name="ln-3454"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3455"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3456"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3457"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3458"></a><span class="k">end subroutine </span><span class="n">associate_set_z1</span>
<a name="ln-3459"></a><span class="k">pure function </span><span class="n">associatd_l_z1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3460"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3461"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3462"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3463"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3464"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3465"></a>  <span class="k">end type</span>
<a name="ln-3466"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3467"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3468"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3469"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3470"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3471"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3472"></a>  <span class="n">endif</span>
<a name="ln-3473"></a><span class="k">end function </span><span class="n">associatd_l_z1</span>
<a name="ln-3474"></a><span class="k">pure function </span><span class="n">associatd_r_z1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3475"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3476"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3477"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3478"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3479"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3480"></a>  <span class="k">end type</span>
<a name="ln-3481"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3482"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z1&quot;</span>
<a name="ln-3483"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3484"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3485"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3486"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3487"></a>  <span class="n">endif</span>
<a name="ln-3488"></a><span class="k">end function </span><span class="n">associatd_r_z1</span>
<a name="ln-3489"></a><span class="c">! All boolean functions</span>
<a name="ln-3490"></a><span class="k">subroutine </span><span class="n">assign_set_z2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3491"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3492"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3493"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3494"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3495"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3496"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3497"></a>  <span class="k">end type</span>
<a name="ln-3498"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3499"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3500"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3501"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3502"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3503"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3504"></a>  <span class="k">else</span>
<a name="ln-3505"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3506"></a>  <span class="k">end if</span>
<a name="ln-3507"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3508"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3509"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3510"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3511"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3512"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3513"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3514"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3515"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3516"></a><span class="k">end subroutine </span><span class="n">assign_set_z2</span>
<a name="ln-3517"></a><span class="k">subroutine </span><span class="n">assign_get_z2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3518"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3519"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3520"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3521"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3522"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3523"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3524"></a>  <span class="k">end type</span>
<a name="ln-3525"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3526"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3527"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3528"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3529"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3530"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3531"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3532"></a>  <span class="k">end if</span>
<a name="ln-3533"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3534"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3535"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3536"></a><span class="k">end subroutine </span><span class="n">assign_get_z2</span>
<a name="ln-3537"></a><span class="k">subroutine </span><span class="n">associate_get_z2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3538"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3539"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3540"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3541"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3542"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3543"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3544"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3545"></a>  <span class="k">end type</span>
<a name="ln-3546"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3547"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3548"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3549"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3550"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3551"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3552"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3553"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3554"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3555"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3556"></a>  <span class="k">end if</span>
<a name="ln-3557"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3558"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3559"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3560"></a><span class="k">end subroutine </span><span class="n">associate_get_z2</span>
<a name="ln-3561"></a><span class="k">subroutine </span><span class="n">associate_set_z2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3562"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3563"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3564"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3565"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3566"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3567"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3568"></a>  <span class="k">end type</span>
<a name="ln-3569"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3570"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3571"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3572"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3573"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3574"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3575"></a>  <span class="k">else</span>
<a name="ln-3576"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3577"></a>  <span class="k">end if</span>
<a name="ln-3578"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3579"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3580"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3581"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3582"></a><span class="k">end subroutine </span><span class="n">associate_set_z2</span>
<a name="ln-3583"></a><span class="k">pure function </span><span class="n">associatd_l_z2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3584"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3585"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3586"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3587"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3588"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3589"></a>  <span class="k">end type</span>
<a name="ln-3590"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3591"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3592"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3593"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3594"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3595"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3596"></a>  <span class="n">endif</span>
<a name="ln-3597"></a><span class="k">end function </span><span class="n">associatd_l_z2</span>
<a name="ln-3598"></a><span class="k">pure function </span><span class="n">associatd_r_z2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3599"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3600"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3601"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3602"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3603"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3604"></a>  <span class="k">end type</span>
<a name="ln-3605"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3606"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z2&quot;</span>
<a name="ln-3607"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3608"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3609"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3610"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3611"></a>  <span class="n">endif</span>
<a name="ln-3612"></a><span class="k">end function </span><span class="n">associatd_r_z2</span>
<a name="ln-3613"></a><span class="c">! All boolean functions</span>
<a name="ln-3614"></a><span class="k">subroutine </span><span class="n">assign_set_z3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3615"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3616"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3617"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3618"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3619"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3620"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3621"></a>  <span class="k">end type</span>
<a name="ln-3622"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3623"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3624"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3625"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3626"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3627"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3628"></a>  <span class="k">else</span>
<a name="ln-3629"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3630"></a>  <span class="k">end if</span>
<a name="ln-3631"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3632"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3633"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3634"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3635"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3636"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3637"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3638"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3639"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3640"></a><span class="k">end subroutine </span><span class="n">assign_set_z3</span>
<a name="ln-3641"></a><span class="k">subroutine </span><span class="n">assign_get_z3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3642"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3643"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3644"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3645"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3646"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3647"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3648"></a>  <span class="k">end type</span>
<a name="ln-3649"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3650"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3651"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3652"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3653"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3654"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3655"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3656"></a>  <span class="k">end if</span>
<a name="ln-3657"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3658"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3659"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3660"></a><span class="k">end subroutine </span><span class="n">assign_get_z3</span>
<a name="ln-3661"></a><span class="k">subroutine </span><span class="n">associate_get_z3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3662"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3663"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3664"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3665"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3666"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3667"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3668"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3669"></a>  <span class="k">end type</span>
<a name="ln-3670"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3671"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3672"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3673"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3674"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3675"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3676"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3677"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3678"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3679"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3680"></a>  <span class="k">end if</span>
<a name="ln-3681"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3682"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3683"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3684"></a><span class="k">end subroutine </span><span class="n">associate_get_z3</span>
<a name="ln-3685"></a><span class="k">subroutine </span><span class="n">associate_set_z3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3686"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3687"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3688"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3689"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3690"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3691"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3692"></a>  <span class="k">end type</span>
<a name="ln-3693"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3694"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3695"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3696"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3697"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3698"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3699"></a>  <span class="k">else</span>
<a name="ln-3700"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3701"></a>  <span class="k">end if</span>
<a name="ln-3702"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3703"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3704"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3705"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3706"></a><span class="k">end subroutine </span><span class="n">associate_set_z3</span>
<a name="ln-3707"></a><span class="k">pure function </span><span class="n">associatd_l_z3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3708"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3709"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3710"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3711"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3712"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3713"></a>  <span class="k">end type</span>
<a name="ln-3714"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3715"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3716"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3717"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3718"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3719"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3720"></a>  <span class="n">endif</span>
<a name="ln-3721"></a><span class="k">end function </span><span class="n">associatd_l_z3</span>
<a name="ln-3722"></a><span class="k">pure function </span><span class="n">associatd_r_z3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3723"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3724"></a>  <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3725"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3726"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3727"></a>    <span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3728"></a>  <span class="k">end type</span>
<a name="ln-3729"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3730"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;z3&quot;</span>
<a name="ln-3731"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3732"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3733"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3734"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3735"></a>  <span class="n">endif</span>
<a name="ln-3736"></a><span class="k">end function </span><span class="n">associatd_r_z3</span>
<a name="ln-3737"></a><span class="c">! All boolean functions</span>
<a name="ln-3738"></a><span class="k">subroutine </span><span class="n">assign_set_b0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3739"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3740"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3741"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3742"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3743"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3744"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3745"></a>  <span class="k">end type</span>
<a name="ln-3746"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3747"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3748"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3749"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3750"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3751"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3752"></a>  <span class="k">else</span>
<a name="ln-3753"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3754"></a>  <span class="k">end if</span>
<a name="ln-3755"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3756"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3757"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3758"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-3759"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3760"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3761"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3762"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3763"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3764"></a><span class="k">end subroutine </span><span class="n">assign_set_b0</span>
<a name="ln-3765"></a><span class="k">subroutine </span><span class="n">assign_get_b0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3766"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3767"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3768"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3769"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3770"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3771"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3772"></a>  <span class="k">end type</span>
<a name="ln-3773"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3774"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3775"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3776"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3777"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3778"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3779"></a><span class="k">end subroutine </span><span class="n">assign_get_b0</span>
<a name="ln-3780"></a><span class="k">subroutine </span><span class="n">associate_get_b0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3781"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3782"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3783"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3784"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3785"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3786"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3787"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3788"></a>  <span class="k">end type</span>
<a name="ln-3789"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3790"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3791"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3792"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3793"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3794"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3795"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3796"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3797"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3798"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3799"></a>  <span class="k">end if</span>
<a name="ln-3800"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3801"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3802"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3803"></a><span class="k">end subroutine </span><span class="n">associate_get_b0</span>
<a name="ln-3804"></a><span class="k">subroutine </span><span class="n">associate_set_b0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3805"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3806"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3807"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3808"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3809"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3810"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3811"></a>  <span class="k">end type</span>
<a name="ln-3812"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3813"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3814"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3815"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3816"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3817"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3818"></a>  <span class="k">else</span>
<a name="ln-3819"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3820"></a>  <span class="k">end if</span>
<a name="ln-3821"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3822"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3823"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3824"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3825"></a><span class="k">end subroutine </span><span class="n">associate_set_b0</span>
<a name="ln-3826"></a><span class="k">pure function </span><span class="n">associatd_l_b0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3827"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3828"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3829"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3830"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3831"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3832"></a>  <span class="k">end type</span>
<a name="ln-3833"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3834"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3835"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3836"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3837"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3838"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3839"></a>  <span class="n">endif</span>
<a name="ln-3840"></a><span class="k">end function </span><span class="n">associatd_l_b0</span>
<a name="ln-3841"></a><span class="k">pure function </span><span class="n">associatd_r_b0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3842"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3843"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3844"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3845"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3846"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3847"></a>  <span class="k">end type</span>
<a name="ln-3848"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3849"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b0&quot;</span>
<a name="ln-3850"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3851"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3852"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3853"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3854"></a>  <span class="n">endif</span>
<a name="ln-3855"></a><span class="k">end function </span><span class="n">associatd_r_b0</span>
<a name="ln-3856"></a><span class="c">! All boolean functions</span>
<a name="ln-3857"></a><span class="k">subroutine </span><span class="n">assign_set_b1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3858"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3859"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3860"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3861"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3862"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3863"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3864"></a>  <span class="k">end type</span>
<a name="ln-3865"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3866"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3867"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3868"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3869"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3870"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3871"></a>  <span class="k">else</span>
<a name="ln-3872"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3873"></a>  <span class="k">end if</span>
<a name="ln-3874"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3875"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-3876"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3877"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-3878"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-3879"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3880"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3881"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-3882"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3883"></a><span class="k">end subroutine </span><span class="n">assign_set_b1</span>
<a name="ln-3884"></a><span class="k">subroutine </span><span class="n">assign_get_b1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3885"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3886"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3887"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3888"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-3889"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3890"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3891"></a>  <span class="k">end type</span>
<a name="ln-3892"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3893"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3894"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3895"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3896"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-3897"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-3898"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-3899"></a>  <span class="k">end if</span>
<a name="ln-3900"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3901"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-3902"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3903"></a><span class="k">end subroutine </span><span class="n">assign_get_b1</span>
<a name="ln-3904"></a><span class="k">subroutine </span><span class="n">associate_get_b1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-3905"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3906"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3907"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3908"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-3909"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-3910"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3911"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3912"></a>  <span class="k">end type</span>
<a name="ln-3913"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3914"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3915"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-3916"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3917"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3918"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3919"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-3920"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-3921"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3922"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-3923"></a>  <span class="k">end if</span>
<a name="ln-3924"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-3925"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-3926"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-3927"></a><span class="k">end subroutine </span><span class="n">associate_get_b1</span>
<a name="ln-3928"></a><span class="k">subroutine </span><span class="n">associate_set_b1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3929"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3930"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3931"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3932"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3933"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3934"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3935"></a>  <span class="k">end type</span>
<a name="ln-3936"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3937"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-3938"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3939"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3940"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3941"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3942"></a>  <span class="k">else</span>
<a name="ln-3943"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3944"></a>  <span class="k">end if</span>
<a name="ln-3945"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3946"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-3947"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-3948"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-3949"></a><span class="k">end subroutine </span><span class="n">associate_set_b1</span>
<a name="ln-3950"></a><span class="k">pure function </span><span class="n">associatd_l_b1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3951"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-3952"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3953"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3954"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3955"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3956"></a>  <span class="k">end type</span>
<a name="ln-3957"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3958"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3959"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3960"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3961"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3962"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3963"></a>  <span class="n">endif</span>
<a name="ln-3964"></a><span class="k">end function </span><span class="n">associatd_l_b1</span>
<a name="ln-3965"></a><span class="k">pure function </span><span class="n">associatd_r_b1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-3966"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3967"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3968"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-3969"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3970"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3971"></a>  <span class="k">end type</span>
<a name="ln-3972"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3973"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b1&quot;</span>
<a name="ln-3974"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3975"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3976"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-3977"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-3978"></a>  <span class="n">endif</span>
<a name="ln-3979"></a><span class="k">end function </span><span class="n">associatd_r_b1</span>
<a name="ln-3980"></a><span class="c">! All boolean functions</span>
<a name="ln-3981"></a><span class="k">subroutine </span><span class="n">assign_set_b2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-3982"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-3983"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-3984"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-3985"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-3986"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-3987"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-3988"></a>  <span class="k">end type</span>
<a name="ln-3989"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-3990"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-3991"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3992"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-3993"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3994"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3995"></a>  <span class="k">else</span>
<a name="ln-3996"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-3997"></a>  <span class="k">end if</span>
<a name="ln-3998"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-3999"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4000"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4001"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4002"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4003"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4004"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4005"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4006"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4007"></a><span class="k">end subroutine </span><span class="n">assign_set_b2</span>
<a name="ln-4008"></a><span class="k">subroutine </span><span class="n">assign_get_b2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4009"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4010"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4011"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4012"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4013"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4014"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4015"></a>  <span class="k">end type</span>
<a name="ln-4016"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4017"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4018"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4019"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4020"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4021"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4022"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4023"></a>  <span class="k">end if</span>
<a name="ln-4024"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4025"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4026"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4027"></a><span class="k">end subroutine </span><span class="n">assign_get_b2</span>
<a name="ln-4028"></a><span class="k">subroutine </span><span class="n">associate_get_b2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4029"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4030"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4031"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4032"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4033"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4034"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4035"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4036"></a>  <span class="k">end type</span>
<a name="ln-4037"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4038"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4039"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4040"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4041"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4042"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4043"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4044"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4045"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4046"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4047"></a>  <span class="k">end if</span>
<a name="ln-4048"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4049"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4050"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4051"></a><span class="k">end subroutine </span><span class="n">associate_get_b2</span>
<a name="ln-4052"></a><span class="k">subroutine </span><span class="n">associate_set_b2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4053"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4054"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4055"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4056"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4057"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4058"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4059"></a>  <span class="k">end type</span>
<a name="ln-4060"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4061"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4062"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4063"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4064"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4065"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4066"></a>  <span class="k">else</span>
<a name="ln-4067"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4068"></a>  <span class="k">end if</span>
<a name="ln-4069"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4070"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4071"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4072"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4073"></a><span class="k">end subroutine </span><span class="n">associate_set_b2</span>
<a name="ln-4074"></a><span class="k">pure function </span><span class="n">associatd_l_b2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4075"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4076"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4077"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4078"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4079"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4080"></a>  <span class="k">end type</span>
<a name="ln-4081"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4082"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4083"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4084"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4085"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4086"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4087"></a>  <span class="n">endif</span>
<a name="ln-4088"></a><span class="k">end function </span><span class="n">associatd_l_b2</span>
<a name="ln-4089"></a><span class="k">pure function </span><span class="n">associatd_r_b2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4090"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4091"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4092"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4093"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4094"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4095"></a>  <span class="k">end type</span>
<a name="ln-4096"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4097"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b2&quot;</span>
<a name="ln-4098"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4099"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4100"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4101"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4102"></a>  <span class="n">endif</span>
<a name="ln-4103"></a><span class="k">end function </span><span class="n">associatd_r_b2</span>
<a name="ln-4104"></a><span class="c">! All boolean functions</span>
<a name="ln-4105"></a><span class="k">subroutine </span><span class="n">assign_set_b3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4106"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4107"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4108"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4109"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4110"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4111"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4112"></a>  <span class="k">end type</span>
<a name="ln-4113"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4114"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4115"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4116"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4117"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4118"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4119"></a>  <span class="k">else</span>
<a name="ln-4120"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4121"></a>  <span class="k">end if</span>
<a name="ln-4122"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4123"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4124"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4125"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4126"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4127"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4128"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4129"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4130"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4131"></a><span class="k">end subroutine </span><span class="n">assign_set_b3</span>
<a name="ln-4132"></a><span class="k">subroutine </span><span class="n">assign_get_b3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4133"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4134"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4135"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4136"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4137"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4138"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4139"></a>  <span class="k">end type</span>
<a name="ln-4140"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4141"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4142"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4143"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4144"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4145"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4146"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4147"></a>  <span class="k">end if</span>
<a name="ln-4148"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4149"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4150"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4151"></a><span class="k">end subroutine </span><span class="n">assign_get_b3</span>
<a name="ln-4152"></a><span class="k">subroutine </span><span class="n">associate_get_b3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4153"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4154"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4155"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4156"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4157"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4158"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4159"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4160"></a>  <span class="k">end type</span>
<a name="ln-4161"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4162"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4163"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4164"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4165"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4166"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4167"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4168"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4169"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4170"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4171"></a>  <span class="k">end if</span>
<a name="ln-4172"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4173"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4174"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4175"></a><span class="k">end subroutine </span><span class="n">associate_get_b3</span>
<a name="ln-4176"></a><span class="k">subroutine </span><span class="n">associate_set_b3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4177"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4178"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4179"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4180"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4181"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4182"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4183"></a>  <span class="k">end type</span>
<a name="ln-4184"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4185"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4186"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4187"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4188"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4189"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4190"></a>  <span class="k">else</span>
<a name="ln-4191"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4192"></a>  <span class="k">end if</span>
<a name="ln-4193"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4194"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4195"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4196"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4197"></a><span class="k">end subroutine </span><span class="n">associate_set_b3</span>
<a name="ln-4198"></a><span class="k">pure function </span><span class="n">associatd_l_b3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4199"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4200"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4201"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4202"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4203"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4204"></a>  <span class="k">end type</span>
<a name="ln-4205"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4206"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4207"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4208"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4209"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4210"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4211"></a>  <span class="n">endif</span>
<a name="ln-4212"></a><span class="k">end function </span><span class="n">associatd_l_b3</span>
<a name="ln-4213"></a><span class="k">pure function </span><span class="n">associatd_r_b3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4214"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4215"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4216"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4217"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4218"></a>    <span class="kt">logical</span><span class="p">,</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4219"></a>  <span class="k">end type</span>
<a name="ln-4220"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4221"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;b3&quot;</span>
<a name="ln-4222"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4223"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4224"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4225"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4226"></a>  <span class="n">endif</span>
<a name="ln-4227"></a><span class="k">end function </span><span class="n">associatd_r_b3</span>
<a name="ln-4228"></a><span class="c">! All boolean functions</span>
<a name="ln-4229"></a><span class="k">subroutine </span><span class="n">assign_set_h0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4230"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4231"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4232"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4233"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4234"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4235"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4236"></a>  <span class="k">end type</span>
<a name="ln-4237"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4238"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4239"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4240"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4241"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4242"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4243"></a>  <span class="k">else</span>
<a name="ln-4244"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4245"></a>  <span class="k">end if</span>
<a name="ln-4246"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4247"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4248"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4249"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-4250"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4251"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4252"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4253"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4254"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4255"></a><span class="k">end subroutine </span><span class="n">assign_set_h0</span>
<a name="ln-4256"></a><span class="k">subroutine </span><span class="n">assign_get_h0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4257"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4258"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4259"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4260"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4261"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4262"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4263"></a>  <span class="k">end type</span>
<a name="ln-4264"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4265"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4266"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4267"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4268"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4269"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4270"></a><span class="k">end subroutine </span><span class="n">assign_get_h0</span>
<a name="ln-4271"></a><span class="k">subroutine </span><span class="n">associate_get_h0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4272"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4273"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4274"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4275"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4276"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4277"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4278"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4279"></a>  <span class="k">end type</span>
<a name="ln-4280"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4281"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4282"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4283"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4284"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4285"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4286"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4287"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4288"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4289"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4290"></a>  <span class="k">end if</span>
<a name="ln-4291"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4292"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4293"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4294"></a><span class="k">end subroutine </span><span class="n">associate_get_h0</span>
<a name="ln-4295"></a><span class="k">subroutine </span><span class="n">associate_set_h0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4296"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4297"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4298"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4299"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4300"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4301"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4302"></a>  <span class="k">end type</span>
<a name="ln-4303"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4304"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4305"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4306"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4307"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4308"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4309"></a>  <span class="k">else</span>
<a name="ln-4310"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4311"></a>  <span class="k">end if</span>
<a name="ln-4312"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4313"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4314"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4315"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4316"></a><span class="k">end subroutine </span><span class="n">associate_set_h0</span>
<a name="ln-4317"></a><span class="k">pure function </span><span class="n">associatd_l_h0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4318"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4319"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4320"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4321"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4322"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4323"></a>  <span class="k">end type</span>
<a name="ln-4324"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4325"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4326"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4327"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4328"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4329"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4330"></a>  <span class="n">endif</span>
<a name="ln-4331"></a><span class="k">end function </span><span class="n">associatd_l_h0</span>
<a name="ln-4332"></a><span class="k">pure function </span><span class="n">associatd_r_h0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4333"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4334"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4335"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4336"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4337"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4338"></a>  <span class="k">end type</span>
<a name="ln-4339"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4340"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h0&quot;</span>
<a name="ln-4341"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4342"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4343"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4344"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4345"></a>  <span class="n">endif</span>
<a name="ln-4346"></a><span class="k">end function </span><span class="n">associatd_r_h0</span>
<a name="ln-4347"></a><span class="c">! All boolean functions</span>
<a name="ln-4348"></a><span class="k">subroutine </span><span class="n">assign_set_h1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4349"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4350"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4351"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4352"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4353"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4354"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4355"></a>  <span class="k">end type</span>
<a name="ln-4356"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4357"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4358"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4359"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4360"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4361"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4362"></a>  <span class="k">else</span>
<a name="ln-4363"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4364"></a>  <span class="k">end if</span>
<a name="ln-4365"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4366"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4367"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4368"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4369"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4370"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4371"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4372"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4373"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4374"></a><span class="k">end subroutine </span><span class="n">assign_set_h1</span>
<a name="ln-4375"></a><span class="k">subroutine </span><span class="n">assign_get_h1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4376"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4377"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4378"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4379"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4380"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4381"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4382"></a>  <span class="k">end type</span>
<a name="ln-4383"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4384"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4385"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4386"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4387"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4388"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4389"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4390"></a>  <span class="k">end if</span>
<a name="ln-4391"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4392"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4393"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4394"></a><span class="k">end subroutine </span><span class="n">assign_get_h1</span>
<a name="ln-4395"></a><span class="k">subroutine </span><span class="n">associate_get_h1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4396"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4397"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4398"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4399"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4400"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4401"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4402"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4403"></a>  <span class="k">end type</span>
<a name="ln-4404"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4405"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4406"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4407"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4408"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4409"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4410"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4411"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4412"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4413"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4414"></a>  <span class="k">end if</span>
<a name="ln-4415"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4416"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4417"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4418"></a><span class="k">end subroutine </span><span class="n">associate_get_h1</span>
<a name="ln-4419"></a><span class="k">subroutine </span><span class="n">associate_set_h1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4420"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4421"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4422"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4423"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4424"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4425"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4426"></a>  <span class="k">end type</span>
<a name="ln-4427"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4428"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4429"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4430"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4431"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4432"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4433"></a>  <span class="k">else</span>
<a name="ln-4434"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4435"></a>  <span class="k">end if</span>
<a name="ln-4436"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4437"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4438"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4439"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4440"></a><span class="k">end subroutine </span><span class="n">associate_set_h1</span>
<a name="ln-4441"></a><span class="k">pure function </span><span class="n">associatd_l_h1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4442"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4443"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4444"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4445"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4446"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4447"></a>  <span class="k">end type</span>
<a name="ln-4448"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4449"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4450"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4451"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4452"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4453"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4454"></a>  <span class="n">endif</span>
<a name="ln-4455"></a><span class="k">end function </span><span class="n">associatd_l_h1</span>
<a name="ln-4456"></a><span class="k">pure function </span><span class="n">associatd_r_h1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4457"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4458"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4459"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4460"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4461"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4462"></a>  <span class="k">end type</span>
<a name="ln-4463"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4464"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h1&quot;</span>
<a name="ln-4465"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4466"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4467"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4468"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4469"></a>  <span class="n">endif</span>
<a name="ln-4470"></a><span class="k">end function </span><span class="n">associatd_r_h1</span>
<a name="ln-4471"></a><span class="c">! All boolean functions</span>
<a name="ln-4472"></a><span class="k">subroutine </span><span class="n">assign_set_h2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4473"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4474"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4475"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4476"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4477"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4478"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4479"></a>  <span class="k">end type</span>
<a name="ln-4480"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4481"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4482"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4483"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4484"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4485"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4486"></a>  <span class="k">else</span>
<a name="ln-4487"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4488"></a>  <span class="k">end if</span>
<a name="ln-4489"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4490"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4491"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4492"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4493"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4494"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4495"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4496"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4497"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4498"></a><span class="k">end subroutine </span><span class="n">assign_set_h2</span>
<a name="ln-4499"></a><span class="k">subroutine </span><span class="n">assign_get_h2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4500"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4501"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4502"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4503"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4504"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4505"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4506"></a>  <span class="k">end type</span>
<a name="ln-4507"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4508"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4509"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4510"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4511"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4512"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4513"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4514"></a>  <span class="k">end if</span>
<a name="ln-4515"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4516"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4517"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4518"></a><span class="k">end subroutine </span><span class="n">assign_get_h2</span>
<a name="ln-4519"></a><span class="k">subroutine </span><span class="n">associate_get_h2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4520"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4521"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4522"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4523"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4524"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4525"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4526"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4527"></a>  <span class="k">end type</span>
<a name="ln-4528"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4529"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4530"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4531"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4532"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4533"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4534"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4535"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4536"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4537"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4538"></a>  <span class="k">end if</span>
<a name="ln-4539"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4540"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4541"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4542"></a><span class="k">end subroutine </span><span class="n">associate_get_h2</span>
<a name="ln-4543"></a><span class="k">subroutine </span><span class="n">associate_set_h2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4544"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4545"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4546"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4547"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4548"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4549"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4550"></a>  <span class="k">end type</span>
<a name="ln-4551"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4552"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4553"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4554"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4555"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4556"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4557"></a>  <span class="k">else</span>
<a name="ln-4558"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4559"></a>  <span class="k">end if</span>
<a name="ln-4560"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4561"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4562"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4563"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4564"></a><span class="k">end subroutine </span><span class="n">associate_set_h2</span>
<a name="ln-4565"></a><span class="k">pure function </span><span class="n">associatd_l_h2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4566"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4567"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4568"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4569"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4570"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4571"></a>  <span class="k">end type</span>
<a name="ln-4572"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4573"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4574"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4575"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4576"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4577"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4578"></a>  <span class="n">endif</span>
<a name="ln-4579"></a><span class="k">end function </span><span class="n">associatd_l_h2</span>
<a name="ln-4580"></a><span class="k">pure function </span><span class="n">associatd_r_h2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4581"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4582"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4583"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4584"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4585"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4586"></a>  <span class="k">end type</span>
<a name="ln-4587"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4588"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h2&quot;</span>
<a name="ln-4589"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4590"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4591"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4592"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4593"></a>  <span class="n">endif</span>
<a name="ln-4594"></a><span class="k">end function </span><span class="n">associatd_r_h2</span>
<a name="ln-4595"></a><span class="c">! All boolean functions</span>
<a name="ln-4596"></a><span class="k">subroutine </span><span class="n">assign_set_h3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4597"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4598"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4599"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4600"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4601"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4602"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4603"></a>  <span class="k">end type</span>
<a name="ln-4604"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4605"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4606"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4607"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4608"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4609"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4610"></a>  <span class="k">else</span>
<a name="ln-4611"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4612"></a>  <span class="k">end if</span>
<a name="ln-4613"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4614"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4615"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4616"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4617"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4618"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4619"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4620"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4621"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4622"></a><span class="k">end subroutine </span><span class="n">assign_set_h3</span>
<a name="ln-4623"></a><span class="k">subroutine </span><span class="n">assign_get_h3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4624"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4625"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4626"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4627"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4628"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4629"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4630"></a>  <span class="k">end type</span>
<a name="ln-4631"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4632"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4633"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4634"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4635"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4636"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4637"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4638"></a>  <span class="k">end if</span>
<a name="ln-4639"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4640"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4641"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4642"></a><span class="k">end subroutine </span><span class="n">assign_get_h3</span>
<a name="ln-4643"></a><span class="k">subroutine </span><span class="n">associate_get_h3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4644"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4645"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4646"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4647"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4648"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4649"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4650"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4651"></a>  <span class="k">end type</span>
<a name="ln-4652"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4653"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4654"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4655"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4656"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4657"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4658"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4659"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4660"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4661"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4662"></a>  <span class="k">end if</span>
<a name="ln-4663"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4664"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4665"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4666"></a><span class="k">end subroutine </span><span class="n">associate_get_h3</span>
<a name="ln-4667"></a><span class="k">subroutine </span><span class="n">associate_set_h3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4668"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4669"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4670"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4671"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4672"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4673"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4674"></a>  <span class="k">end type</span>
<a name="ln-4675"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4676"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4677"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4678"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4679"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4680"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4681"></a>  <span class="k">else</span>
<a name="ln-4682"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4683"></a>  <span class="k">end if</span>
<a name="ln-4684"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4685"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4686"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4687"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4688"></a><span class="k">end subroutine </span><span class="n">associate_set_h3</span>
<a name="ln-4689"></a><span class="k">pure function </span><span class="n">associatd_l_h3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4690"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4691"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4692"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4693"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4694"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4695"></a>  <span class="k">end type</span>
<a name="ln-4696"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4697"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4698"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4699"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4700"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4701"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4702"></a>  <span class="n">endif</span>
<a name="ln-4703"></a><span class="k">end function </span><span class="n">associatd_l_h3</span>
<a name="ln-4704"></a><span class="k">pure function </span><span class="n">associatd_r_h3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4705"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4706"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4707"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4708"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4709"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">ih</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4710"></a>  <span class="k">end type</span>
<a name="ln-4711"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4712"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;h3&quot;</span>
<a name="ln-4713"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4714"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4715"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4716"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4717"></a>  <span class="n">endif</span>
<a name="ln-4718"></a><span class="k">end function </span><span class="n">associatd_r_h3</span>
<a name="ln-4719"></a><span class="c">! All boolean functions</span>
<a name="ln-4720"></a><span class="k">subroutine </span><span class="n">assign_set_i0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4721"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4722"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4723"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4724"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4725"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4726"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4727"></a>  <span class="k">end type</span>
<a name="ln-4728"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4729"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4730"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4731"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4732"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4733"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4734"></a>  <span class="k">else</span>
<a name="ln-4735"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4736"></a>  <span class="k">end if</span>
<a name="ln-4737"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4738"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4739"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4740"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-4741"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4742"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4743"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4744"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4745"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4746"></a><span class="k">end subroutine </span><span class="n">assign_set_i0</span>
<a name="ln-4747"></a><span class="k">subroutine </span><span class="n">assign_get_i0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4748"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4749"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4750"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4751"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4752"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4753"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4754"></a>  <span class="k">end type</span>
<a name="ln-4755"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4756"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4757"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4758"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4759"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4760"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4761"></a><span class="k">end subroutine </span><span class="n">assign_get_i0</span>
<a name="ln-4762"></a><span class="k">subroutine </span><span class="n">associate_get_i0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4763"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4764"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4765"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4766"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4767"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4768"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4769"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4770"></a>  <span class="k">end type</span>
<a name="ln-4771"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4772"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4773"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4774"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4775"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4776"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4777"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4778"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4779"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4780"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4781"></a>  <span class="k">end if</span>
<a name="ln-4782"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4783"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4784"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4785"></a><span class="k">end subroutine </span><span class="n">associate_get_i0</span>
<a name="ln-4786"></a><span class="k">subroutine </span><span class="n">associate_set_i0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4787"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4788"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4789"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4790"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4791"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4792"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4793"></a>  <span class="k">end type</span>
<a name="ln-4794"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4795"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4796"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4797"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4798"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4799"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4800"></a>  <span class="k">else</span>
<a name="ln-4801"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4802"></a>  <span class="k">end if</span>
<a name="ln-4803"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4804"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4805"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4806"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4807"></a><span class="k">end subroutine </span><span class="n">associate_set_i0</span>
<a name="ln-4808"></a><span class="k">pure function </span><span class="n">associatd_l_i0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4809"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4810"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4811"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4812"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4813"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4814"></a>  <span class="k">end type</span>
<a name="ln-4815"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4816"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4817"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4818"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4819"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4820"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4821"></a>  <span class="n">endif</span>
<a name="ln-4822"></a><span class="k">end function </span><span class="n">associatd_l_i0</span>
<a name="ln-4823"></a><span class="k">pure function </span><span class="n">associatd_r_i0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4824"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4825"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4826"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4827"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4828"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4829"></a>  <span class="k">end type</span>
<a name="ln-4830"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4831"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i0&quot;</span>
<a name="ln-4832"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4833"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4834"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4835"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4836"></a>  <span class="n">endif</span>
<a name="ln-4837"></a><span class="k">end function </span><span class="n">associatd_r_i0</span>
<a name="ln-4838"></a><span class="c">! All boolean functions</span>
<a name="ln-4839"></a><span class="k">subroutine </span><span class="n">assign_set_i1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4840"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4841"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4842"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4843"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4844"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4845"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4846"></a>  <span class="k">end type</span>
<a name="ln-4847"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4848"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4849"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4850"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4851"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4852"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4853"></a>  <span class="k">else</span>
<a name="ln-4854"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4855"></a>  <span class="k">end if</span>
<a name="ln-4856"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4857"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4858"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4859"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4860"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4861"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4862"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4863"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4864"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4865"></a><span class="k">end subroutine </span><span class="n">assign_set_i1</span>
<a name="ln-4866"></a><span class="k">subroutine </span><span class="n">assign_get_i1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4867"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4868"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4869"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4870"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4871"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4872"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4873"></a>  <span class="k">end type</span>
<a name="ln-4874"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4875"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4876"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4877"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4878"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-4879"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-4880"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-4881"></a>  <span class="k">end if</span>
<a name="ln-4882"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4883"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-4884"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4885"></a><span class="k">end subroutine </span><span class="n">assign_get_i1</span>
<a name="ln-4886"></a><span class="k">subroutine </span><span class="n">associate_get_i1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4887"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4888"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4889"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4890"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4891"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-4892"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4893"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4894"></a>  <span class="k">end type</span>
<a name="ln-4895"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4896"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4897"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-4898"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4899"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4900"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4901"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-4902"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4903"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4904"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-4905"></a>  <span class="k">end if</span>
<a name="ln-4906"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-4907"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-4908"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-4909"></a><span class="k">end subroutine </span><span class="n">associate_get_i1</span>
<a name="ln-4910"></a><span class="k">subroutine </span><span class="n">associate_set_i1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4911"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4912"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4913"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4914"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4915"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4916"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4917"></a>  <span class="k">end type</span>
<a name="ln-4918"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4919"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-4920"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4921"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4922"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4923"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4924"></a>  <span class="k">else</span>
<a name="ln-4925"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4926"></a>  <span class="k">end if</span>
<a name="ln-4927"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4928"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-4929"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4930"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4931"></a><span class="k">end subroutine </span><span class="n">associate_set_i1</span>
<a name="ln-4932"></a><span class="k">pure function </span><span class="n">associatd_l_i1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4933"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4934"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4935"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4936"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4937"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4938"></a>  <span class="k">end type</span>
<a name="ln-4939"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4940"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4941"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4942"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4943"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4944"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4945"></a>  <span class="n">endif</span>
<a name="ln-4946"></a><span class="k">end function </span><span class="n">associatd_l_i1</span>
<a name="ln-4947"></a><span class="k">pure function </span><span class="n">associatd_r_i1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-4948"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4949"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4950"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-4951"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4952"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4953"></a>  <span class="k">end type</span>
<a name="ln-4954"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4955"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i1&quot;</span>
<a name="ln-4956"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4957"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4958"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4959"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-4960"></a>  <span class="n">endif</span>
<a name="ln-4961"></a><span class="k">end function </span><span class="n">associatd_r_i1</span>
<a name="ln-4962"></a><span class="c">! All boolean functions</span>
<a name="ln-4963"></a><span class="k">subroutine </span><span class="n">assign_set_i2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-4964"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4965"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-4966"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-4967"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-4968"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4969"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4970"></a>  <span class="k">end type</span>
<a name="ln-4971"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4972"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-4973"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4974"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-4975"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4976"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4977"></a>  <span class="k">else</span>
<a name="ln-4978"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-4979"></a>  <span class="k">end if</span>
<a name="ln-4980"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-4981"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-4982"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-4983"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-4984"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-4985"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-4986"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-4987"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-4988"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-4989"></a><span class="k">end subroutine </span><span class="n">assign_set_i2</span>
<a name="ln-4990"></a><span class="k">subroutine </span><span class="n">assign_get_i2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-4991"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-4992"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-4993"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-4994"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-4995"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-4996"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-4997"></a>  <span class="k">end type</span>
<a name="ln-4998"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-4999"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-5000"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5001"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5002"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5003"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5004"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5005"></a>  <span class="k">end if</span>
<a name="ln-5006"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5007"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5008"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5009"></a><span class="k">end subroutine </span><span class="n">assign_get_i2</span>
<a name="ln-5010"></a><span class="k">subroutine </span><span class="n">associate_get_i2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5011"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5012"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5013"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5014"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5015"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5016"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5017"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5018"></a>  <span class="k">end type</span>
<a name="ln-5019"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5020"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-5021"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5022"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5023"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5024"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5025"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5026"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5027"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5028"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5029"></a>  <span class="k">end if</span>
<a name="ln-5030"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5031"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5032"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5033"></a><span class="k">end subroutine </span><span class="n">associate_get_i2</span>
<a name="ln-5034"></a><span class="k">subroutine </span><span class="n">associate_set_i2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5035"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5036"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5037"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5038"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5039"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5040"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5041"></a>  <span class="k">end type</span>
<a name="ln-5042"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5043"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5044"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5045"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5046"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5047"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5048"></a>  <span class="k">else</span>
<a name="ln-5049"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5050"></a>  <span class="k">end if</span>
<a name="ln-5051"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-5052"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5053"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5054"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5055"></a><span class="k">end subroutine </span><span class="n">associate_set_i2</span>
<a name="ln-5056"></a><span class="k">pure function </span><span class="n">associatd_l_i2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5057"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5058"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5059"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5060"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5061"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5062"></a>  <span class="k">end type</span>
<a name="ln-5063"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5064"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-5065"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5066"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5067"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5068"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5069"></a>  <span class="n">endif</span>
<a name="ln-5070"></a><span class="k">end function </span><span class="n">associatd_l_i2</span>
<a name="ln-5071"></a><span class="k">pure function </span><span class="n">associatd_r_i2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5072"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5073"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5074"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5075"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5076"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5077"></a>  <span class="k">end type</span>
<a name="ln-5078"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5079"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i2&quot;</span>
<a name="ln-5080"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5081"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5082"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5083"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5084"></a>  <span class="n">endif</span>
<a name="ln-5085"></a><span class="k">end function </span><span class="n">associatd_r_i2</span>
<a name="ln-5086"></a><span class="c">! All boolean functions</span>
<a name="ln-5087"></a><span class="k">subroutine </span><span class="n">assign_set_i3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5088"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5089"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5090"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5091"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5092"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5093"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5094"></a>  <span class="k">end type</span>
<a name="ln-5095"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5096"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5097"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5098"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5099"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5100"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5101"></a>  <span class="k">else</span>
<a name="ln-5102"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5103"></a>  <span class="k">end if</span>
<a name="ln-5104"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5105"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5106"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5107"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-5108"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5109"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5110"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5111"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5112"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5113"></a><span class="k">end subroutine </span><span class="n">assign_set_i3</span>
<a name="ln-5114"></a><span class="k">subroutine </span><span class="n">assign_get_i3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5115"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5116"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5117"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5118"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5119"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5120"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5121"></a>  <span class="k">end type</span>
<a name="ln-5122"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5123"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5124"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5125"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5126"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5127"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5128"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5129"></a>  <span class="k">end if</span>
<a name="ln-5130"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5131"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5132"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5133"></a><span class="k">end subroutine </span><span class="n">assign_get_i3</span>
<a name="ln-5134"></a><span class="k">subroutine </span><span class="n">associate_get_i3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5135"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5136"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5137"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5138"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5139"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5140"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5141"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5142"></a>  <span class="k">end type</span>
<a name="ln-5143"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5144"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5145"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5146"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5147"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5148"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5149"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5150"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5151"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5152"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5153"></a>  <span class="k">end if</span>
<a name="ln-5154"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5155"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5156"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5157"></a><span class="k">end subroutine </span><span class="n">associate_get_i3</span>
<a name="ln-5158"></a><span class="k">subroutine </span><span class="n">associate_set_i3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5159"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5160"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5161"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5162"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5163"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5164"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5165"></a>  <span class="k">end type</span>
<a name="ln-5166"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5167"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5168"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5169"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5170"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5171"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5172"></a>  <span class="k">else</span>
<a name="ln-5173"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5174"></a>  <span class="k">end if</span>
<a name="ln-5175"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5176"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5177"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5178"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5179"></a><span class="k">end subroutine </span><span class="n">associate_set_i3</span>
<a name="ln-5180"></a><span class="k">pure function </span><span class="n">associatd_l_i3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5181"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5182"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5183"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5184"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5185"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5186"></a>  <span class="k">end type</span>
<a name="ln-5187"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5188"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5189"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5190"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5191"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5192"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5193"></a>  <span class="n">endif</span>
<a name="ln-5194"></a><span class="k">end function </span><span class="n">associatd_l_i3</span>
<a name="ln-5195"></a><span class="k">pure function </span><span class="n">associatd_r_i3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5196"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5197"></a>  <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5198"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5199"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5200"></a>    <span class="kt">integer</span><span class="p">(</span><span class="k">is</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5201"></a>  <span class="k">end type</span>
<a name="ln-5202"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5203"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;i3&quot;</span>
<a name="ln-5204"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5205"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5206"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5207"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5208"></a>  <span class="n">endif</span>
<a name="ln-5209"></a><span class="k">end function </span><span class="n">associatd_r_i3</span>
<a name="ln-5210"></a><span class="c">! All boolean functions</span>
<a name="ln-5211"></a><span class="k">subroutine </span><span class="n">assign_set_l0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5212"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5213"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5214"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5215"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5216"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5217"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5218"></a>  <span class="k">end type</span>
<a name="ln-5219"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5220"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5221"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5222"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5223"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5224"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5225"></a>  <span class="k">else</span>
<a name="ln-5226"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5227"></a>  <span class="k">end if</span>
<a name="ln-5228"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5229"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5230"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5231"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-5232"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5233"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5234"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5235"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5236"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5237"></a><span class="k">end subroutine </span><span class="n">assign_set_l0</span>
<a name="ln-5238"></a><span class="k">subroutine </span><span class="n">assign_get_l0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5239"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5240"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5241"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5242"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5243"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5244"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5245"></a>  <span class="k">end type</span>
<a name="ln-5246"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5247"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5248"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5249"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5250"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5251"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5252"></a><span class="k">end subroutine </span><span class="n">assign_get_l0</span>
<a name="ln-5253"></a><span class="k">subroutine </span><span class="n">associate_get_l0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5254"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5255"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5256"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5257"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5258"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5259"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5260"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5261"></a>  <span class="k">end type</span>
<a name="ln-5262"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5263"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5264"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5265"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5266"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5267"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5268"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5269"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5270"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5271"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5272"></a>  <span class="k">end if</span>
<a name="ln-5273"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5274"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5275"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5276"></a><span class="k">end subroutine </span><span class="n">associate_get_l0</span>
<a name="ln-5277"></a><span class="k">subroutine </span><span class="n">associate_set_l0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5278"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5279"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5280"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5281"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5282"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5283"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5284"></a>  <span class="k">end type</span>
<a name="ln-5285"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5286"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5287"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5288"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5289"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5290"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5291"></a>  <span class="k">else</span>
<a name="ln-5292"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5293"></a>  <span class="k">end if</span>
<a name="ln-5294"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5295"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5296"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5297"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5298"></a><span class="k">end subroutine </span><span class="n">associate_set_l0</span>
<a name="ln-5299"></a><span class="k">pure function </span><span class="n">associatd_l_l0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5300"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5301"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5302"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5303"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5304"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5305"></a>  <span class="k">end type</span>
<a name="ln-5306"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5307"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5308"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5309"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5310"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5311"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5312"></a>  <span class="n">endif</span>
<a name="ln-5313"></a><span class="k">end function </span><span class="n">associatd_l_l0</span>
<a name="ln-5314"></a><span class="k">pure function </span><span class="n">associatd_r_l0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5315"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5316"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5317"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5318"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5319"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5320"></a>  <span class="k">end type</span>
<a name="ln-5321"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5322"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l0&quot;</span>
<a name="ln-5323"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5324"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5325"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5326"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5327"></a>  <span class="n">endif</span>
<a name="ln-5328"></a><span class="k">end function </span><span class="n">associatd_r_l0</span>
<a name="ln-5329"></a><span class="c">! All boolean functions</span>
<a name="ln-5330"></a><span class="k">subroutine </span><span class="n">assign_set_l1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5331"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5332"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5333"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5334"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5335"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5336"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5337"></a>  <span class="k">end type</span>
<a name="ln-5338"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5339"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5340"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5341"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5342"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5343"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5344"></a>  <span class="k">else</span>
<a name="ln-5345"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5346"></a>  <span class="k">end if</span>
<a name="ln-5347"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5348"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5349"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5350"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-5351"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5352"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5353"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5354"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5355"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5356"></a><span class="k">end subroutine </span><span class="n">assign_set_l1</span>
<a name="ln-5357"></a><span class="k">subroutine </span><span class="n">assign_get_l1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5358"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5359"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5360"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5361"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5362"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5363"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5364"></a>  <span class="k">end type</span>
<a name="ln-5365"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5366"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5367"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5368"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5369"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5370"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5371"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5372"></a>  <span class="k">end if</span>
<a name="ln-5373"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5374"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5375"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5376"></a><span class="k">end subroutine </span><span class="n">assign_get_l1</span>
<a name="ln-5377"></a><span class="k">subroutine </span><span class="n">associate_get_l1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5378"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5379"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5380"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5381"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5382"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5383"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5384"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5385"></a>  <span class="k">end type</span>
<a name="ln-5386"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5387"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5388"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5389"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5390"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5391"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5392"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5393"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5394"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5395"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5396"></a>  <span class="k">end if</span>
<a name="ln-5397"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5398"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5399"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5400"></a><span class="k">end subroutine </span><span class="n">associate_get_l1</span>
<a name="ln-5401"></a><span class="k">subroutine </span><span class="n">associate_set_l1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5402"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5403"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5404"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5405"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5406"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5407"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5408"></a>  <span class="k">end type</span>
<a name="ln-5409"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5410"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5411"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5412"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5413"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5414"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5415"></a>  <span class="k">else</span>
<a name="ln-5416"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5417"></a>  <span class="k">end if</span>
<a name="ln-5418"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5419"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5420"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5421"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5422"></a><span class="k">end subroutine </span><span class="n">associate_set_l1</span>
<a name="ln-5423"></a><span class="k">pure function </span><span class="n">associatd_l_l1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5424"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5425"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5426"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5427"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5428"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5429"></a>  <span class="k">end type</span>
<a name="ln-5430"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5431"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5432"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5433"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5434"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5435"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5436"></a>  <span class="n">endif</span>
<a name="ln-5437"></a><span class="k">end function </span><span class="n">associatd_l_l1</span>
<a name="ln-5438"></a><span class="k">pure function </span><span class="n">associatd_r_l1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5439"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5440"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5441"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5442"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5443"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5444"></a>  <span class="k">end type</span>
<a name="ln-5445"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5446"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l1&quot;</span>
<a name="ln-5447"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5448"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5449"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5450"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5451"></a>  <span class="n">endif</span>
<a name="ln-5452"></a><span class="k">end function </span><span class="n">associatd_r_l1</span>
<a name="ln-5453"></a><span class="c">! All boolean functions</span>
<a name="ln-5454"></a><span class="k">subroutine </span><span class="n">assign_set_l2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5455"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5456"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5457"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5458"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5459"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5460"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5461"></a>  <span class="k">end type</span>
<a name="ln-5462"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5463"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5464"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5465"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5466"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5467"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5468"></a>  <span class="k">else</span>
<a name="ln-5469"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5470"></a>  <span class="k">end if</span>
<a name="ln-5471"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5472"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5473"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5474"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-5475"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5476"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5477"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5478"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5479"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5480"></a><span class="k">end subroutine </span><span class="n">assign_set_l2</span>
<a name="ln-5481"></a><span class="k">subroutine </span><span class="n">assign_get_l2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5482"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5483"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5484"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5485"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5486"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5487"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5488"></a>  <span class="k">end type</span>
<a name="ln-5489"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5490"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5491"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5492"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5493"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5494"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5495"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5496"></a>  <span class="k">end if</span>
<a name="ln-5497"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5498"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5499"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5500"></a><span class="k">end subroutine </span><span class="n">assign_get_l2</span>
<a name="ln-5501"></a><span class="k">subroutine </span><span class="n">associate_get_l2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5502"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5503"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5504"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5505"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5506"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5507"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5508"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5509"></a>  <span class="k">end type</span>
<a name="ln-5510"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5511"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5512"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5513"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5514"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5515"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5516"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5517"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5518"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5519"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5520"></a>  <span class="k">end if</span>
<a name="ln-5521"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5522"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5523"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5524"></a><span class="k">end subroutine </span><span class="n">associate_get_l2</span>
<a name="ln-5525"></a><span class="k">subroutine </span><span class="n">associate_set_l2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5526"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5527"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5528"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5529"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5530"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5531"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5532"></a>  <span class="k">end type</span>
<a name="ln-5533"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5534"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5535"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5536"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5537"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5538"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5539"></a>  <span class="k">else</span>
<a name="ln-5540"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5541"></a>  <span class="k">end if</span>
<a name="ln-5542"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5543"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5544"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5545"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5546"></a><span class="k">end subroutine </span><span class="n">associate_set_l2</span>
<a name="ln-5547"></a><span class="k">pure function </span><span class="n">associatd_l_l2</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5548"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5549"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5550"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5551"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5552"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5553"></a>  <span class="k">end type</span>
<a name="ln-5554"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5555"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5556"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5557"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5558"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5559"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5560"></a>  <span class="n">endif</span>
<a name="ln-5561"></a><span class="k">end function </span><span class="n">associatd_l_l2</span>
<a name="ln-5562"></a><span class="k">pure function </span><span class="n">associatd_r_l2</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5563"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5564"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5565"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5566"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5567"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5568"></a>  <span class="k">end type</span>
<a name="ln-5569"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5570"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l2&quot;</span>
<a name="ln-5571"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5572"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5573"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5574"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5575"></a>  <span class="n">endif</span>
<a name="ln-5576"></a><span class="k">end function </span><span class="n">associatd_r_l2</span>
<a name="ln-5577"></a><span class="c">! All boolean functions</span>
<a name="ln-5578"></a><span class="k">subroutine </span><span class="n">assign_set_l3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5579"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5580"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5581"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5582"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5583"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5584"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5585"></a>  <span class="k">end type</span>
<a name="ln-5586"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5587"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5588"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5589"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5590"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5591"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5592"></a>  <span class="k">else</span>
<a name="ln-5593"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5594"></a>  <span class="k">end if</span>
<a name="ln-5595"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5596"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5597"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5598"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-5599"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5600"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5601"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5602"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5603"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5604"></a><span class="k">end subroutine </span><span class="n">assign_set_l3</span>
<a name="ln-5605"></a><span class="k">subroutine </span><span class="n">assign_get_l3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5606"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5607"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5608"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5609"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5610"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5611"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5612"></a>  <span class="k">end type</span>
<a name="ln-5613"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5614"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5615"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5616"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5617"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5618"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5619"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5620"></a>  <span class="k">end if</span>
<a name="ln-5621"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5622"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5623"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5624"></a><span class="k">end subroutine </span><span class="n">assign_get_l3</span>
<a name="ln-5625"></a><span class="k">subroutine </span><span class="n">associate_get_l3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5626"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5627"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5628"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5629"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5630"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5631"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5632"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5633"></a>  <span class="k">end type</span>
<a name="ln-5634"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5635"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5636"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5637"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5638"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5639"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5640"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5641"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5642"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5643"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5644"></a>  <span class="k">end if</span>
<a name="ln-5645"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5646"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5647"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5648"></a><span class="k">end subroutine </span><span class="n">associate_get_l3</span>
<a name="ln-5649"></a><span class="k">subroutine </span><span class="n">associate_set_l3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5650"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5651"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:,:,:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5652"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5653"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5654"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5655"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5656"></a>  <span class="k">end type</span>
<a name="ln-5657"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5658"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5659"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5660"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5661"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5662"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5663"></a>  <span class="k">else</span>
<a name="ln-5664"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5665"></a>  <span class="k">end if</span>
<a name="ln-5666"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5667"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5668"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5669"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5670"></a><span class="k">end subroutine </span><span class="n">associate_set_l3</span>
<a name="ln-5671"></a><span class="k">pure function </span><span class="n">associatd_l_l3</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5672"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5673"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5674"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5675"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5676"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5677"></a>  <span class="k">end type</span>
<a name="ln-5678"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5679"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5680"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5681"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5682"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5683"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5684"></a>  <span class="n">endif</span>
<a name="ln-5685"></a><span class="k">end function </span><span class="n">associatd_l_l3</span>
<a name="ln-5686"></a><span class="k">pure function </span><span class="n">associatd_r_l3</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5687"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5688"></a>  <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5689"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5690"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5691"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">il</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5692"></a>  <span class="k">end type</span>
<a name="ln-5693"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5694"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;l3&quot;</span>
<a name="ln-5695"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5696"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5697"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5698"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5699"></a>  <span class="n">endif</span>
<a name="ln-5700"></a><span class="k">end function </span><span class="n">associatd_r_l3</span>
<a name="ln-5701"></a><span class="c">! All boolean functions</span>
<a name="ln-5702"></a><span class="k">subroutine </span><span class="n">assign_set_cp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5703"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5704"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5705"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5706"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5707"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5708"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5709"></a>  <span class="k">end type</span>
<a name="ln-5710"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5711"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5712"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5713"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5714"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5715"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5716"></a>  <span class="k">else</span>
<a name="ln-5717"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5718"></a>  <span class="k">end if</span>
<a name="ln-5719"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5720"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5721"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5722"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-5723"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5724"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5725"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5726"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5727"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5728"></a><span class="k">end subroutine </span><span class="n">assign_set_cp0</span>
<a name="ln-5729"></a><span class="k">subroutine </span><span class="n">assign_get_cp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5730"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5731"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5732"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5733"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5734"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5735"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5736"></a>  <span class="k">end type</span>
<a name="ln-5737"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5738"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5739"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5740"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5741"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5742"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5743"></a><span class="k">end subroutine </span><span class="n">assign_get_cp0</span>
<a name="ln-5744"></a><span class="k">subroutine </span><span class="n">associate_get_cp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5745"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5746"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5747"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5748"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5749"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5750"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5751"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5752"></a>  <span class="k">end type</span>
<a name="ln-5753"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5754"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5755"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5756"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5757"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5758"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5759"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5760"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5761"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5762"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5763"></a>  <span class="k">end if</span>
<a name="ln-5764"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5765"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5766"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5767"></a><span class="k">end subroutine </span><span class="n">associate_get_cp0</span>
<a name="ln-5768"></a><span class="k">subroutine </span><span class="n">associate_set_cp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5769"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5770"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5771"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5772"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5773"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5774"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5775"></a>  <span class="k">end type</span>
<a name="ln-5776"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5777"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5778"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5779"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5780"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5781"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5782"></a>  <span class="k">else</span>
<a name="ln-5783"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5784"></a>  <span class="k">end if</span>
<a name="ln-5785"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5786"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5787"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5788"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5789"></a><span class="k">end subroutine </span><span class="n">associate_set_cp0</span>
<a name="ln-5790"></a><span class="k">pure function </span><span class="n">associatd_l_cp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5791"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5792"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5793"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5794"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5795"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5796"></a>  <span class="k">end type</span>
<a name="ln-5797"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5798"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5799"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5800"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5801"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5802"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5803"></a>  <span class="n">endif</span>
<a name="ln-5804"></a><span class="k">end function </span><span class="n">associatd_l_cp0</span>
<a name="ln-5805"></a><span class="k">pure function </span><span class="n">associatd_r_cp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5806"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5807"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5808"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5809"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5810"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5811"></a>  <span class="k">end type</span>
<a name="ln-5812"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5813"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp0&quot;</span>
<a name="ln-5814"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5815"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5816"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5817"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5818"></a>  <span class="n">endif</span>
<a name="ln-5819"></a><span class="k">end function </span><span class="n">associatd_r_cp0</span>
<a name="ln-5820"></a><span class="c">! All boolean functions</span>
<a name="ln-5821"></a><span class="k">subroutine </span><span class="n">assign_set_cp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5822"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5823"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5824"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5825"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5826"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5827"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5828"></a>  <span class="k">end type</span>
<a name="ln-5829"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5830"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5831"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5832"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5833"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5834"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5835"></a>  <span class="k">else</span>
<a name="ln-5836"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5837"></a>  <span class="k">end if</span>
<a name="ln-5838"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5839"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5840"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5841"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-5842"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5843"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5844"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5845"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5846"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5847"></a><span class="k">end subroutine </span><span class="n">assign_set_cp1</span>
<a name="ln-5848"></a><span class="k">subroutine </span><span class="n">assign_get_cp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5849"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5850"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5851"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5852"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5853"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5854"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5855"></a>  <span class="k">end type</span>
<a name="ln-5856"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5857"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5858"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5859"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5860"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-5861"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-5862"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-5863"></a>  <span class="k">end if</span>
<a name="ln-5864"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5865"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5866"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5867"></a><span class="k">end subroutine </span><span class="n">assign_get_cp1</span>
<a name="ln-5868"></a><span class="k">subroutine </span><span class="n">associate_get_cp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5869"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5870"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5871"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5872"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5873"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5874"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5875"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5876"></a>  <span class="k">end type</span>
<a name="ln-5877"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5878"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5879"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5880"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5881"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5882"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5883"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-5884"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5885"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5886"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-5887"></a>  <span class="k">end if</span>
<a name="ln-5888"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-5889"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5890"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5891"></a><span class="k">end subroutine </span><span class="n">associate_get_cp1</span>
<a name="ln-5892"></a><span class="k">subroutine </span><span class="n">associate_set_cp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5893"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5894"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5895"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5896"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5897"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5898"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5899"></a>  <span class="k">end type</span>
<a name="ln-5900"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5901"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-5902"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5903"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5904"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5905"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5906"></a>  <span class="k">else</span>
<a name="ln-5907"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5908"></a>  <span class="k">end if</span>
<a name="ln-5909"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5910"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-5911"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5912"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5913"></a><span class="k">end subroutine </span><span class="n">associate_set_cp1</span>
<a name="ln-5914"></a><span class="k">pure function </span><span class="n">associatd_l_cp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5915"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5916"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5917"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5918"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5919"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5920"></a>  <span class="k">end type</span>
<a name="ln-5921"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5922"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5923"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5924"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5925"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5926"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5927"></a>  <span class="n">endif</span>
<a name="ln-5928"></a><span class="k">end function </span><span class="n">associatd_l_cp1</span>
<a name="ln-5929"></a><span class="k">pure function </span><span class="n">associatd_r_cp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-5930"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5931"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5932"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-5933"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5934"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5935"></a>  <span class="k">end type</span>
<a name="ln-5936"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5937"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;cp1&quot;</span>
<a name="ln-5938"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5939"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5940"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5941"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-5942"></a>  <span class="n">endif</span>
<a name="ln-5943"></a><span class="k">end function </span><span class="n">associatd_r_cp1</span>
<a name="ln-5944"></a><span class="c">! All boolean functions</span>
<a name="ln-5945"></a><span class="k">subroutine </span><span class="n">assign_set_fp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-5946"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5947"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-5948"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5949"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-5950"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5951"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5952"></a>  <span class="k">end type</span>
<a name="ln-5953"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5954"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-5955"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-5956"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-5957"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5958"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5959"></a>  <span class="k">else</span>
<a name="ln-5960"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-5961"></a>  <span class="k">end if</span>
<a name="ln-5962"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-5963"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-5964"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-5965"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span> <span class="c">! allocate space</span>
<a name="ln-5966"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-5967"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-5968"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-5969"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-5970"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-5971"></a><span class="k">end subroutine </span><span class="n">assign_set_fp0</span>
<a name="ln-5972"></a><span class="k">subroutine </span><span class="n">assign_get_fp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5973"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5974"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5975"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5976"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-5977"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5978"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5979"></a>  <span class="k">end type</span>
<a name="ln-5980"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5981"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-5982"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5983"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-5984"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-5985"></a>  <span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-5986"></a><span class="k">end subroutine </span><span class="n">assign_get_fp0</span>
<a name="ln-5987"></a><span class="k">subroutine </span><span class="n">associate_get_fp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-5988"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-5989"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-5990"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-5991"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-5992"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-5993"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-5994"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-5995"></a>  <span class="k">end type</span>
<a name="ln-5996"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-5997"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-5998"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-5999"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-6000"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6001"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-6002"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-6003"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6004"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-6005"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-6006"></a>  <span class="k">end if</span>
<a name="ln-6007"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-6008"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-6009"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-6010"></a><span class="k">end subroutine </span><span class="n">associate_get_fp0</span>
<a name="ln-6011"></a><span class="k">subroutine </span><span class="n">associate_set_fp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-6012"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6013"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-6014"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-6015"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-6016"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6017"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-6018"></a>  <span class="k">end type</span>
<a name="ln-6019"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6020"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-6021"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6022"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-6023"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6024"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6025"></a>  <span class="k">else</span>
<a name="ln-6026"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6027"></a>  <span class="k">end if</span>
<a name="ln-6028"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-6029"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-6030"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-6031"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-6032"></a><span class="k">end subroutine </span><span class="n">associate_set_fp0</span>
<a name="ln-6033"></a><span class="k">pure function </span><span class="n">associatd_l_fp0</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-6034"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-6035"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6036"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-6037"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6038"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6039"></a>  <span class="k">end type</span>
<a name="ln-6040"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6041"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-6042"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6043"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6044"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6045"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6046"></a>  <span class="n">endif</span>
<a name="ln-6047"></a><span class="k">end function </span><span class="n">associatd_l_fp0</span>
<a name="ln-6048"></a><span class="k">pure function </span><span class="n">associatd_r_fp0</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-6049"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6050"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-6051"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-6052"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6053"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6054"></a>  <span class="k">end type</span>
<a name="ln-6055"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6056"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp0&quot;</span>
<a name="ln-6057"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6058"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6059"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6060"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-6061"></a>  <span class="n">endif</span>
<a name="ln-6062"></a><span class="k">end function </span><span class="n">associatd_r_fp0</span>
<a name="ln-6063"></a><span class="c">! All boolean functions</span>
<a name="ln-6064"></a><span class="k">subroutine </span><span class="n">assign_set_fp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-6065"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6066"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-6067"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-6068"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-6069"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6070"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-6071"></a>  <span class="k">end type</span>
<a name="ln-6072"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6073"></a>  <span class="c">! ASSIGNMENT in fortran is per default destructive</span>
<a name="ln-6074"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-6075"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-6076"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6077"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6078"></a>  <span class="k">else</span>
<a name="ln-6079"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6080"></a>  <span class="k">end if</span>
<a name="ln-6081"></a>  <span class="c">! With pointer transfer we need to deallocate</span>
<a name="ln-6082"></a>  <span class="c">! else bounds might change...</span>
<a name="ln-6083"></a>  <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6084"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">rhs</span><span class="p">)))</span> <span class="c">! allocate space</span>
<a name="ln-6085"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=</span> <span class="n">rhs</span> <span class="c">! copy data over</span>
<a name="ln-6086"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-6087"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-6088"></a>  <span class="c">! We already have shipped it</span>
<a name="ln-6089"></a>  <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6090"></a><span class="k">end subroutine </span><span class="n">assign_set_fp1</span>
<a name="ln-6091"></a><span class="k">subroutine </span><span class="n">assign_get_fp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-6092"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-6093"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6094"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-6095"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lsuccess</span>
<a name="ln-6096"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6097"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-6098"></a>  <span class="k">end type</span>
<a name="ln-6099"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6100"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6101"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">lsuccess</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6102"></a><span class="k">    </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-6103"></a>    <span class="n">lsuccess</span> <span class="o">=</span> <span class="k">all</span><span class="p">(</span><span class="nb">shape</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nb">shape</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="c">!&amp;</span>
<a name="ln-6104"></a>     <span class="c">! .and. all((lbound(p%p) == lbound(lhs))) &amp;</span>
<a name="ln-6105"></a>     <span class="c">! .and. all((ubound(p%p) == ubound(lhs)))</span>
<a name="ln-6106"></a>  <span class="k">end if</span>
<a name="ln-6107"></a><span class="k">  if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-6108"></a>  <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-6109"></a><span class="k">  </span><span class="n">lhs</span> <span class="o">=</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-6110"></a><span class="k">end subroutine </span><span class="n">assign_get_fp1</span>
<a name="ln-6111"></a><span class="k">subroutine </span><span class="n">associate_get_fp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">,</span><span class="n">dealloc</span><span class="p">,</span><span class="n">success</span><span class="p">)</span>
<a name="ln-6112"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-6113"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6114"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-6115"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">success</span>
<a name="ln-6116"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span><span class="p">,</span> <span class="n">lsuccess</span>
<a name="ln-6117"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6118"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-6119"></a>  <span class="k">end type</span>
<a name="ln-6120"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6121"></a>  <span class="n">lsuccess</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6122"></a>  <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">success</span><span class="p">))</span> <span class="n">success</span> <span class="o">=</span> <span class="n">lsuccess</span>
<a name="ln-6123"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-6124"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6125"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-6126"></a>  <span class="c">! there is one problem, say if lhs is not nullified...</span>
<a name="ln-6127"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-6128"></a><span class="k">     deallocate</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-6129"></a>     <span class="k">nullify</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
<a name="ln-6130"></a>  <span class="k">end if</span>
<a name="ln-6131"></a><span class="k">  if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lsuccess</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-6132"></a><span class="k">  </span><span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="c">! retrieve pointer encoding</span>
<a name="ln-6133"></a>  <span class="n">lhs</span> <span class="o">=&gt;</span> <span class="n">p</span><span class="p">%</span><span class="n">p</span>
<a name="ln-6134"></a><span class="k">end subroutine </span><span class="n">associate_get_fp1</span>
<a name="ln-6135"></a><span class="k">subroutine </span><span class="n">associate_set_fp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">,</span><span class="n">dealloc</span><span class="p">)</span>
<a name="ln-6136"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6137"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-6138"></a>  <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">dealloc</span>
<a name="ln-6139"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ldealloc</span>
<a name="ln-6140"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6141"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-6142"></a>  <span class="k">end type</span>
<a name="ln-6143"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6144"></a>  <span class="c">! ASSOCIATION in fortran is per default non-destructive</span>
<a name="ln-6145"></a>  <span class="n">ldealloc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-6146"></a>  <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">dealloc</span><span class="p">))</span><span class="n">ldealloc</span> <span class="o">=</span> <span class="n">dealloc</span>
<a name="ln-6147"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ldealloc</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6148"></a><span class="k">     call </span><span class="n">delete</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6149"></a>  <span class="k">else</span>
<a name="ln-6150"></a><span class="k">     call nullify</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<a name="ln-6151"></a>  <span class="k">end if</span>
<a name="ln-6152"></a><span class="k">  </span><span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6153"></a>  <span class="n">p</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">rhs</span>
<a name="ln-6154"></a>  <span class="k">allocate</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">))))</span> <span class="c">! allocate encoding</span>
<a name="ln-6155"></a>  <span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">(:)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">local_enc_type</span><span class="p">)</span> <span class="c">! transfer pointer type to the encoding</span>
<a name="ln-6156"></a><span class="k">end subroutine </span><span class="n">associate_set_fp1</span>
<a name="ln-6157"></a><span class="k">pure function </span><span class="n">associatd_l_fp1</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">this</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-6158"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">lhs</span>
<a name="ln-6159"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6160"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-6161"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6162"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6163"></a>  <span class="k">end type</span>
<a name="ln-6164"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6165"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6166"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6167"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6168"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6169"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6170"></a>  <span class="n">endif</span>
<a name="ln-6171"></a><span class="k">end function </span><span class="n">associatd_l_fp1</span>
<a name="ln-6172"></a><span class="k">pure function </span><span class="n">associatd_r_fp1</span><span class="p">(</span><span class="n">this</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
<a name="ln-6173"></a>  <span class="k">type</span><span class="p">(</span><span class="n">variable_t</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">this</span>
<a name="ln-6174"></a>  <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">rhs</span>
<a name="ln-6175"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ret</span>
<a name="ln-6176"></a>  <span class="k">type</span> <span class="kd">::</span> <span class="n">pt</span>
<a name="ln-6177"></a>    <span class="k">type</span><span class="p">(</span><span class="kt">c_funptr</span><span class="p">),</span> <span class="k">pointer</span> <span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6178"></a>  <span class="k">end type</span>
<a name="ln-6179"></a><span class="k">  type</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-6180"></a>  <span class="n">ret</span> <span class="o">=</span> <span class="n">this</span><span class="p">%</span><span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;fp1&quot;</span>
<a name="ln-6181"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-6182"></a><span class="k">     nullify</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6183"></a>     <span class="n">p</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">this</span><span class="p">%</span><span class="n">enc</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-6184"></a>     <span class="n">ret</span> <span class="o">=</span> <span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">rhs</span><span class="p">)</span>
<a name="ln-6185"></a>  <span class="n">endif</span>
<a name="ln-6186"></a><span class="k">end function </span><span class="n">associatd_r_fp1</span>
<a name="ln-6187"></a><span class="c">! All boolean functions</span>
<a name="ln-6188"></a><span class="k">end module </span><span class="n">variable</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2015-2019 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> fdict was developed by Nick R. Papior</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    
  </body>
</html>